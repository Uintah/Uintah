<?xml version="1.0" encoding="iso-8859-1"?>
<!-- DOCTYPE Uintah_specification SYSTEM "input.dtd" -->
<!-- @version: -->

<Uintah_specification>
  
    <Meta>
      <title>DQMOM Coal Char Test 2a - No Char Production, Char Oxidation, Scalar Gas Temp = 400 K, Tparticle = Tgas, No Convection (3 IC, 3 Env, Optimized Solver)</title>
    </Meta>

    <SimulationComponent type="arches" />

    <Time>
      <maxTime>5.0</maxTime>
      <max_Timesteps>10</max_Timesteps>
      <initTime>0.0</initTime>
      <delt_min>0.00001</delt_min>
      <delt_max>5</delt_max>
      <timestep_multiplier>0.5</timestep_multiplier>
    </Time>

    <DataArchiver>
        <filebase>uda_char_test_2a.uda</filebase>
        <outputTimestepInterval>1</outputTimestepInterval>
        <outputInitTimestep />

        <save label = "totalKineticEnergy"/>
        <save label = "totalummsLnError"/>
        <save label = "totalvmmsLnError"/>
        <save label = "totalummsExactSol"/>
        <save label = "totalvmmsExactSol"/>
        <save label = "pressurePS"/>
        <save label = "scalarSP"/>
        <save label = "newCCUVelocity"/>  
        <save label = "newCCVVelocity"/>  
        <save label = "newCCVelocity" />
        <save label = "uVelocitySPBC"/>
        <save label = "vVelocitySPBC"/>
        <save label = "continuityResidual"/>
        <save label = "velocityDivergence"/>
        <save label = "tempIN" />

        <!-- EXTRA SCALARS -->
        <save label = "coal_gas_mix_frac" />
        <save label = "mixture_fraction_2" />

        <!-- DQMOM Vars -->
        <save label = "w_qn0"/>
        <save label = "w_qn1"/>
        <save label = "w_qn2"/>

        <save label = "w_qn0_src"/>
        <save label = "w_qn1_src"/>
        <save label = "w_qn2_src"/>

        <save label = "length_qn0"/>
        <save label = "length_qn1"/>
        <save label = "length_qn2"/>

        <save label = "length_qn0_src"/>
        <save label = "length_qn1_src"/>
        <save label = "length_qn2_src"/>

        <save label = "RCmass_qn0"/>
        <save label = "RCmass_qn1"/>
        <save label = "RCmass_qn2"/>

        <save label = "RCmass_qn0_src"/>
        <save label = "RCmass_qn1_src"/>
        <save label = "RCmass_qn2_src"/>

        <save label = "CharMass_qn0"/>
        <save label = "CharMass_qn1"/>
        <save label = "CharMass_qn2"/>

        <save label = "CharMass_qn0_src"/>
        <save label = "CharMass_qn1_src"/>
        <save label = "CharMass_qn2_src"/>

        <!--
        <save label = "sarofim_qn0" />
        <save label = "sarofim_qn1" />
        <save label = "sarofim_qn2" />

        <save label = "sarofim_qn0_char" />
        <save label = "sarofim_qn1_char" />
        <save label = "sarofim_qn2_char" />

        <save label = "sarofim_qn0_gasSource" />
        <save label = "sarofim_qn1_gasSource" />
        <save label = "sarofim_qn2_gasSource" />
        -->

        <checkpoint cycle = "2" interval = "5"/>
        <compression>gzip</compression>
    </DataArchiver>

    <Grid>
        <Level>
            <Box label = "1">
                <lower>[0,0,0]</lower>
                <upper>[0.01,0.01,0.01]</upper>
                <resolution>[8,8,8]</resolution>
                <extraCells>[0,0,0]</extraCells>
                <patches>[1,1,1]</patches>
            </Box>
            <periodic>[1,1,1]</periodic>
        </Level>
    </Grid>

    <PhysicalConstants>
        <gravity>[0,0,0]</gravity>
        <reference_point>[0,0,0]</reference_point>
        <viscosity>0.0002</viscosity>
    </PhysicalConstants>

    <CFD>

        <!-- ARCHES specification -->
        <ARCHES>
            <!-- NOTE: Constant MMS works with tables (doesn't reset the tempIN label's value),
                           but Almgren MMS does NOT work with tables (it does reset the tempIN label's value) -->
            <MMS whichMMS="constantMMS" >
                <mmsErrorType>Linf</mmsErrorType>
                    <constantMMS>
                    <cu>1.0</cu>
                    <cv>11.0</cv>
                    <cw>.1</cw>
                    <cp>100</cp>
                    <phi0>0.3</phi0>
                    <esphi0>0.0</esphi0>
                </constantMMS>
            </MMS>

            <!-- TIME INTEGRATOR -->
            <TimeIntegrator>
                <ExplicitIntegrator order="second"/>
            </TimeIntegrator>

            <!-- EXTRA SCALARS -->
            <TransportEqns>

                <Eqn label="mixture_fraction_2" type = "CCscalar">
                    <doDiff>true</doDiff>
                    <doConv>true</doConv>
                    <conv_scheme>super_bee</conv_scheme>
                    <initialization type = "constant">
                        <constant>0.0</constant>
                    </initialization>
                </Eqn>

                <Eqn label="gasTemp" type="CCscalar">
                    <doDiff>false</doDiff>
                    <doConv>false</doConv>
                    <initialization type="constant">
                        <constant>400</constant>
                    </initialization>
                </Eqn>
                    

                <Eqn label = "coal_gas_mix_frac" type = "CCscalar">
                    <doDiff>false</doDiff>
                    <doConv>false</doConv>
                    <addSources>true</addSources>
                    <conv_scheme>super_bee</conv_scheme>
                    <!--
                    <src label = "eta_source"/>
                    -->
                    <initialization type="constant">
                        <constant>0.0</constant>
                    </initialization>
                </Eqn>

                <Sources>

                    <!--
                     <src label = "eta_source" type = "DevolMixtureFraction"> 
                         <devol_model_name>sarofim</devol_model_name>
                     </src>

                    <src label = "mf2_source" type = "CharOxidationGasSource">
                        <char_model_name>charox</char_model_name>
                        <char_reaction>CO</char_reaction>
                    </src>

                    <src label = "mf3_source" type = "CharOxidationGasSource">
                        <char_model_name>charox</char_model_name>
                        <char_reaction>CO2</char_reaction>
                    </src>

                    <src label = "mf4_source" type = "CharOxidationGasSource">
                        <char_model_name>charox</char_model_name>
                        <char_reaction>O2</char_reaction>
                    </src>
                    -->

                </Sources>
                        
            </TransportEqns>

            <Coal_Properties>
                <C>0.75</C>
                <H>0.05</H>
                <N>0.0</N>
                <O>0.2</O>
                <S>0.0</S>
                <initial_ash_mass>[1e-12,2e-12,3e-12]</initial_ash_mass>
            </Coal_Properties>  

            <!-- DQMOM -->
            <DQMOM>
                <number_quad_nodes>3</number_quad_nodes>

                <LinearSolver>
                    <type>Optimize</type>
                    <tolerance>1e-5</tolerance>
                    <Optimization>
                        <Optimal_abscissas>[1,-1,1,-1,1,1,1,1,-1]</Optimal_abscissas>
                    </Optimization>
                </LinearSolver>

                <Models>

                    <!--
                    <model label="sarofim" type="KobayashiSarofimDevol">
                        <ICVars>
                            <variable label="RCmass"   role="raw_coal_mass" />
                            <variable label="CharMass" role="char_mass" />
                        </ICVars>
                        <scalarVars>
                            <variable label="gasTemp" role="gas_temperature" />
                        </scalarVars>
                    </model>
                    -->

                    <model label="charox" type="GlobalCharOxidation">
                        <ICVars>
                            <variable label="length" role="particle_length" />
                            <variable label="CharMass" role="char_mass" />
                        </ICVars>
                        <!--
                        <scalarVars>
                            <variable label="gasTemp" role="gas_temperature" />
                        </scalarVars>
                        -->
                    </model>

                    <model label="my_density" type="ConstantDensityCoal">
                        <ICVars>
                            <variable label="length" role="particle_length" />
                            <variable label="RCmass" role="raw_coal_mass" />
                            <variable label="CharMass" role="char_mass" />
                        </ICVars>
                    </model>

                </Models>
                            

                <Weights>
                    <!-- w [=] #/m^3 -->
                    <doDiff>false</doDiff>
                    <doConv>false</doConv>
                    <initialization type="constant">
                        <constant>1.0e4</constant>
                    </initialization>
                    <scaling_const>1.0e4</scaling_const>
                </Weights>

                <Ic label="length">
                    <!-- l [=] m -->
                    <doDiff>false</doDiff>
                    <doConv>false</doConv>
                    <initialization type="env_constant">
                        <env_constant qn="0" value="30.0e-6"></env_constant>
                        <env_constant qn="1" value="70.0e-6"></env_constant>
                        <env_constant qn="2" value="100.0e-6"></env_constant>
                    </initialization>
                    <scaling_const>1.0e-6</scaling_const>
                </Ic>

                <Ic label="RCmass">
                    <!-- l [=] m -->
                    <doDiff>false</doDiff>
                    <doConv>false</doConv>
                    <initialization type="env_constant">
                        <env_constant qn="0"  value="30.0e-11"></env_constant>
                        <env_constant qn="1"  value="70.0e-11"></env_constant>
                        <env_constant qn="2" value="100.0e-11"></env_constant>
                    </initialization>
                    <scaling_const>1.0e-10</scaling_const>
                </Ic> 


                <Ic label="CharMass">
                    <!-- l [=] m -->
                    <doDiff>false</doDiff>
                    <doConv>true</doConv>
                    <initialization type="env_constant">
                        <env_constant qn="0" value="1.0e-15"></env_constant>
                        <env_constant qn="1" value="1.1e-15"></env_constant>
                        <env_constant qn="2" value="1.2e-15"></env_constant>
                    </initialization>
                    <scaling_const>1.0</scaling_const>
                </Ic>


                <Moment><m>[0,0,0]</m></Moment>
                <Moment><m>[0,0,1]</m></Moment>
                <Moment><m>[0,1,0]</m></Moment>
                <Moment><m>[1,0,0]</m></Moment> 
                <Moment><m>[0,1,1]</m></Moment>
                <Moment><m>[1,0,1]</m></Moment>
                <Moment><m>[1,1,0]</m></Moment>
                <Moment><m>[0,1,2]</m></Moment>
                <Moment><m>[0,2,0]</m></Moment>
                <Moment><m>[2,0,0]</m></Moment>
                <Moment><m>[0,0,3]</m></Moment>
                <Moment><m>[0,3,0]</m></Moment>

            </DQMOM>


            <Turbulence model = "smagorinsky">
              <turbulentPrandtlNumber>0.4</turbulentPrandtlNumber>
              <cf>0.0</cf>
              <fac_mesh>1.0</fac_mesh>
              <filterl>0.000001</filterl>
              <var_const>0.1</var_const>
            </Turbulence>

            <Properties>
                <empirical_soot>false</empirical_soot>
                <use_mixing_model>false</use_mixing_model>
                <TabProps>
                    <inputfile>CoalModel.h5</inputfile>
                </TabProps>
            </Properties>

            <ExplicitSolver>

            <initial_dt>1</initial_dt>
            <variable_dt>true</variable_dt>
              <timeIntegratorType>RK2SSP</timeIntegratorType> 

              <PressureSolver>
                <linear_solver>hypre</linear_solver>
                <parameters>
                  <solver>cg</solver>
                  <preconditioner>pfmg</preconditioner>
                  <res_tol>1.0e-10</res_tol>
                  <max_iter>75</max_iter>
                </parameters>
              </PressureSolver>

              <MomentumSolver>
                <convection_scheme>central</convection_scheme>
              </MomentumSolver>

              <MixtureFractionSolver>
                <convection_scheme>central-upwind</convection_scheme>
                <initial_value>0.90</initial_value>
                <!--
                <src label = "eta_source" />
                -->
              </MixtureFractionSolver>

            </ExplicitSolver>
        </ARCHES>
    </CFD>
</Uintah_specification>

