<?xml version="1.0" encoding="iso-8859-1"?>
<!-- DOCTYPE Uintah_specification SYSTEM "input.dtd" -->
<!-- @version: -->

<Uintah_specification>
  
    <Meta>
        <title>1D Verification</title>
    </Meta>

    <!-- 
    NOTE: In order to perform verification, you must first
          define the VERIFICATION macro in CCA/Components/Arches/Directives.h
          Otherwise, you will encounter an error.
    -->

    <SimulationComponent type="arches" />

    <Time>
        <maxTime>0.10</maxTime>
        <max_Timesteps>5</max_Timesteps>
        <initTime>0.0</initTime>
        <delt_min>0.0005</delt_min>
        <delt_max>0.0005</delt_max>
        <timestep_multiplier>0.5</timestep_multiplier>
    </Time>

    <DataArchiver>
        <filebase>uda_mms_x.uda</filebase>
        <outputTimestepInterval>1</outputTimestepInterval>
        <outputInitTimestep />

        <save label = "mms_scalar" />
        <save label = "mms_scalar_Fconv" />
        <save label = "mms_scalar_RHS" />

        <save label = "mms_scalar_MMSExact" />
        <save label = "mms_scalar_MMSError" />
        <save label = "mms_scalar_MMSError_L2Norm" />
        <save label = "mms_scalar_MMSError_LInfNorm" />

        <save label = "manufactured" />

        <save label = "newCCUVelocity"/>  
        <save label = "newCCVVelocity"/>  
        <save label = "totalKineticEnergy"/>

        <save label = "totalummsLnError"/>
        <save label = "totalvmmsLnError"/>
        <save label = "totalummsExactSol"/>
        <save label = "totalvmmsExactSol"/>

        <save label = "ummsLnError"/>
        <save label = "vmmsLnError"/>
        <checkpoint cycle = "2" interval = "0.05"/>
        <compression>gzip</compression>
    </DataArchiver>

    <Grid>
        <Level>
            <Box label = "1">
                <lower>[0,0,0]</lower>
                <upper>[0.05,0.05,0.05]</upper>
                <resolution>[32,32,32]</resolution>
                <extraCells>[0,0,0]</extraCells>
                <patches>[1,1,1]</patches>
            </Box>
            <periodic>[1,1,1]</periodic>
        </Level>
    </Grid>

    <PhysicalConstants>
        <gravity>[0,0,0]</gravity>
        <reference_point>[0,0,0]</reference_point>
        <viscosity>0.0002</viscosity>
    </PhysicalConstants>

    <CFD>

        <!-- ARCHES specification -->
        <ARCHES>

            <MMS whichMMS="constantMMS" >
                <mmsErrorType>Linf</mmsErrorType>
                <constantMMS>
                    <cu>1.0</cu>
                    <cv>0.0</cv>
                    <cw>0.0</cw>
                    <cp>100</cp>
                    <phi0>0.3</phi0>
                </constantMMS>
            </MMS>

            <TransportEqns>

                <Eqn label="mms_scalar" type="CCscalar">
                    <addSources>true</addSources>
                    <doDiff>false</doDiff>
                    <doConv>true</doConv>
                    <conv_scheme>upwind</conv_scheme>
                    <initialization type="mms_x" />
                    <src label="manufactured" />
                </Eqn>

                <Sources>
                    <src label="manufactured" type="MMS_X" />
                </Sources>

            </TransportEqns>
        
            <Turbulence model = "smagorinsky">
                <turbulentPrandtlNumber>0.4</turbulentPrandtlNumber>
                <cf>0.0</cf>
                <fac_mesh>1.0</fac_mesh>
                <filterl>0.000001</filterl>
                <var_const>0.1</var_const>
            </Turbulence>

            <Properties>
                <use_mixing_model>false</use_mixing_model>
                <ColdFlowMixingModel>
                    <Stream>
                        <density>1.00</density>
                        <temperature>298</temperature>
                    </Stream>
                    <Stream>
                        <density>1.00</density>
                        <temperature>298</temperature>
                    </Stream>
                </ColdFlowMixingModel>
            </Properties>
            
            <ExplicitSolver>
                
                <initial_dt>1</initial_dt>
                <variable_dt>true</variable_dt>
                <timeIntegratorType>RK2SSP</timeIntegratorType> 

                <PressureSolver>
                    <linear_solver>hypre</linear_solver>
                    <parameters>
                        <solver>cg</solver>
                        <preconditioner>pfmg</preconditioner>
                        <res_tol>1.0e-10</res_tol>
                        <max_iter>75</max_iter>
                    </parameters>
                </PressureSolver>

                <MomentumSolver>
                      <convection_scheme>central</convection_scheme>
                </MomentumSolver>

                <MixtureFractionSolver>
                      <convection_scheme>central-upwind</convection_scheme>
                </MixtureFractionSolver>

            </ExplicitSolver>
        </ARCHES>
    </CFD>

</Uintah_specification>

