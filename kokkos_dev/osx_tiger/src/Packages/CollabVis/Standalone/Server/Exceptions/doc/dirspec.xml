
<!--
  The contents of this file are subject to the University of Utah Public
  License (the "License"); you may not use this file except in compliance
  with the License.
  
  Software distributed under the License is distributed on an "AS IS"
  basis, WITHOUT WARRANTY OF ANY KIND, either express or implied. See the
  License for the specific language governing rights and limitations under
  the License.
  
  The Original Source Code is SCIRun, released March 12, 2001.
  
  The Original Source Code was developed by the University of Utah.
  Portions created by UNIVERSITY are Copyright (C) 2001, 1994 
  University of Utah. All Rights Reserved.
-->

<chapter>
  <title>SCIRun Exceptions</title>

  <sect1>
    <para>
      This chapter explains SCIRun exceptions.  
    </para>
  </sect1>

  <sect1>
    <title>Introduction</title>
    <para>
       The Exceptions directory contains common exceptions and the Exception
       base class.  Developers can create new exception classes, and these
       will need to be in other directories if they depend on other data
       structures outside of the Exception dir.
    </para>

    <para>
       All exceptions in SCIRun are derived from the SCIRun::Exception
       base class.  All derived classes implement a message method and a
       type method.   The type method just returns a string (const char*
       actually) that indicates the classname of the exception.  The message
       returns a human readable string that can be printed out when the
       exception is caught.
    </para>

    <para>
       This directory also contains some general exceptions used throughout 
       SCIRun. 
    <unorderedlist>
      <listitem><para>AssertionFailed - thrown when an assertion fails.</para></listitem>
      <listitem><para>ArrayIndexOutOfBounds - thrown to indicate a failed bounds check.</para></listitem>
      <listitem><para>DimensionMismatch - thrown to indicate dimensionality differences.</para></listitem>
      <listitem><para>FileNotFound - thrown when a file is not found.</para></listitem>
       <listitem><para>InternalError - thrown when an internal error occurs.</para></listitem>
    </unorderedlist>
    </para>

  </sect1>

  <sect1>
    <title>Programming with SCIRun Exceptions</title>

      <para>
        A developer is likely to use this code from within written modules 
        as well as within new datatypes. 
      </para>

      <para>
         A couple development specific hints follow. 
      </para> 
      <para>
         All exception classes must implement a copy constructor (for some
         compilers).
      </para>
      <para>
         On the SGI, the exception classes will give you a stacktrace when
         they are caught (uses -lexc).
      </para>

      <para>
        Exceptions in SCIRun, are only to be used for exceptional cases. 
        General error handling should use another mechanism. Exceptions are
        expensive, and as such should only be used in cases that warrant it.
        One of the most common uses in this directory are ASSERT, and 
        ASSERTFAIL.
      </para>

    <sect2>
      <title>ASSERT</title>
    <para>
       This is used to verify that some condition is true before continuing.
       if the expression geven evaluates to false, the exception is thrown, 
       which will eventually abort scirun.
    </para>
    <para>This macro expands to nothing in an optimized build.</para>
    <computeroutput>
       myClass *p = get_my_class();
       ASSERT(p != 0);
       p->do_something();
    </computeroutput>
    </sect2>
    
    <sect2>
      <title>ASSERTFAIL</title>
    <para>
       This is used to abort with a nice message when something is wrong.
    </para>
    <para>This macro expands to nothing in an optimized build.</para>
    <computeroutput>
       switch(var) {
         case NICE:
         ...
         break;
        case EVEN_NICER:
         ...
         break;
        default:
         ASSERTFAIL("Unknown case, what happened?");
       }
    </computeroutput>
    </sect2>
  </sect1>
</chapter>

