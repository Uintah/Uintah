<!--
  The contents of this file are subject to the University of Utah Public
  License (the "License"); you may not use this file except in compliance
  with the License.
  
  Software distributed under the License is distributed on an "AS IS"
  basis, WITHOUT WARRANTY OF ANY KIND, either express or implied. See the
  License for the specific language governing rights and limitations under
  the License.
  
  The Original Source Code is SCIRun, released March 12, 2001.
  
  The Original Source Code was developed by the University of Utah.
  Portions created by UNIVERSITY are Copyright (C) 2001, 1994 
  University of Utah. All Rights Reserved.
-->

<HTML>

<HEAD>
  <TITLE>SCIRun-Developer FAQ</TITLE>
 <link rel=stylesheet type="text/css" href="../doc_styles.css">
</HEAD>

<BODY>

<!-- *************************************************************** -->
<!-- *************** STANDARD SCI RESEARCH HEADER ****************** -->
<!-- *************************************************************** -->
<center><img SRC="../images/research_menuheader.gif" usemap="#head-links" height="71" width="600" border="0"></center>
<map name="head-links">
	<area shape="rect" coords="491,15,567,32" href="http://www.sci.utah.edu/research/research.html">
	<area shape="rect" coords="31,9,95,36" href="http://www.sci.utah.edu">
	<area href="../InstallGuide/pseInstall.html" coords="0,45,150,70">
	<area href="../UserGuide/userguide.html" coords="150,45,300,70">
	<area href="../DeveloperGuide/devguide.html" coords="300,45,450,70">
	<area href="../ReferenceGuide/refguide.html" coords="450,45,600,70">
</map>
<!-- *************************************************************** -->
<!-- *************************************************************** -->

<H1>SCIRun-Developer FAQ</H1>
<BR>
<P>This FAQ was compiled from the scirun-develop mailing list
<HR>

<H2> Contents: </H2>

<UL>
  <LI><A HREF="#gen_prog">General Programming</A>
  <LI><A HREF="#cplusplus_and_tcl">C++ and TCL</A>
  <LI><A HREF="#surfaces_and_meshes">Surfaces and Meshes</A>
  <LI><A HREF="#design_and_modules">Design and Modules</A>
  <LI><A HREF="#cvs">CVS</A>
  <LI><A HREF="#compilation_problems">Compilation Problems</A>
</UL>

<A NAME="gen_prog">
<H2>General programming</H2>
<A HREF = "#q100">1.0.0   Passline plylines</A><BR>
<A HREF = "#q101">1.0.1   Naming ports</A><BR>
<A HREF = "#q102">1.0.2   File reader execution </A><BR>
<A HREF = "#q103">1.0.3   No culling error</A><BR>
<A HREF = "#q104">1.0.4   Compiler warnings</A><BR> 
<A HREF = "#q105">1.0.5   Dynamic casting</A><BR>
<A HREF = "#q106">1.0.6   Compiler errors</A><BR>
<A HREF = "#q107">1.0.7   Compiler errors, xdr_double failed</A><BR>
<A HREF = "#q108">1.0.8   system("sleep",10)</A><BR>
<A HREF = "#q109">1.0.9   Adding shared lib</A><BR>
<A HREF = "#q1010">1.0.10 Missing libvice.so</A><BR>
<A HREF = "#q1011">1.0.11 Refresh rates</A><BR>
<A HREF = "#q1012">1.0.12 Graphical Refresh Rates</A><BR>

<A NAME="cplusplus_and_tcl">
<H2>C++ and TCL</H2>
<A HREF = "#q200">2.0.0 C++ -> TCL arrays </A><BR>
<A HREF = "#q201">2.0.1 TCL::execute() </A><BR>
<A HREF = "#q202">2.0.2 Histogram TCL widget </A><BR>
<A HREF = "#q203">2.0.3 TCL and C variable synchronization </A><BR>
<A HREF = "#q204">2.0.4 TCL Object existence check</A><BR>

<A NAME="surfaces_and_meshes">
<H2>Surfaces and Meshes</H2>
<A HREF = "#q300">3.0.0 Looking at a large number of surfaces </A><BR>
<A HREF = "#q301">3.0.1 mesh->nodes[i]->elems[0] </A><BR>
<A HREF = "#q302">3.0.2 Mesh.h's </A><BR>
<A HREF = "#q303">3.0.3 Points in a polygon</A><BR>
<A HREF = "#q304">3.0.4 Unstructured mesh methods</A><BR>
<A HREF = "#q305">3.0.5 Material transparency</A><BR>
<A HREF = "#q306">3.0.6 Points to geometry</A><BR>
<A HREF = "#q307">3.0.7 Scalar field -> tetrahedral mesh</A><BR>
<A HREF = "#q308">3.0.8 Creating Meshes</A><BR>

<A NAME="design_and_modules">
<H2>Design and Modules</H2>
<A HREF = "#q400">4.0.0 SymSparseRowMatrix </A><BR>
<A HREF = "#q401">4.0.1 Interpolation </A><BR>
<A HREF = "#q402">4.0.2 ScalarFieldOcean </A><BR>
<A HREF = "#q403">4.0.3 Making a Scalar Field</A><BR>
<A HREF = "#q404">4.0.4 Viewing a ScalarFieldUG(sfug)</A><BR>
<A HREF = "#q405">4.0.5 Redraws in Salmon</A><BR>
<A HREF = "#q406">4.0.6 Standard Colormaps</A><BR>
<A HREF = "#q407">4.0.7 Isosurface differences</A><BR>
<A HREF = "#q410">4.1.0 Crystal Eyz</A><BR>
<A HREF = "#q411">4.1.1 Crystal Eyz stereo options</A><BR>
<A HREF = "#q412">4.1.2 Crystal Eyz missing option</A><BR>
<A HREF = "#q413">4.1.3 Crystal Eyz settings</A><BR>


<A NAME="cvs">
<H2>CVS</H2>
<A HREF = "#q500">5.0.0 fixcvs passwd </A><BR>

<A NAME="compilation_problems">
<H2>Compilation Problems</H2>
<A HREF = "#q500">6.0.0 gmake: *** No rule to make target... error </A><BR>


<HR>
<A NAME = "q100"> 
<H2><B>General Programming</B></H2><P>

<LI><B>1.0.0  I want to pass polyines (or just arrays of (2D) points)
through a data port.  What datatype/port should I look into using? </B>
<UL TYPE=NONE>
   <LI>I make a "mesh" out of them (with no tetra, and the points as
   the nodes) and pass it around.  It's a bit of a hack, but it works. 
   Alternatively, if you really want to make a new type, you can look at
   Datatypes/VoidStar.{cc,h} and make a Polyline2D class that derives from
   the VoidStar class.
</A></UL>


<A NAME = "q101">
<LI><B>1.0.1 Sometimes when I create a module, it has a large number of
input/output ports, and I can't tell what exactly is supposed to go
in to/out of each port.  Is there anyway to dynamically find this out?
Like middle clicking on the data port and it would give me some kind
of text message saying briefly what the port is for?   </B>
<UL TYPE=NONE>
   <LI>Yeah, this is a recurring problem.  I was gonna add the functionality you
   described above this past weekend, but I didn't get to it.  My plan is to
   use the string the user gives when creating the port in the module, and
   just cat it on to the type string you presently see when you click with
   the right mouse on the port (e.g. Mesh:Polyline).
</A></UL>


<A NAME = "q102">
<LI><B>1.0.2 I have a simple file reader that can read a series of files and send
them down the dataflow as a crude animator.  After the first file is 
sent I want to make sure that everything has executed before sending
the next file. How do I do this?</B>
<UL TYPE=NONE>
   <LI>Presently there isn't a good way to do this (as far as I know).  What I
   hacked together, since I knew exactly what modules I'd be using, was to
   add a semaphore that can be shared between your reader and whatever the
   last module downstream is.  Obviously this is a crude hack... but it does
   the job if you know your network in advance. </TD></TR>
</A></UL>

<A NAME = "q103">
<LI><B>1.0.3 Rather than dig through code, can anyone tell me what 
causes the "Error, no culling info" to appear in the xterm 
window while running SCIRun.  I'm guessing that I'm failing 
to set up some geometry correctly.</B>
<UL TYPE=NONE>
   <LI>I have never seen that error before.  It is time to get out your
   find/grep tools again...
</UL></A>

<A NAME = "q104">
<LI><B>1.0.4 In the process of fixing a few of the compiler warnings, I was
planning on removing the ";" at the end of the extern "C" blocks:<P>

> extern "C" {
> #include <semaphore.h>
> #include <pthread.h>
> };<P>

Does anyone know if this will cause a problem?</B>
<UL TYPE=NONE>
   <LI>No, that should be fine.
</UL>
</A>

<A NAME = "q105">
<LI><B>1.0.5 How do I use Dynamic casting in C++</B>
<UL TYPE=NONE>
   <LI>Here's a snippet showing how to use C++
dynamic casting.<P>

In the past we've accomplished this by giving the base class an enumerated
type local variable to indicate the derived type, and have made get()
methods in the base class to return the derived type (e.g.
getScalarFieldRG()).  But the compiler supports the dynamc_cast command
now, and it makes it possible to make new types without having to make
*any* changes in the Datatypes directory.<P>

Below I've included an example of how this is used -- the old call to the
base class's get method has been replaced by a call to dyanmic_cast.<P>

-----------------------<P>

   VoidStarIPort *iRT;<P>

...<P>

    VoidStarHandle RTHandle;<BR>
    DRaytracer *rt;<BR>
    iRT->get(RTHandle);<BR>
    if (!RTHandle.get_rep()) return;<BR>
//    if (!(rt = RTHandle->getDRaytracer())) {<BR>
    if (!(rt = dynamic_cast<DRaytracer*>(RTHandle.get_rep()))) {<BR>
      cerr << "RTracer error - expected DRaytracer type of RTHandle";<BR>
        return;<BR>
    }<BR>
</UL>
</A>

<A NAME = "q106">
<LI><B>1.0.6 I can't compile the Malloc directory because of an n32 vs o32 
problem:<P>

making all in ./Malloc...<BR>
        CC -g -n32 -mips4 -r8000  -I.. -I.  -c new.cc<BR>
        CC -g -n32 -mips4 -r8000  -I.. -I.  -c malloc.cc<BR>
        CC -g -n32 -mips4 -r8000  -I.. -I.  -c Allocator.cc<BR>
        CC -g -n32 -mips4 -r8000  -I.. -I.  -c AllocOS.cc<BR>
        rm -f ../lib/libMalloc.so<BR>
        CC -n32 -mips4 -r8000 -shared -Wl,-no_unresolved -update_registry ../so_locations -Wl,-woff,85 -o libMalloc.so new.o  malloc.o  Allocator.o  AllocOS.o   lock.o   -lc &&        mv libMalloc.so ../lib/libMalloc.so<BR>
ld32: FATAL 12: Expecting n32 objects: lock.o is o32.<BR>
*** Error code 2 (bu21)<BR>
*** Error code 1 (bu21)<P>

What do I do about this?
</B>
<UL TYPE=NONE>
   <LI>I think that the newer makefiles fix this, but if you don't want
to update, just go into Malloc and do:<BR>
as -n32 -o lock.o lock_mips.s<BR>
make<P>

You will need to do the same thing in Multitask.
</UL>
</A>

<A NAME = "q107">
<LI><B>1.0.7 ScalarFieldReader gave the following error when reading in 
a field I generated:<P>

scirun> xdr_double failed<P>

What does this mean? The scalar field seemed to work okay
downstream of the Reader.
</B>
<UL TYPE=NONE>
   <LI>This is an error message from the Pstreams code that reads in datatypes;
   in this case a double was expected.  How did you generate the data
   file that is being read in?  Sounds like a formatting error.
</UL>
</A>


<A NAME = "q108">
<LI><B>1.0.8 How do I set a pause into the ModuleX::execute() loop?
I am sending out a series of images and want to pause a specific
amount of time between them.
</B>
<UL TYPE=NONE>
   <LI>sleep(10) should work.
</UL>
</A>

<A NAME = "q109">
<LI><B>1.0.9 I need to add a shared library called mpeg (libmpeg.so).  The directory
containing the stuff to go into the library is /SCIRun/Modules/Salmon/mpeg
and contains a makefile that creates the shared library (using C).  

How do I get SCIRun to automatically create this library when it's built
(before the library will be needed)?</B>
<UL TYPE=NONE>
   <LI>The problem with normal adding packages with normal makefiles to the
   tree is that when it comes time to compile for another architecture (or
   even 64 bit on irix), the makefile must be edited by hand.  We are hoping
   to figure out autoconfig someday, but in the meantime, the right thing
   to do is to rename the makefile to makefile.dist and then create an
   Imakefile that does the same thing.  Add something like this:<P>

   SUBDIRS = mpeg<BR>
   SCISubdirs($(SUBDIRS))<P>

   to the Salmon Imakefile and it will descend into the mpeg subdirectory.
</UL>
</A>


<A NAME = "q1010">
<LI><B>1.0.10 When I compile the Salmon module, it give me a warning that it can't find
libvice.so, which is needed for proper transitive linking.  Is this
something that I should worry about? 
</B>
<UL TYPE=NONE>
   <LI>No, don't worry about it - it is an SGI "bug", but doesn't do any harm.
</UL>
</A>

<A NAME = "q1011">
<LI><B>1.0.11 I am trying to determine how fast/slow my haptics and graphics
are refreshing themselves. Does anyone know of a quick way
to time stamp, quicker than going out to read the system clock?<BR>

For the graphics refresg rate, can I rely on that timing
information on the Roe window? You know, in the lower left
where it reports performance statistics
in terms of polygons per second and frames per second?<P>

1. how accurate is that frames/sec printout?<BR>
2. are those averages? Over how many samples?
</B>
<UL TYPE=NONE>
   <LI>Use the Clock.cc in Datatypes. it will give you the time in ticks.
   to convert to msec multiply by cycleval*1e-9.
</UL>
</A>


<A NAME = "q1012">
<LI><B>1.0.12 Okay, so I am running an interactive system using Salmon to handle
the graphics and I simply want to know how often Salmon is refreshing
one or two specific graphical objects.

Yarden told me about the Clock.cc methods for getting timing
information. But where do I put in the timer reads? I could easily
find out how often my module does an addObj for the object I'm
interested in, but that doesn't actually tell me when or how often
Salmon responds to the addObj. Until now I haven't tried to figure out
how Salmon does its upstream-ing.
</B>
<UL TYPE=NONE>
   <LI>Did you try looking in the Salmon.cc code for a method called
   addObj?  I'm pretty sure there is one.  Basically, addObj is a message that
   gets passed to Salmon and Salmon responds by invoking its own addObj
   method, I believe.  You could just put a timer or a counter in there (if
   you know the name of the object, I'm sure you could print out the timer
   information every time an object with that name is added, right?)
</UL>
</A>





<A NAME = "q200"><P> 
<H2><B>C++ and TCL</B></H2>
<P>
<LI><B>2.0.0 How do I send an array from C++ to tcl  </B>
<UL TYPE=NONE>
   <LI>TCL doesn't support arrays -- just strings.  You have to cast your array
   into a string, send it over, and unpack it on the other side.<BR>

   More specifically, in C++, pack your data into a string, with components 
   separated by white space.  In tcl use "split" to turn the string into an 
   array.  Go crazy. Of course this only works when you are asking for the data 
   from TCL and you are returning it from C++ in the tcl_command function via the 
   args.result() command.<BR>

   If you are sending the data via a "TCL::execute" or "TCL::eval" the the tcl 
   function definition must have "args" as its final parameter.  "args" is 
   automatically considered a list and you can merely iterate through it. ie.<P>

   --- C++<BR>
   clString yourData // your transformed array<P>

   TCL::execute( id + " handleArray " + yourData)<BR>
   ---------------------<P>

   --- Tcl<P>

     method handleArray { args } {<BR>
        set l [llength args]<BR>
            ...<BR>
        }<BR>
   ----------------------<BR>

</UL></A>

<A NAME = "q201"> 
<LI><B>2.0.1 Is this true?
A call to TCL::execute() in C++ code does not wait for the 
function return.</B>
<UL TYPE=NONE>
   <LI>That is not true, the call to TCL::execute does wait for the function
   to return.  However, things like creating widgets use the "after idle"
   functionality in Tk, so the actual widgets aren't created until some
   point in the future.
</UL>
</A>

<A NAME = "q202">
<LI><B>2.0.2 Has anyone used the Histogram widget James Purciful wrote ? 
I have one example which uses it, MeshView.cc, but it doesn't
use all the features I am trying to use.<P> 

Histogram::SetRange() doesn't update the graphical display
of the range. And using the histogram more than once with
the same data seems to gunk up the display. 
</B> 
<UL TYPE=NONE>
  <LI>The Histogram widget is pretty brain-damaged.  It is very slow, and as
  a result, has never been used outside of meshview.  Unfortunately, you
  are the first one brave enough to look under the hood.  If you have
  specific questions about what it is doing, perhaps other people could
  help look at it too.

</UL>
</A>

<A NAME = "q203"> 
<LI><B>2.0.3 Can anybody tell me why it is that a variable value change 
in tcl does not create an instantaneous change in the 
corresponding C++ variable?<P>

I can take care of the problem by passing the value from 
tcl to C++, but I don't understand why this is necessary.
</B>
<UL TYPE=NONE>
   <LI>These updated are handled by a separate thread, so they're
   asynchronous.  You can force all the TCL variables to update by calling
   "reset_vars()" in your C++ code before you do your get().<P>

   The TCLvarint and vardouble classes are more efficient for these
   types of updates, and they do not need to be reset.
</UL>
</A>


<A NAME = "q204">
<LI><B>2.0.4 Anyone know how to check and see if a tcl object exists?
</B>
<UL TYPE=NONE>
   <LI>try:<BR>
if {[winfo exists $w]} {puts "$w exists" }
where w is set to the path (name) of the tk window you are looking for.
A perfect example is in GenStandardColorMaps.tcl written by Zimmerman
</UL>
</A>




<A NAME = "q300"> 
<H2><B>Surfaces and Meshes</B></H2><P>

<LI><B>3.0.0 I'm trying to look at 40 different surfaces (one for each major muscle
region in my model) in scirun. I've been trying to build the sr file in
pieces but I've gotten to the point where I can't add on any more. So far
I've read in 20 surfaces and I have 20 more SurfaceReader Modules in my
network layout but not connected. I got about 10 SurfaceToGeom modules
added and then I got this error:<P>

sprocsp: No space left on device<BR>
Task::exit_all sending SIGQUIT to thread group<P>

Does anyone know what I need to do to get around this problem? Is there
something I need to get the support people to do here at MSI to get this to 
work? </B>
<UL TYPE=NONE>
   <LI>You can compine multiple TriSurfaces into a single TriSurface.

   <P>There's no restriction about connectivity - they just won't show up as
   separate items in the Salmon list.

   You can write a program in the convert directory that will take in a list
   of surfaces and write them out as one large surface.

   I've created a new convert program called "CombineTriSurfs".  It's in
   ~dmw/hwork/convert/CombineTriSurfs.cc -- make sure to add an Imakefile
   entry and do a "make Makefile" in convert before compiling it.<P>

   Then, there's two modes to run it in 1) interactive; or 2) command-line.<P>

   For interactive, don't give it any command line arguments.  It will prompt
   you for all of the input filenames... when you're done entering them, just
   give it an invalid filename.  Then it will ask you for a name of the
   surface -- this just gets stored in the file and is the name that shows up
   in the Salmon list.  Finally it will ask you for an output filename.<P>

   For command line, give it all of the above info on the command line.
   Specifically, list all of the input files, then the name of the surface
   (which will show up in Salmon), then the name of the output file.<P>

   All of the above usage info is available if you type CombineTriSurfs with
   an illegal number of arguments (i.e. one or two).
</UL></A>

<A NAME = "q301"> 
<LI><B>3.0.1 I have a mesh of Leonid's that won't let me access the
node element list or the element faces list.<BR>

I need at least one of those options to work because I need
to trace from a node to its neighbors.
Accessing mesh->nodes[i]->elems[0] causes a crash.<BR>

This mesh has had orient() called for each element and
compute_neighbors() called for the mesh, but sr
crashes when I try to access the nodes[i]->elems[0].
I broke it down and checked in dbx and it's definitely
the elems array, not the nodes array.<BR>

I remember Leonid telling me something about each node
being listed multiple times in the node array. Is that
causing my problem?<BR>

I tried instead the faces[] approach, but I don't know
what I need to do to get the array populated. I tried
calling compute_face_neighbors() on the mesh but that
also crashed. Then do I use the faces[] array or the
face() hash function? Or was all that stuff just meant
for the Delaunay-specific mesh code?
</B>
<UL TYPE=NONE>
   <LI>If the mesh isn't "clean" there is now way the topology can be
   accurate, this might not be a clean mesh problem though.<P>

   If a node isn't listed in any element, a crash is the correct behavior
   for this.  The elems arrays are computed when the mesh is loaded in
   (after you've read in the nodes and elements you run through the
   elements and add themselves to the "elems" array of the 4 nodes that
   define that element.)  No element contains node[i] in your code.  If
   this is your region "select" code, make sure elems.size() is > 0
   before you look at the selected node...<P>

   If leonids mesh has multiple indeces for the same node (ie: same point
   in space listed multiple times) you cannot walk the connectivity
   structures - it will think there are internal boundaries in the mesh.<P>

   It is really easy to write code to "fuse" identical points, but you
   have to be very careful how you define "identical" (ie: you don't want
   to make degenerate tets - this is easy to detect as well, if you fuse
   and a tet has multiple references to the same node you are horked.)<P>

   My guess is that your problem here is that you are looking at a node
   that isn't actually used in any of the elements, if you want to use
   the topology you will need to clean up the mesh.
</UL>
</A>

<A NAME = "q302"> 
<LI><B>3.0.2 Could someone tell me what the difference between these two Mesh.h's
are?<P>

SCIRun/Datatypes/Mesh.h <BR>
SCIRun/Modules/Simplify/Mesh.h</B>
<UL TYPE=NONE>
   <LI>I think that is a version I used for the tetrahedral simplification
   code I was working on.  I had to use a significantly different Mesh
   structure (the one in Datatypes is really ineficient (node handles,
   mesh pointers), and I wanted a sparser topological data structure (no
   explicit node neighbors) but didn't want to break everybody else.
   Heavy weight topology is a pain if you are trying to modify a mesh...)<P>

   I also have a 2D mesh in there somewhere which has topology
   (again, didn't want to have to break everybody else, but wanted to
   work on simplification code - this time TriSurf is the one it's
   basicaly replacing.)<P>  

   I checked that in so that if anyone wanted to work on the tet
   simplification they could pick it up from there (same goes for the
   non-manifold surface simplification - neither of those files are in
   the makefiles.)
</UL>
</A>

<A NAME = "q303"> 
<LI><B>3.0.3 Does someone out there have a piece of code that determines if a
point is inside a polygon?
</B>
<UL TYPE=NONE>
<LI>Yes
</UL>
</A>

<A NAME = "q304">
<LI><B>3.0.4 Somebody please explain the unstructured Mesh class to me.
Datatypes/Mesh.{h,cc}  I think what I need to know lies 
in the neighbors() methods or maybe the hashing.<BR>  

Here's what I want to do with a mesh:<BR>
My user picks a tetrahedron he/she
is interested in. I want to quickly determine its
neighbors, and maybe its neighbors' neighbors, and
display that subset of the mesh in Salmon. And I
mean QUICKLY: I need to do this often and as fast
as a user can drag the mouse across the mesh.<BR>

Can I do this with the unstructured Mesh class or 
do I need do construct some other connectivity
data structure? <BR>


I also want to draw a subset of the mesh: those full elements
which lie within a cartesian space range, say from left back 
corner (x,y,z) to front right corner (x2,y2,z2).

The reason I want to do this is to be able to
shrink the amount of the mesh I draw until it is small
enough to redraw at interactive rates on the given machine.

I think this means I need to construct a new mesh containing
those elements which fall within the specified range.
 
How do I do this? Iterate through the node array looking 
for nodes within the range and add them to a new mesh?</B>
<UL TYPE=NONE>
   <LI>The unstructured mesh class already has topology information in it.
   The face neighbor information can be lazily built (the default I
   believe) or it can be explicitly built with the
   compute_face_neighbors() function.  The other connectevity information
   is an array of all of the elements connected to each node (the elems
   array in the node data structure.)  This is in sorted order.  If you
   want to create a depth first search I would recomend allocating an
   array the size of the elements (or nodes depending on how you want to
   define the search) and keeping track of a current "valid" number.
   When you search you only progress into elements whose valid is < the
   current one.  You can partialy clear this if you think you are going
   to do more then 2^32 "searches", this would make more sense if you
   used a byte (this is what "FastClearBits" are on graphics
   accelerators.  They allow you to clear 1/256th of the frame buffer
   instead of the whole thing...)
</UL>
</A>

<A NAME = "q305">
<LI><B>3.0.5 I want to draw some translucent triangles but I'm 
having trouble doing so.<BR>

I can set the transparency of a Material and then use
it to draw some GeomObjs, but it doesn't seem to use
the transparency setting.<BR> 
 
I looked at GeomOpenGL.cc and when it's setting the Color
via glColor4f() it knows about an alpha, but I 
don't see anywhere where Material transparency gets 
used to set the alpha. Nor do I see where I can set
the alpha for each Color I use because all the Color
class seems to take is (R,G,B).<BR>

How do I provide an alpha to GeomOpenGL for my
triangles? 
</B>
<UL TYPE=NONE>
   <LI>SCIRun doesn't do this by default.  The reason - in order to correctly
   draw transparent triangles, the triangles must be sorted and rendered
   in a back to front order.  Besides being slow, this is a pain in
   SCIRun where the triangles may come from different parts of the scene
   graph.<P>

   Options are:<BR> 
   1) Figure out a different way to do what you are doing - perhaps
   wireframe mode?<BR>
   2) Figure out what Peter-pike was doing with GeomTransTrianglesP<BR>
   3) Implement something simple that would work if you have just
   a few triangles.<BR>

</UL>
</A>


<A NAME = "q306">
<LI><B>3.0.6 I want to generate a deformed plane and visualize it
as a solid surface with lighting to help me see the
shape.

What's the quickest way to go from a set of points
generated over a regular grid to a solid surface?
Can you point me to a code example? I don't see 
anything obvious in my or Dave W.'s convert 
directories.

I tried generating a file for PointsReader, which
outputs a mesh, but it's not the kind of mesh
MeshToGeom needs because it has only a nodes
array, no elems array.</B>
<UL TYPE=NONE>
   <LI>There are two ways to do this:<P>

1) Make a TriSurface with the nodes and triangles - see convert/VPtoTriSurf.cc
   for an example.  Then read it into SurfaceReader and SurfToGeom<P>

2) Write a module that uses the GeomGrid primitive.  See
   Visualization/CuttingPlane.cc and Image/ImageToGeom.cc for examples.
   The latter example is simpler, so look at it first.<BR>

</UL>
</A>


<A NAME = "q307">
<LI><B>3.0.7 I'm trying to create a tetrahedral mesh from a scalar field defined on
a regular grid (to compare my unstructured code to that of my regular
grid core).  Is there a module somewhere to do this?</B>
<UL TYPE=NONE>
   <LI>There isn't exactly a module to do this.  There is a convert
   program, though (~dmw/hwork/convert/RGtoUG.cc -- no guarantees of
   correctness, since I just hacked this together... seems to work, though).

</UL>
</A>


<A NAME = "q308">
<LI><B>3.0.8 I'd like to generate a set of simple tetrahedral meshes. They can be
regular grids. Is there something in the convert directory to generate
a mesh from a set of grid points?</B>
<UL TYPE=NONE>
   <LI>You can generate a SCIRun Mesh from a SegFld - the conductivity is
assigned based on the value of the cell (classified data), where cells
containing value '0' are removed from the Mesh.

</UL>
</A>




<A NAME = "q400"> 
<H2><B>Design and Modules</B></H2><P>

<LI><B>4.0.0 What is the reason for designing SymSparseRowMatrix to
use primitive arrays of ints and doubles for columns, rows and a,
instead of use the Array1 datatype?  was it performance?</B>
<UL TYPE=NONE>
   <LI>It is just for performance.  The arrays do not change size, so the
   Array1 is overkill.
</UL>
</A>

<A NAME = "q401"> 
<LI><B>4.0.1 I'm having some trouble understanding the interpolation
on a ScalarFieldUG. It looks as though interpolate()
looks at the mesh elements and sees if the point
is inside each element?  </B>
<UL TYPE=NONE>
  <LI>That is correct.  When it finds the containing element, it
  uses the shape functions to construct the weights for interpolation.
  Or if it is a piecewise constant element (typ == ElementValues), then
  it just returns that data value.
</UL>
</A>

<A NAME = "q402"> 
<LI><B>4.0.2 Does anyone know what "ScalarFieldOcean" (in Datatypes) is and
whether it should compile or should be deleted?</B>
<UL TYPE=NONE>
   <LI>It supports the data format for the global ocean model from Los Alamos.
It should probably be moved down into one of the SCIRun directories.
</UL>
</A>

<A NAME = "q403">
<LI><B>4.0.3 I have several 'time instants' of data that I want to display on a
surface. I have a scirun surface but the data is in ascii files of a single 
potential on each line corresponding to the node it belongs to. How do I
get this data into scirun and step through the data files in the
display?</B>
<UL TYPE=NONE>
   <LI>I can't tell you exactly how to do it, but the general method Dave W.
   showed me is to read the data into the type of SCIRun object most
   appropriate and then write it out using Pio(stream, object).<P>

   An example using a VectorFieldRG Dave W. wrote is in:
   /home/dmw/hwork/convert/GenVolume.cc
   Hopefully it isn't too difficult to translate that code into
   ScalarFieldRG or ScalarFieldUG.
</UL>
</A>

<A NAME = "q404">
<LI><B>4.0.4 Okay, so now I have an sfug (ScalarFieldUG). What modules do I need to view 
it. It looked like the output from sf reader would go into surftogeom but 
that didn't seem to work. Do I need to do SFUG to surface first?</B>
<UL TYPE=NONE>
   <LI>You have two basic choices - IsoSurface and CuttingPlane.  Both
   of them let you visualize an unstructured ScalarField.  I think you've
   seen the IsoSurface module before, so I'll skip that explanation.<P>

   The CuttingPlane module will take a cut through the data (in an arbitrary
   plane).  The result is scalar values on a plane, which can then
   color-mapped (you pass in a ColorMap to the module -- you'll want to take
   a ColorMap (possibly from GenTransferFunc), pass it through
   RescaleColorMap along with your SFUG, and then pass the resultant ColorMap
   into the CuttingPlane module).  Now you have colors associated with
   data-values on a plane, and can view it as contours, a colormapped plane,
   or a height-field -- you just choose which option you want on the UI.
</UL>
</A>

<A NAME = "q405">
<LI><B>4.0.5 I want to display two things in a Roe window:<P>

 a huge mesh from a single vantage point, and 
 some 3D cursor (by cursor I mean a simple graphical object
to tell the user where he/she is in 3space
such as a crosshair or point
or something that is either a 3D Widget or
my own simple graphical icon) <P>

I suspect that every time I update the position
of the cursor, Salmon will have to spend a lot
of time redrawing the mesh as well. Is this
true? Even if nothing about the mesh changes?
Is there some way around it? <P>

When I was writing straight OpenGL, I was able
to reserve a bit plane for just the 3d cursor 
and limit the redraws just to that plane.
</B>
<UL TYPE=NONE>
   <LI>Unfortunately, the answer is that it isn't very easy to to this
   in Salmon (i.e. it has never been done before).  We have talked
   about adding a similar feature, but we have always held out for
   Cosmo3D/OpenGL++/Fahrenheit/SGI-scene-graph-toolkit-du-jour
</UL>
</A>

<A NAME = "q406">
<LI><B>4.0.6 What are the standard colormaps? </B>
<UL TYPE=NONE>
   <LI>gray<BR>
   inverse gray<BR>
   rainbow<BR>
   darkhue (so coined by Gordon)<BR>
   blackbody<BR>
</UL>
</A>

<A NAME = "q407">
<LI><B>4.0.7 What's the difference between isosurface, isosurfacedw, and isosurfacesp
(other than the obvious authors of the last two...)?</B>
<UL TYPE=NONE>
   <LI>Isosurface was the first one written.  I wrote IsosurfaceDW in order to be
able to build trisurface's when extracting (as opposed to just
GeomTri's)... and IsosurfaceSP is just like IsosurfaceDW - I think it's
just hard-coded to use one processor, though.
</UL>
</A>



<A NAME = "q410">
<LI><B>4.1.0 Will Crystal Eyz glasses work with SCIRun? Do I simply choose  one of
the stereo options on the Roe menu, or do I need to add some specific
code first?  I remember something Peter-Pike said about it requiring
only about 8 lines of code. Maybe that was _before_ he tried doing it,
though!
</B>
<UL TYPE=NONE>
   <LI>The stereo button on Roe will work.<P>
</UL>
</A>

<A NAME =  "q411">
<LI><B>4.1.1 There's "stereo" options on the Roe->Visualize menu. Do you mean
those, or Is that the button on the bottom part of the Roe window, the
part that pops up when you hit the + button?</B>
<UL TYPE=NONE>
   <LI>You need both.  You select a stereo visual, and then click the stereo
   button that pops up under the +.<P>
</UL>
</A>

<A NAME = "q412">
<LI><B>4.1.2 I don't have that button. I've seen it on other people's windows.
What files would I need to update to get it to work?</B>
<UL TYPE=NONE>
   <LI>Updating only parts of the tree is a really big can of worms, and
   I do not recommend that people do it.
</UL>
</A>

<A NAME = "q413">
<LI><B>4.1.3 What settings am I supposed to use in the Roe->Visualize menu, anyway?
I have seen Dave toggle between some of them to get things to look better.</B>
<UL TYPE=NONE>
   <LI>In order for stereo to work, you need to select a visual that has
   the word "stereo" listed.  Other than that, you probably want the one
   with the largest R,G,B components for your application.
</UL>
</A>

<A NAME = "q500"> 
<H2><B>CVS</B></H2><P>

<LI><B>5.0.0 Okay, I did the fixcvs thing, but it seems to think that I am part of
C-SAFE and asks for my passwd.  What is up with this? </B>
<UL TYPE=NONE>
   <LI>I think this happens the first time you try to connect to a host.  Try
   "ssh"ing to the host in your CVSROOT variable and see if it goes
   directly through or ir it asks you any questions.  If it asks you to
   continue, say yes, log out, and try it again.  If/when it goes
   directly through, try your cvs request again.  It should work.
</UL></A>

<A NAME = "q600"> 
<H2><B>Compilation Problems</B></H2><P>

<LI><B>6.0.0 I get a "gmake: *** No rule to make target..." error.  
       What's up with this?</B>
 <UL TYPE=NONE>
   <LI> When you see this type of error, the problem almost always is
        that the file that is needed has been removed from the
	repository.  However, the depend.mk file has not been updated
	and still thinks that the file is necessary for the build.
	The quick fix is to go into the depend.mk file and remove all
	references to CreateModulePackage.
 </UL>


<HR>
Mail additions, updates, modifications, and deletions to <A
HREF=mailto:morris@cs.utah.edu><I>morris@cs.utah.edu</I></A><BR>

<BR>
Last modified on:
<SCRIPT LANGUAGE="JavaScript">document.write(document.lastModified)</SCRIPT>
<BR>
<!-- ******************************************************************* -->
<!-- *********************** STANDARD SCI FOOTER *********************** -->
<!-- ******************************************************************* -->
<center>
<hr size="1" width="600">
<font size="-1"><a href="http://www.sci.utah.edu">Scientific Computing and Imaging Institute</a> &#149; <a href="http://www.utah.edu">University of Utah</a> &#149; 
(801) 585-1867</font>
</center>
<!-- ********************* END STANDARD SCI FOOTER ********************* -->
<!-- ******************************************************************* -->
</BODY>
</HTML>