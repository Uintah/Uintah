<!--
  The contents of this file are subject to the University of Utah Public
  License (the "License"); you may not use this file except in compliance
  with the License.
  
  Software distributed under the License is distributed on an "AS IS"
  basis, WITHOUT WARRANTY OF ANY KIND, either express or implied. See the
  License for the specific language governing rights and limitations under
  the License.
  
  The Original Source Code is SCIRun, released March 12, 2001.
  
  The Original Source Code was developed by the University of Utah.
  Portions created by UNIVERSITY are Copyright (C) 2001, 1994 
  University of Utah. All Rights Reserved.
-->

<!doctype html public "-//w3c//dtd html 4.0 transitional//en">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<meta name="GENERATOR" content="Mozilla/4.7 [en] (X11; I; Linux 2.2.14-mc-smp i686) [Netscape]">
<meta name="Author" content="Martin Cole">
<link rel=stylesheet type="text/css" href="../doc_styles.css">
<title>Specification Procedure</title>
<!-- Changed by: Mjc, Mon Nov 13 08:28:40 MST 2000 -->
</head>
<body>

<!-- *************************************************************** -->
<!-- *************** STANDARD SCI RESEARCH HEADER ****************** -->
<!-- *************************************************************** -->
<center><img SRC="../images/research_menuheader.gif" usemap="#head-links" height="71" width="600" border="0"></center>
<map name="head-links">
	<area shape="rect" coords="491,15,567,32" href="http://www.sci.utah.edu/research/research.html">
	<area shape="rect" coords="31,9,95,36" href="http://www.sci.utah.edu">
	<area href="../InstallGuide/pseInstall.html" coords="0,45,150,70">
	<area href="../UserGuide/userguide.html" coords="150,45,300,70">
	<area href="../DeveloperGuide/devguide.html" coords="300,45,450,70">
	<area href="../ReferenceGuide/refguide.html" coords="450,45,600,70">
</map>
<!-- *************************************************************** -->
<!-- *************************************************************** -->

<!- TITLE OF PAGE ->
<p class="title">Module Design/Implementation Procedure</p>
<p class="subtitle">(Updated: Tue Sep 26 13:33:40 MDT 2000)</p>

<p class="firstpara">Every module will have an associated specifications file associated with it. This file will be &lt;<i>ModuleName</i>>.xml. This document describes the module writing procedure that we are encouraging every module writer to follow. The complete set of documentation for a module live in the code itself and in the specification file. Typically a module has a .cc file and a .xml file.</p>

<p class="head">Table of contents</p>
<ol class="toc">
<li><a href="#chalk talk">Chalk Talk</a></li>
<li><a href="#spec">Design Specification</a></li>
<li><a href="#module maker">Module Maker</a></li>
<li><a href="#coding">Coding</a></li>
<li><a href="#testing">Testing</a></li>
<li><a href="#final pass">Final pass over the specification.</a></li>
<li><a href="#code submission">Code Submission</a></li>
<li><a href="#example">Example Module</a></li>    
</ol>


<p class="firstpara">Following the above steps will ensure a consistent well documented set of modules for researchers to work with. A module is not just the execute method.</p>

<p class="head"><a NAME="chalk talk"></a>Chalk Talk</p>
<p class="firstpara">Prior to anything else, it would be ideal if you bounce your module idea off of some of your peers. Talk to at least two other module developers about your design. This could help in many different ways. It could save you from doing it at all, or dramatically reduce your effort, by exposing previously written code. It can solidify your design idea, or enhance it. These do not have to be long discussions, but they need to be long enough to get the design across, and allow for feedback.</p>

<p class="head"><a NAME="spec"></a>Create Specification</p>
<p class="firstpara">This specification is an xml file whose structure is defined by component.dtd. This file will contain information that the Module Maker will need to automatically generate the files for your module. It will contain all of the specifications and documentation about the module.  The xml structure is decribed in detail in <a href="component.html">XML Component Specification Guide</a></p>

<p class="nextpara">Documentation for all modules will be extracted from the collection of these files. This document will live in the Package XML directory, much like the .tcl file lives in the GUI directory. It will need to be kept current just as the .cc needs to be current. Familiarize yourself with the more detailed description of the structure of the file and its contents. If your module has a gui, you will need to get a screen capture of the dialog, and place in ./doc/&lt;<i>ModuleName</i>>.gif. Remember that when you add a binary file you need to use the -kb option like this: <b>cvs add -kb &lt;<i>ModuleName</i>>.gif </b></p>

<p class="nextpara"><a href="psgmlInEmacs.html">There is an xml-mode for emacs that is
useful.</a> It makes editing the xml file easier to read and help you choose the right tag to add at the right spot.</p>

<p class="nextpara">The entire file need not be filled out at this point. In the design stages this document will help you to specify the target you are coding to. Start at the top and fill in as much as you know now. You should be now know which ports you will need for the module, so be sure to fill that part out fully. Module Maker will make use of this information.</p>

<p class="head"><a NAME="module maker"></a>Module Maker</p>
<p class="firstpara">You have a somewhat fleshed out specification at this point. Now you want to write the module. You will need to edit a number of files and create some more. Module <a href="create_module.html">Maker will automate this process for you.</a></p>

<p class="head"><a NAME="coding"></a>Coding</p>
<p class="firstpara">Familiarize yourself with the <a href="http://www.csafe.utah.edu/development_environment/coding_standards/index.html">coding standard</a>. Follow it. If you use emacs, there are tools to make your coding standard efforts easy. Remember that the code you write will be public. Be sure that you can put your name in the author slot with pride. As you code you will make subtle changes to your design, be sure to frequent your specification.xml file and update it. Be sure that you have removed all warnings, and have a clean compile.</p>

<p class="head"><a NAME="testing"></a>Testing Your Module</p>
<p class="firstpara">Exercise your code. Make sure you force it down all possible code paths that you create, and that your module handles all possible input data that your input ports can provide. Crashing is bad. Doing nothing is bad. Handle errors appropriately. Be sure you test each widget in your gui.</p>

<p class="head"><a NAME="final pass"></a>Final Check of xml data</p>
<p class="firstpara">Your code works. You have made all the subtle changes to the code that the testing phase exposed, and it works as intended. Before you commit this code, take one last pass through the &lt;<i>ModuleName</i>>.xml file. Make sure all of your changes are reflected in it.</p>

<p class="head"><a NAME="code submission"></a>Code Submission</p>
<p class="firstpara">Update the repository. Commit the changes you made to the .h, .cc, .mk, tcl, and .xml files for this module. Add the files you created to the cvs repository. If you had to create the ./doc directory, you will also have to create it in the cvs source tree before checking in the files underneath it. <a href="cvs_info.html">checking things into cvs.</a></p>

<p class="head"><a NAME="example"></a>Example Module</p>
<p class="firstpara">An example module that has followed this procedure is ShowGeometry. This module lives on the FIELD_REDESIGN branch. The following files make up the module:
<br>
<br>SCIRun/src/Dataflow/Modules/Fields/ShowGeometry.cc
<br>SCIRun/src/Dataflow/XML/ShowGeometry.xml
<br>SCIRun/src/Dataflow/Modules/Fields/doc/ShowGeometryGUI.gif
<br>SCIRun/src/Dataflow/GUI/ShowGeometry.tcl
<br>
<br>Please note that even .tcl files can have comments and descriptive variable names.
</p>
<p class="nextpara">This example is code in progress and as such <b>all</b> of the above files will change frequently. The main thing to remember is that all files are always <i>live</i> files until they are retired from the tree. Assume that your code will have a long life, with perhaps many authors.</p>

<!-- *********************** STANDARD SCI FOOTER *********************** -->
<!-- ******************************************************************* -->
<center>
<hr size="1" width="600">
<font size="-1"><a href="http://www.sci.utah.edu">Scientific Computing and Imaging Institute</a> &#149; <a href="http://www.utah.edu">University of Utah</a> &#149; 
(801) 585-1867</font>
</center>
<!-- ********************* END STANDARD SCI FOOTER ********************* -->
<!-- ******************************************************************* -->
</body>
</html>
