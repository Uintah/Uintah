#LyX 2.0 created this file. For more info see http://www.lyx.org/
\lyxformat 413
\begin_document
\begin_header
\textclass report
\begin_preamble
\usepackage{color}
\usepackage[font=small,labelfont=bf,margin=0.5in]{caption}
\newrefformat{lst}{Listing (\ref{#1})}
\newrefformat{eq}{Eq. (\ref{#1})}
\newrefformat{lem}{Lemma \ref{#1}}
\newrefformat{cla}{Claim \ref{#1}}
\newrefformat{thm}{Theorem \ref{#1}}
\newrefformat{cha}{Chapter \ref{#1}}
\newrefformat{sec}{Section \ref{#1}}
\newrefformat{rem}{Remark \ref{#1}}
\newrefformat{fac}{Fact \ref{#1}}
\newrefformat{sec}{\S \ref{#1}}
\newrefformat{sub}{\S \ref{#1}}
\newrefformat{subsec}{\S \ref{#1}}
\newrefformat{cor}{Corollary \ref{#1}}
\newrefformat{cond}{Condition \ref{#1}}
\newrefformat{con}{Conjecture \ref{#1}}
\newrefformat{def}{Definition \ref{#1}}
\newrefformat{pro}{Proposition \ref{#1}}
\newrefformat{tbl}{Table \ref{#1} }
\newrefformat{fig}{Fig. \ref{#1}}
\usepackage{color}
  \definecolor{darkblue}{rgb}{0.0,0.0,0.5}
  \definecolor{darkred}{rgb}{0.8,0.0,0} % MOD: added darkred color
\definecolor{codegray}{RGB}{240,240,240}

\usepackage{listings}
\lstset{
  backgroundcolor=\color{codegray},
  captionpos=b,
  numberstyle={\tiny \sffamily},
  frame=lines,
  basicstyle={\small \ttfamily},
  language={XML},
  keywordstyle=\color[rgb]{0,0,1},
  commentstyle=\color[rgb]{0.133,0.545,0.133},
  stringstyle=\color[rgb]{0.627,0.126,0.941},
  breaklines=true,
 showstringspaces=false
} 
\usepackage{savesym}
\usepackage{amsthm,amsmath,amssymb}
\usepackage[varg]{txfonts} % this should always be invoked AFTER ams packages
\end_preamble
\use_default_options false
\maintain_unincluded_children false
\language english
\language_package default
\inputencoding auto
\fontencoding global
\font_roman times
\font_sans default
\font_typewriter default
\font_default_family rmdefault
\use_non_tex_fonts false
\font_sc false
\font_osf false
\font_sf_scale 100
\font_tt_scale 100

\graphics default
\default_output_format default
\output_sync 0
\bibtex_command default
\index_command default
\paperfontsize 12
\spacing single
\use_hyperref true
\pdf_title "Wasatch"
\pdf_author "Tony Saad, James C. Sutherland, Amir Biglari"
\pdf_subject "Documentation of the Wasatch CFD Component"
\pdf_keywords "Uintah, Wasatch, CFD, Pressure Projection, Variable Density Flow, Population Balances"
\pdf_bookmarks true
\pdf_bookmarksnumbered true
\pdf_bookmarksopen true
\pdf_bookmarksopenlevel 1
\pdf_breaklinks true
\pdf_pdfborder true
\pdf_colorlinks true
\pdf_backref section
\pdf_pdfusetitle true
\pdf_quoted_options "linkcolor=blue,citecolor=red,urlcolor=blue,filecolor=blue"
\papersize default
\use_geometry true
\use_amsmath 0
\use_esint 0
\use_mhchem 0
\use_mathdots 0
\cite_engine natbib_authoryear
\use_bibtopic false
\use_indices false
\paperorientation portrait
\suppress_date false
\use_refstyle 0
\index Index
\shortcut idx
\color #008000
\end_index
\leftmargin 1in
\topmargin 1in
\rightmargin 1in
\bottommargin 1in
\secnumdepth 3
\tocdepth 3
\paragraph_separation indent
\paragraph_indentation default
\quotes_language english
\papercolumns 1
\papersides 1
\paperpagestyle default
\listings_params "tabsize=2"
\tracking_changes false
\output_changes false
\html_math_output 0
\html_css_as_file 0
\html_be_strict false
\end_header

\begin_body

\begin_layout Title
Wasatch Documentation
\end_layout

\begin_layout Author
Tony Saad, James C.
 Sutherland, Amir Biglari, Alex W.
 Abboud
\end_layout

\begin_layout Standard
Wasatch is a finite volume computational fluid dynamics (CFD) code that
 employs the spatial operator (SpatialOps) and expression (ExprLib) libraries
 at its foundation.
 It is developed as a software component within the Uintah computational
 parallel framework.
 Wasatch provides the interface between the Uintah API and the various classes
 and tools supplied by the SpatialOps and ExprLib libraries making its developme
nt entirely based on the expressions graph abstraction.
 
\end_layout

\begin_layout Standard
\begin_inset CommandInset toc
LatexCommand tableofcontents

\end_inset


\end_layout

\begin_layout Chapter
Capabilities
\end_layout

\begin_layout Standard
Wasatch currently supports basic physical models of transport phenomena
 in fluids and gases.
 These may be reactive with variable density or non-reactive.
 The working model is based on writing expressions that reflect physical
 processes, akin to mathematical terms in a partial differential equation
 (PDE).
 These expressions are subsequently used in a variety of transport equations
 as needed.
 Transport equations are derived from a base class and each specializes
 in solving a particular class of problems.
 Currently, Wasatch currently supports the following transport equations
 with constant density:
\end_layout

\begin_layout Itemize
Generic scalar transport
\end_layout

\begin_layout Itemize
Momentum transport
\end_layout

\begin_layout Itemize
Population balances via moment transport
\end_layout

\begin_layout Standard
A wide range of expressions are currently implemented in Wasatch.
 These include the standard convective and diffusive fluxes as well as stresses
 as well as a variety of source terms that are inherent from specific physical
 models such as precipitation among others.
\end_layout

\begin_layout Section
Momentum Transport
\end_layout

\begin_layout Standard
Wasatch solves the variable density momentum equations
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\frac{\partial\rho\mathbf{u}}{\partial t}=-\nabla\cdot\rho\mathbf{u}\mathbf{u}-\nabla\cdot\boldsymbol{\tau}_{ij}-\nabla p+\rho\mathbf{g}
\end{equation}

\end_inset

in conjunction with the continuity equation
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\frac{\partial\rho}{\partial t}+\nabla\cdot\rho\mathbf{u}=0.
\end{equation}

\end_inset

Here, 
\begin_inset Formula $\rho$
\end_inset

 stands for the density, 
\begin_inset Formula $\mathbf{u}=(u,v,w)$
\end_inset

 is the velocity field, 
\begin_inset Formula $p$
\end_inset

 is the pressure, 
\begin_inset Formula $\mathbf{g}$
\end_inset

 is the gravity vector, and 
\begin_inset Formula $\boldsymbol{\tau}_{ij}$
\end_inset

 is the stress tensor given by
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\boldsymbol{\tau}_{ij}=-2\mu S_{ij};\quad S_{ij}\equiv\frac{1}{2}\left(\frac{\partial u_{i}}{\partial x_{j}}+\frac{\partial u_{j}}{\partial x_{i}}\right)-\frac{1}{3}\delta_{ij}\frac{\partial u_{k}}{\partial x_{k}}.
\end{equation}

\end_inset

The rate of strain tensor 
\begin_inset Formula $S_{ij}$
\end_inset

 is a fundamental quantity when using gradient diffusion turbulence models
 and will be used extensively in subsequent sections.
\end_layout

\begin_layout Standard
The code supports central, upwind, and over ten flux limiters for the discretiza
tion of the convective flux.
 The pressure is resolved by solving the pressure Poisson equation (PPE).
 This is constructed by first taking the divergence of the momentum equations.
 Then the continuity equation is used to substitute for the temporal term
 in the resulting equation.
 At the outset, one recovers a Poisson equation for the pressure
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\nabla^{2}p=\frac{\partial^{2}\rho}{\partial t^{2}}+\nabla\cdot\nabla\cdot\rho\mathbf{u}\mathbf{u}+\nabla\cdot\nabla\cdot\boldsymbol{\tau}_{ij}-\nabla\cdot\rho\mathbf{g}.\label{eq:wasatch-pressure-poisson-eq}
\end{equation}

\end_inset

The solution of 
\begin_inset CommandInset ref
LatexCommand formatted
reference "eq:wasatch-pressure-poisson-eq"

\end_inset

 requires the inversion of a linear system of equations.
 At the time of writing, Wasatch can solve the constant density momentum
 equations in three dimensions with periodic boundary conditions.
 The solution is based on the expressions graph showing that a basic CFD
 algorithm may be achieved using the graph based algorithm approach.
 A sample graph for a two dimensional fluid flow is shown in 
\begin_inset CommandInset ref
LatexCommand formatted
reference "fig:wasatch-navier-stokes-graph"

\end_inset

.
 
\end_layout

\begin_layout Standard
\begin_inset Float figure
placement !t
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename figures/pdf/wasatch_navier-stokes-graph.pdf
	lyxscale 50
	width 5in

\end_inset


\begin_inset Caption

\begin_layout Plain Layout
Expression graph for a two dimensional fluid flow problem using the Poisson
 equation for the pressure.
\begin_inset CommandInset label
LatexCommand label
name "fig:wasatch-navier-stokes-graph"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Paragraph
Pressure Projection
\end_layout

\begin_layout Standard
Wasatch uses the Pressure-Poisson-Equation (PPE) formulation to handle the
 pressure-velocity couple.
 The PPE formulation consists of first taking the divergence of the momentum
 equations and substituting the continuity equation to yield a Poisson equation
 for the pressure.
 This version of the pressure projection provides an elegant and straight-forwar
d equation for the pressure.
 Part of the difficulty of using the PPE formulation resides in the specificatio
n of appropriate boundary and initial conditions.
 While boundary conditions correspond to 
\begin_inset Quotes eld
\end_inset

natural
\begin_inset Quotes erd
\end_inset

 conditions imposed on physical quantities such as mass flowrate, pressure
 gradient, and velocity; specification of the initial conditions requires
 further attention on the Pressure poisson equation.
 
\end_layout

\begin_layout Subparagraph
Constant Density
\end_layout

\begin_layout Standard
For a constant density flow, the Pressure-Poisson-Equation 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:wasatch-pressure-poisson-eq"

\end_inset

 reduces to
\begin_inset Formula 
\begin{equation}
\nabla^{2}p=\nabla\cdot\nabla\cdot\rho\mathbf{u}\mathbf{u}+\nabla\cdot\nabla\cdot\boldsymbol{\tau}_{ij}-\nabla\cdot\rho\mathbf{g}.\label{eq:wasatch-pressure-poisson-eq-1}
\end{equation}

\end_inset


\end_layout

\begin_layout Subsection
LES Modeling
\end_layout

\begin_layout Standard
Wasatch uses Favre filtering as the basis for its LES approach.
 Favre filtering is defined as a density-weighted filtering operation to
 accomodate variable density.
 It is given by the following operation
\begin_inset Formula 
\begin{equation}
\overline{\rho\phi}=\overline{\rho}\,\widetilde{\phi},
\end{equation}

\end_inset

where the overbar denotes a traditional filtering operation.
 A traditional filtering operation consists of a convolution of a transported
 variable (i.e.
 a variable that one wishes to filter) with a filter.
 This is written as
\begin_inset Formula 
\begin{equation}
\overline{\phi}=\int_{\Omega}G(\mathbf{r})\phi(\mathbf{x}-\mathbf{r})\,\mathrm{d}\mathbf{r}.
\end{equation}

\end_inset


\end_layout

\begin_layout Paragraph
Filtered Momentum Equations
\end_layout

\begin_layout Standard
To make further headway, we apply the traditional filter to the governing
 fluid transport equations.
 Starting with continuity, we have
\begin_inset Formula 
\begin{equation}
\frac{\partial\overline{\rho}}{\partial t}+\nabla\cdot\overline{\rho\mathbf{u}}=0.
\end{equation}

\end_inset

Then, one makes use of the Favre filtering operation by setting 
\begin_inset Formula $\overline{\rho\mathbf{u}}=\overline{\rho}\,\widetilde{\mathbf{u}}$
\end_inset

.
 At the outset, the Favre-filtered continuity equation is given by
\begin_inset Formula 
\begin{equation}
\frac{\partial\overline{\rho}}{\partial t}+\nabla\cdot\overline{\rho}\,\widetilde{\mathbf{u}}=0.
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
Moving on to the momentum equation, the filtering operation yields
\begin_inset Formula 
\begin{equation}
\frac{\partial\overline{\rho\mathbf{u}}}{\partial t}=-\nabla\cdot\overline{\rho\mathbf{u}\mathbf{u}}-\nabla\cdot\overline{\boldsymbol{\tau}_{ij}}-\nabla\overline{p}+\overline{\rho\mathbf{g}}.
\end{equation}

\end_inset

It is best to transform to Favre-filtered terms one at a time.
 This leads to the following
\end_layout

\begin_layout Itemize

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
\begin_inset Formula $\frac{\partial\overline{\rho\mathbf{u}}}{\partial t}=\frac{\partial\overline{\rho}\,\widetilde{\mathbf{u}}}{\partial t}$
\end_inset


\end_layout

\begin_layout Itemize

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
\begin_inset Formula $\nabla\cdot\overline{\rho\mathbf{u}\mathbf{u}}=\nabla\cdot\overline{\rho}\,\widetilde{\mathbf{u}\mathbf{u}}=\nabla\cdot\overline{\rho}\,\widetilde{\mathbf{u}}\,\widetilde{\mathbf{u}}+\left(\nabla\cdot\overline{\rho}\,\widetilde{\mathbf{u}\mathbf{u}}-\nabla\cdot\overline{\rho}\,\widetilde{\mathbf{u}}\,\widetilde{\mathbf{u}}\right)\equiv\nabla\cdot\overline{\rho}\,\widetilde{\mathbf{u}}\,\widetilde{\mathbf{u}}+\nabla\cdot\boldsymbol{\tau}_{ij}^{R};\quad\boldsymbol{\tau}_{ij}^{R}\equiv\overline{\rho}\,\widetilde{\mathbf{u}\mathbf{u}}-\overline{\rho}\,\widetilde{\mathbf{u}}\,\widetilde{\mathbf{u}}$
\end_inset


\end_layout

\begin_layout Itemize

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
\begin_inset Formula $\nabla\cdot\overline{\boldsymbol{\tau}_{ij}}=\nabla\cdot\widetilde{\boldsymbol{\tau}_{ij}}+\left(\nabla\cdot\overline{\boldsymbol{\tau}_{ij}}-\nabla\cdot\widetilde{\boldsymbol{\tau}_{ij}}\right)\equiv\nabla\cdot\widetilde{\boldsymbol{\tau}_{ij}}+\nabla\cdot\boldsymbol{\tau}_{ij}^{L}$
\end_inset


\end_layout

\begin_layout Itemize
\begin_inset Formula $\overline{\rho\mathbf{g}}=\overline{\rho}\mathbf{g}$
\end_inset


\end_layout

\begin_layout Standard
where 
\begin_inset Formula $\boldsymbol{\tau}_{ij}^{R}$
\end_inset

 and 
\begin_inset Formula $\boldsymbol{\tau}_{ij}^{L}$
\end_inset

 are subgrid-scale stress tensors (SGS) that result from applying filtering
 to the convective and diffusive terms in the momentum equations, respectively.
 At the outset, the filtered momentum equations may be written as
\begin_inset Formula 
\begin{equation}
\frac{\partial\overline{\rho}\,\widetilde{\mathbf{u}}}{\partial t}=-\nabla\cdot\overline{\rho}\,\widetilde{\mathbf{u}}\,\widetilde{\mathbf{u}}-\nabla\cdot\widetilde{\boldsymbol{\tau}_{ij}}-\nabla\overline{p}-\nabla\cdot\boldsymbol{\tau}_{ij}^{R}-\nabla\cdot\underbrace{\boldsymbol{\tau}_{ij}^{L}}_{\text{neglect}}+\overline{\rho\mathbf{g}}.\label{eq:wasatch-filtered-momentum-eq}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
It is evident from 
\begin_inset CommandInset ref
LatexCommand formatted
reference "eq:wasatch-filtered-momentum-eq"

\end_inset

 that both subgrid tensors 
\begin_inset Formula $\boldsymbol{\tau}_{ij}^{R}$
\end_inset

 and 
\begin_inset Formula $\boldsymbol{\tau}_{ij}^{L}$
\end_inset

 require closure.
 However, it may be argued that the subgrid tensor 
\begin_inset Formula $\boldsymbol{\tau}_{ij}^{L}$
\end_inset

 resulting from the viscous terms is negligible compared to 
\begin_inset Formula $\boldsymbol{\tau}_{ij}^{R}$
\end_inset

 that results from filtering of the convective terms 
\begin_inset CommandInset citation
LatexCommand citep
key "geurts_les_1993,vreman_subgrid-modelling_1995"

\end_inset

.
 Hence, the resulting filtered momentum equations take the form
\begin_inset Formula 
\begin{equation}
\frac{\partial\overline{\rho}\,\widetilde{\mathbf{u}}}{\partial t}=-\nabla\cdot\overline{\rho}\,\widetilde{\mathbf{u}}\,\widetilde{\mathbf{u}}-\nabla\cdot\widetilde{\boldsymbol{\tau}_{ij}}-\nabla\overline{p}-\nabla\cdot\boldsymbol{\tau}_{ij}^{R}+\overline{\rho\mathbf{g}}.\label{eq:wasatch-filtered-momentum-eq-2}
\end{equation}

\end_inset

The subgrid stress tensor 
\begin_inset Formula $\tau_{ij}^{R}$
\end_inset

 requires closure as it introduces unknown quantities.
 The subject of closure is at the heart of the LES method and will be discussed
 in the next subsection.
\end_layout

\begin_layout Standard
\begin_inset Note Note
status collapsed

\begin_layout Plain Layout
OLD STUFF
\end_layout

\begin_layout Plain Layout
The filtered momentum equation is
\begin_inset Formula 
\begin{equation}
\frac{\partial\bar{\rho}\tilde{v}_{k}}{\partial t}+\frac{\partial}{\partial x_{l}}(\bar{\rho}\tilde{v}_{k}\tilde{v}_{l})=-\frac{\partial\bar{p}}{\partial x_{k}}+\frac{\partial}{\partial x_{l}}\tilde{\sigma}_{kl}-\frac{\partial}{\partial x_{l}}\tau_{kl}\label{eq:wasatch-filtered-mom-eq}
\end{equation}

\end_inset

where
\begin_inset Formula 
\begin{equation}
\sigma_{kl}=-\frac{2}{3}\mu\frac{\partial v_{j}}{\partial x_{j}}\delta_{kl}+\mu\left(\frac{\partial v_{k}}{\partial x_{l}}+\frac{\partial v_{l}}{\partial x_{k}}\right)
\end{equation}

\end_inset


\end_layout

\begin_layout Plain Layout
And ~ shows the Favre averaged variables.
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Note Note
status collapsed

\begin_layout Plain Layout
THIS SECTION DOESN'T BELONG HERE ANYMORE.
\end_layout

\begin_layout Subsubsection
Energy Equation:THIS SECTION REQUIRES REVISION
\end_layout

\begin_layout Plain Layout
The filtered energy equation is
\begin_inset Formula 
\begin{equation}
C_{v}\frac{\partial\bar{\rho}\tilde{T}}{\partial t}+C_{v}\frac{\partial}{\partial x_{k}}(\bar{\rho}\tilde{v}_{k}\tilde{T})=-\bar{p}\frac{\partial\tilde{v}_{k}}{\partial x_{k}}+\tilde{\sigma}_{ik}\frac{\partial\tilde{v}_{k}}{\partial x_{l}}+\frac{\partial}{\partial x_{k}}\left(\tilde{\kappa}\frac{\partial\tilde{T}}{\partial x_{l}}\right)-C_{v}\frac{\partial q_{k}}{\partial x_{k}}\label{eq:wasatch-filtered-energy-eq}
\end{equation}

\end_inset


\end_layout

\begin_layout Plain Layout
Similarly for the filtered energy equation, the diffusive term needs to
 be modeled somehow.
 Again, by considering eddy viscosity SGS model we can obtain
\begin_inset Formula 
\begin{equation}
q_{k}=-\frac{\bar{\rho}\nu_{T}}{Pr_{t}}\frac{\partial\tilde{T}}{\partial x_{k}}
\end{equation}

\end_inset

Where 
\begin_inset Formula $\nu_{T}=C\Delta^{2}|\tilde{S}|$
\end_inset

 and 
\begin_inset Formula $Pr$
\end_inset

 number is again parametrized using dynamic models to obtain
\begin_inset Formula 
\begin{equation}
Pr_{t}=C\left\langle \hat{\bar{\rho}}\hat{\Delta}^{2}|\hat{\tilde{S}}|\frac{\partial\hat{\tilde{T}}}{\partial x_{k}}\frac{\partial\tilde{T}}{\partial x_{k}}-\Delta^{2}\widehat{\bar{\rho}|\tilde{S}|\frac{\partial\tilde{T}}{\partial x_{k}}}\frac{\partial\tilde{T}}{\partial x_{k}}\right\rangle \times\left\langle \left(\frac{1}{\hat{\bar{\rho}}}\widehat{\bar{\rho}\tilde{v}_{k}}\widehat{\bar{\rho}\tilde{T}}-\widehat{\bar{\rho}\tilde{v}_{k}\tilde{T}}\right)\frac{\partial\tilde{T}}{\partial x_{k}}\right\rangle ^{-1}
\end{equation}

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Subsubsection
Subgrid Closure
\end_layout

\begin_layout Standard
The most common approach to modeling the subgrid-scale tensors is based
 on eddy-viscosity models.
 First propsed by 
\begin_inset CommandInset citation
LatexCommand citet
key "smagorinsky_general_1963"

\end_inset

, these have the general form
\begin_inset Formula 
\begin{equation}
\boldsymbol{\tau}_{ij}^{R}=\underbrace{\overbrace{\boldsymbol{\tau}_{ij}^{R}-\tfrac{1}{3}\delta_{ij}\boldsymbol{\tau}_{kk}^{R}}}_{\text{deviatoric}}^{\boldsymbol{\tau}_{ij}^{\mathrm{d}}}+\underbrace{\overbrace{\tfrac{1}{3}\delta_{ij}\boldsymbol{\tau}_{kk}^{R}}}_{\text{isotropic}}^{\boldsymbol{\tau}_{ij}^{\mathrm{s}}}.\label{eq:wasatch-sgs-tensor-decomposition}
\end{equation}

\end_inset

The deviatoric subgrid-stress tensor 
\begin_inset Formula $\boldsymbol{\tau}_{ij}^{\mathrm{d}}$
\end_inset

 is modeled as
\begin_inset Formula 
\begin{equation}
\boldsymbol{\tau}_{ij}^{\mathrm{d}}=-2\mu_{\mathrm{t}}\widetilde{S}_{ij},
\end{equation}

\end_inset

where 
\begin_inset Formula $\nu_{\text{t}}$
\end_inset

 is the eddy- or turbulent-viscosity and 
\begin_inset Formula $\widetilde{S}_{ij}$
\end_inset

 is the Favre-filtered rate of strain - a computable quantity.
 
\end_layout

\begin_layout Standard
The isotropic subgrid-stress tensor 
\begin_inset Formula $\boldsymbol{\tau}_{ij}^{\mathrm{s}}$
\end_inset

 may be absorbed into the filtered pressure or entirely neglected 
\begin_inset CommandInset citation
LatexCommand citep
key "erlebacher_toward_1992,garnier_les_compressible_2009"

\end_inset

.
 This is based on the observation that small scales are generally incompressible
 
\begin_inset CommandInset citation
LatexCommand citep
key "garnier_les_compressible_2009"

\end_inset

.
 In fact, 
\begin_inset Formula $\boldsymbol{\tau}_{kk}$
\end_inset

 may be written in terms of the subgrid Mach number as
\begin_inset Formula 
\begin{equation}
\boldsymbol{\tau}_{kk}=\gamma M_{\text{sgs}}^{2}\overline{p}.
\end{equation}

\end_inset

where 
\begin_inset Formula $\gamma$
\end_inset

 is the ratio of specific heats and 
\begin_inset Formula $M_{\text{sgs}}$
\end_inset

 is the subgrid Mach number whose values is expected to be small when the
 turbulent Mach number of the large scales is low.
\end_layout

\begin_layout Standard
Upon substitution of 
\begin_inset CommandInset ref
LatexCommand formatted
reference "eq:wasatch-sgs-tensor-decomposition"

\end_inset

 into 
\begin_inset CommandInset ref
LatexCommand formatted
reference "eq:wasatch-filtered-momentum-eq"

\end_inset

 one recovers
\begin_inset Formula 
\begin{equation}
\frac{\partial\overline{\rho}\,\widetilde{\mathbf{u}}}{\partial t}=-\nabla\cdot\overline{\rho}\,\widetilde{\mathbf{u}}\,\widetilde{\mathbf{u}}-\nabla\cdot\widetilde{\boldsymbol{\tau}}_{ij}-\nabla\overline{p}-\nabla\cdot\boldsymbol{\tau}_{ij}^{\mathrm{d}}+\overline{\rho}\mathbf{g}.\label{eq:wasatch-filtered-momentum-eq-1}
\end{equation}

\end_inset

Given that all quantities -- except 
\begin_inset Formula $\nu_{\text{t}}$
\end_inset

 -- are computable, the essence of all eddy-viscosity models is then to
 model the turbulent viscosity 
\begin_inset Formula $\nu_{\text{t}}$
\end_inset

.
\end_layout

\begin_layout Paragraph*
Constant Smagorinsky-Lilly Model
\end_layout

\begin_layout Standard
In the constant Smagorinsky-Lilly model, a simple algebraic relation is
 proposed for the eddy-viscosity 
\begin_inset CommandInset citation
LatexCommand citep
key "smagorinsky_general_1963"

\end_inset

.
 This form may be written as
\begin_inset Formula 
\begin{equation}
\mu_{\mathrm{t}}=\overline{\rho}\left(C_{\mathrm{s}}\Delta\right)^{2}\widetilde{\mathcal{S}}=\overline{\rho}L_{s}^{2}\widetilde{\mathcal{S}},\label{eq:wasatch-constant-smagorinsky-model}
\end{equation}

\end_inset

where 
\begin_inset Formula $C_{\mathrm{s}}$
\end_inset

 is a constant, 
\begin_inset Formula $\Delta$
\end_inset

 is an average measure of the cell size, usually taken as the average cell
 volume 
\begin_inset Formula $V^{1/3}$
\end_inset

, and 
\begin_inset Formula $\widetilde{\mathcal{S}}=\sqrt{2\widetilde{S}_{ij}\widetilde{S}_{ij}}$
\end_inset

.
 Also, 
\begin_inset Formula $L_{s}$
\end_inset

 is commonly referred to as the mixing length and is a measure of the characteri
stic mixing length of turbulent eddies.
\end_layout

\begin_layout Standard
\begin_inset Note Note
status collapsed

\begin_layout Plain Layout
In Wasatch, we implement a variant of Smagorinsky's classic model.
 To allow users to fine-tune the turbulent viscosity based on physical input,
 we introduce a lengthscale to the calculation of the smagorinsky mixing
 length.
 The desired features of our model are
\end_layout

\begin_layout Itemize
As the grid spacing 
\begin_inset Formula $\Delta$
\end_inset

 approaches the kolmogorov scale, the turbulent viscosity should approach
 zero since all scales are resolved.
\end_layout

\begin_layout Itemize
As the grid spacing drifts from the kolmogorov scale, the effect of mixing
 due to small scales becomes more pronounced and hence the turbulent viscosity
 increases.
\end_layout

\begin_layout Itemize
Ability to recover constant smagorinsky model when desirable.
\end_layout

\begin_layout Plain Layout
These features may be accomplished by setting
\begin_inset Formula 
\begin{equation}
L_{s}=C_{s}\Delta\left(1-\frac{\Delta}{\eta}\right).\label{eq:wasatch-modified-smagorinsky-model}
\end{equation}

\end_inset

Here, 
\begin_inset Formula $C_{s}$
\end_inset

 is a scaling constant that is 
\shape slanted
not
\shape default
 equal to the Smagorinsky constant and 
\begin_inset Formula $\eta$
\end_inset

 is a characteristic small scale of the problem.
 Typically, 
\begin_inset Formula $\eta$
\end_inset

 may be taken as the Kolmogorov scale.
 It may be evalulated from the following scaling law
\begin_inset Formula 
\begin{equation}
\frac{L}{\eta}\sim\text{Re}^{3/4},
\end{equation}

\end_inset

where 
\begin_inset Formula $L$
\end_inset

 is a characteristic length of the large scale eddies and Re is the Reynolds
 number of the flow.
 For example, for the flow in a pipe of diameter 
\begin_inset Formula $D$
\end_inset

, the characteristic length may be taken as 
\begin_inset Formula $L=D$
\end_inset

 while 
\begin_inset Formula $\text{Re}=\frac{\rho VD}{\mu}$
\end_inset

.
 The behavior of 
\begin_inset CommandInset ref
LatexCommand formatted
reference "eq:wasatch-modified-smagorinsky-model"

\end_inset

 is shown in 
\begin_inset CommandInset ref
LatexCommand formatted
reference "fig:wasatch-modified-smagorinsky-model"

\end_inset

.
 Two key regimes may be identified in this figure.
 The first lies at 
\begin_inset Formula $0<\eta<\Delta$
\end_inset

 (to the left of 
\begin_inset Formula $\eta=\Delta$
\end_inset

 mark) designates the region where the mesh spacing is larger than the small
 scales.
 Hence, as the mesh spacing becomes larger than the small scales (i.e.
 only very large scales are resolved), more dissipation must be added to
 mimic the dissipation caused by the small scales.
 The second regime lies in the region 
\begin_inset Formula $\Delta<\eta<\infty$
\end_inset

 and is only included for mathematical completion.
 This region indicates that the mesh size is smaller than the smallest scales
 and is not truly part of an LES model.
 Its inclusion, however, is necessary to recover the Smagorinsky classic
 model as 
\begin_inset Formula $\eta\to\infty$
\end_inset

.
\end_layout

\begin_layout Plain Layout
\begin_inset Float figure
placement !t
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename figures/pdf/wasatch-smagorinsky-model.pdf
	lyxscale 50

\end_inset


\begin_inset Caption

\begin_layout Plain Layout
Behavior of the mixing length in the modified Smagorinsky model used in
 Wasatch.
\begin_inset CommandInset label
LatexCommand label
name "fig:wasatch-modified-smagorinsky-model"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Paragraph
Dynamic Smagorinsky Model
\end_layout

\begin_layout Standard
While the constant Smagorinsky-Lilly model provides a well-rounded simple
 LES model, it fails to capture appropriate flow behaviour near walls or
 under low-Reynolds-number conditions where the model coefficient 
\begin_inset Formula $C_{\text{s}}$
\end_inset

 needs to be attenuated or set to zero.
 The dynamic Smagorinsky models provides a means to allow for saptio-temporal
 variation of 
\begin_inset Formula $C_{\text{s}}$
\end_inset

.
 The idea behind the dynamic model is simple: apply a test filter to the
 grid-filtered velocity field and then use the difference between the test-filte
red and grid-filtered stresses as a measure of how resolved the simulation
 is and calibrate the Smagorinsky model coefficient appropriately.
 In what follows, test-filtering is denoted by an over-hat 
\begin_inset Quotes eld
\end_inset


\begin_inset Formula $\widehat{}$
\end_inset


\begin_inset Quotes erd
\end_inset

 while grid filtered fields are denoted by an overbar.
 
\end_layout

\begin_layout Subparagraph*
Constant Density
\end_layout

\begin_layout Standard
For a constant density flow, the test-filtered momentum equations are
\begin_inset Formula 
\begin{equation}
\frac{\partial\widehat{\overline{\mathbf{u}}}}{\partial t}=-\nabla\cdot\widehat{\overline{\mathbf{u}\mathbf{u}}}-\nabla\cdot\widehat{\overline{\boldsymbol{\tau}}}_{ij}-\nabla\widehat{\overline{p}}.
\end{equation}

\end_inset

where the overbar denotes grid-filtered quantities.
 The test-filtered convective fluxes are unknown and require modeling.
 We follow standard expansion and set
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\nabla\cdot\widehat{\overline{\mathbf{u}\mathbf{u}}}=\nabla\cdot\widehat{\overline{\mathbf{u}}}\,\widehat{\overline{\mathbf{u}}}+\left(\nabla\cdot\widehat{\overline{\mathbf{u}\mathbf{u}}}-\nabla\cdot\widehat{\overline{\mathbf{u}}}\,\widehat{\overline{\mathbf{u}}}\right)\equiv\nabla\cdot\widehat{\overline{\mathbf{u}}}\,\widehat{\overline{\mathbf{u}}}+\nabla\cdot\mathbf{T}_{ij}^{\text{R}};\quad\mathbf{T}_{ij}^{\text{R}}\equiv\widehat{\overline{\mathbf{u}\mathbf{u}}}-\widehat{\overline{\mathbf{u}}}\,\widehat{\overline{\mathbf{u}}}
\end{equation}

\end_inset

where 
\begin_inset Formula $\mathbf{T}_{ij}^{\text{R}}$
\end_inset

 is the test-filtered subgrid-scale stress tensors that results from applying
 the test-filter to the grid-filtered convective terms.
 In a manner similar to the grid-filtered residual stresses, the deviatoric
 part of 
\begin_inset Formula $\mathbf{T}_{ij}^{\text{R}}$
\end_inset

 may be modeled using an eddy-viscosity model
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\mathbf{T}_{ij}^{\text{R}}=\underbrace{\overbrace{\mathbf{T}_{ij}^{\text{R}}-\tfrac{1}{3}\delta_{ij}\mathbf{T}_{ij}^{\text{R}}}}_{\text{deviatoric}}^{\mathbf{T}_{ij}^{\mathrm{d}}}+\underbrace{\overbrace{\tfrac{1}{3}\delta_{ij}\mathbf{T}_{ij}^{\text{R}}}}_{\text{isotropic}}^{\mathbf{T}_{ij}^{\mathrm{s}}}.\label{eq:wasatch-sgs-tensor-decomposition-1}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
Assuming that the test-filtered residual stresses have the same model coefficien
t as the grid-filtered streses, we set
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\mathbf{T}_{ij}^{\mathrm{d}}=-2\mu_{\mathrm{t}}\widehat{\overline{S}}_{ij};\quad\mu_{\text{t}}\equiv C_{\text{d}}\widehat{\overline{\Delta}}^{2}\widehat{\overline{\mathcal{S}}},\label{eq:wasatch-test-filtered-stress-tensor}
\end{equation}

\end_inset

where 
\begin_inset Formula $\widehat{\overline{S}}_{ij}\equiv\tfrac{1}{2}\left(\frac{\partial\widehat{\overline{u}}_{i}}{\partial x_{j}}+\frac{\partial\widehat{\overline{u}}_{j}}{\partial x_{i}}\right)$
\end_inset

, 
\begin_inset Formula $\widehat{\overline{\mathcal{S}}}=\sqrt{2\widehat{\overline{S}}_{ij}\widehat{\overline{S}}_{ij}}$
\end_inset

, and 
\begin_inset Formula $C_{\text{d}}$
\end_inset

 is the dynamic Smagorinsky coefficient, akin to the one shown in 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:wasatch-constant-smagorinsky-model"

\end_inset

.
 Recall that the grid-filtered deviatoric residual stress tensor is modeled
 as
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\boldsymbol{\tau}_{ij}^{\mathrm{d}}=-2\mu_{\mathrm{t}}\overline{S}_{ij};\quad\mu_{\text{t}}\equiv C_{\text{d}}\overline{\Delta}^{2}\overline{\mathcal{S}}.\label{eq:wasatch-grid-filtered-stress-tensor}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
The purpose of the dynamic procedure to determine 
\begin_inset Formula $C_{\text{d}}$
\end_inset

 based on local flow conditions.
 If one could relate 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:wasatch-test-filtered-stress-tensor"

\end_inset

 and 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:wasatch-grid-filtered-stress-tensor"

\end_inset

, then an equation for 
\begin_inset Formula $C_{\text{d}}$
\end_inset

 could be derived.
 Germano constructed an identity that does that.
 By taking the test-filter of 
\begin_inset Formula $\boldsymbol{\tau}_{ij}^{\text{R}}$
\end_inset

, and subtracting it from 
\begin_inset Formula $\mathbf{T}_{ij}^{\text{R}}$
\end_inset

, one recovers
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\mathcal{L}_{ij}\equiv\mathbf{T}_{ij}^{\text{R}}-\widehat{\boldsymbol{\tau}_{ij}^{\mathrm{R}}}=\left(\widehat{\overline{\mathbf{u}\mathbf{u}}}-\widehat{\overline{\mathbf{u}}}\,\widehat{\overline{\mathbf{u}}}\right)-\left(\widehat{\overline{\mathbf{u}\mathbf{u}}}-\widehat{\overline{\mathbf{u}}\,\overline{\mathbf{u}}}\right)=\widehat{\overline{\mathbf{u}}\,\overline{\mathbf{u}}}-\widehat{\overline{\mathbf{u}}}\,\widehat{\overline{\mathbf{u}}}=\widehat{\overline{u}_{i}\,\overline{u}_{j}}-\widehat{\overline{u}}_{i}\,\widehat{\overline{u}}_{j}
\end{equation}

\end_inset


\begin_inset Formula $\mathcal{L}_{ij}$
\end_inset

 is a known quantity and will be used to calibrate the model's coefficient.
 A model for 
\begin_inset Formula $\mathcal{L}_{ij}$
\end_inset

 is
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\mathcal{L}_{ij}^{\text{d}}\equiv\mathbf{T}_{ij}^{\text{d}}-\widehat{\boldsymbol{\tau}_{ij}^{\mathrm{d}}}
\end{equation}

\end_inset

or
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\mathcal{L}_{ij}^{\text{d}}=-2C_{\text{d}}\widehat{\overline{\Delta}}^{2}\widehat{\overline{\mathcal{S}}}\,\widehat{\overline{S}}_{ij}+2C_{\text{d}}\overline{\Delta}^{2}\widehat{\overline{\mathcal{S}}\,\overline{S}_{ij}}\equiv2C_{\text{d}}\mathbf{M}_{ij};\quad\mathbf{M}_{ij}\equiv\overline{\Delta}^{2}\widehat{\overline{\mathcal{S}}\,\overline{S}_{ij}}-\widehat{\overline{\Delta}}^{2}\widehat{\overline{\mathcal{S}}}\,\widehat{\overline{S}}_{ij}
\end{equation}

\end_inset

Given that 
\begin_inset Formula $\mathcal{L}_{ij}\approx\mathcal{L}_{ij}^{\text{d}}$
\end_inset

, then one can write (remember that 
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none

\begin_inset Formula $\mathcal{L}_{ij}$
\end_inset

 is a known quantity)
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
2C_{\text{d}}\mathbf{M}_{ij}\approx\mathcal{L}_{ij}
\end{equation}

\end_inset

Of course this is an overdetermined system of equations and 
\begin_inset Formula $C_{\text{d}}$
\end_inset

 cannot be calculated from the above equation.
 Instead, Germano suggested contracting the above equation with 
\begin_inset Formula $\mathbf{M}_{ij}$
\end_inset

 to recover
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
C_{\text{d}}=\frac{1}{2}\frac{\mathcal{L}_{ij}\mathbf{M}_{ij}}{\mathbf{M}_{ij}\mathbf{M}_{ij}}
\end{equation}

\end_inset

In fact, this apparently arbitrary contraction may be rigorously derived
 by minimizing the mean-square error.
 The error is defined as the difference between the subtest stress 
\begin_inset Formula $\mathcal{L}_{ij}$
\end_inset

 and its model 
\begin_inset Formula $\mathcal{L}_{ij}^{\text{d}}$
\end_inset

 as
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\varepsilon_{ij}=\mathcal{L}_{ij}^{\text{d}}-\mathcal{L}_{ij}
\end{equation}

\end_inset

The mean-square error is
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
E\equiv\varepsilon_{ij}\varepsilon_{ij}=\left(\mathcal{L}_{ij}^{\text{d}}-\mathcal{L}_{ij}\right)\left(\mathcal{L}_{ij}^{\text{d}}-\mathcal{L}_{ij}\right)
\end{equation}

\end_inset

upon expansion, this leads to
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
E\equiv\left(2C_{\text{d}}\mathbf{M}_{ij}-\mathcal{L}_{ij}\right)^{2}
\end{equation}

\end_inset

To find the extremum of the error with respect to 
\begin_inset Formula $C_{\text{d}}$
\end_inset

, we take its derivative and set it to zero.
 This returns
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\frac{\partial E}{\partial C_{\text{d}}}=2\times2\mathbf{M}_{ij}\times\left(2C_{\text{d}}\mathbf{M}_{ij}-\mathcal{L}_{ij}\right)=8C_{\text{d}}\mathbf{M}_{ij}\mathbf{M}_{ij}-4\mathcal{L}_{ij}\mathbf{M}_{ij}=0
\end{equation}

\end_inset

or
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
C_{\text{d}}=\frac{1}{2}\frac{\mathcal{L}_{ij}\mathbf{M}_{ij}}{\mathbf{M}_{ij}\mathbf{M}_{ij}}\propto\frac{\mathcal{L}_{ij}\mathbf{M}_{ij}}{\mathbf{M}_{ij}\mathbf{M}_{ij}}\label{eq:wasatch-dynamic-coef-square-error-extremum}
\end{equation}

\end_inset

This tells us that, when 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:wasatch-dynamic-coef-square-error-extremum"

\end_inset

 is true, then the mean-square error is at an extremum.
 To identify the type of extremum, we look at the second derivative of 
\begin_inset Formula $E$
\end_inset

, namely
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\frac{\partial^{2}E}{\partial C_{\text{d}}^{2}}=8\mathbf{M}_{ij}\mathbf{M}_{ij}\geq0
\end{equation}

\end_inset

This result indicates that the curvature of 
\begin_inset Formula $E$
\end_inset

 is concave up and that the extremum is a minimum.
\end_layout

\begin_layout Standard
In practice, one calculates the product 
\begin_inset Formula $C_{\text{d}}\overline{\Delta}^{2}$
\end_inset

 so that
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
C_{\text{d}}\overline{\Delta}^{2}=\frac{1}{2}\frac{\mathcal{L}_{ij}\mathbf{M}_{ij}}{\mathbf{M}_{ij}\mathbf{M}_{ij}};\quad\mathbf{M}_{ij}\equiv\widehat{\overline{\mathcal{S}}\,\overline{S}_{ij}}-\delta^{2}\widehat{\overline{\mathcal{S}}}\,\widehat{\overline{S}}_{ij},\quad\delta\equiv\frac{\widehat{\overline{\Delta}}}{\overline{\Delta}}
\end{equation}

\end_inset

where 
\begin_inset Formula $\delta$
\end_inset

 is the ratio of filter widths.
 In Wasatch, we use an isotropic box filter with a width 
\begin_inset Formula $\widehat{\overline{\Delta}}=3\overline{\Delta}$
\end_inset

 (i.e.
 
\begin_inset Formula $\delta=3$
\end_inset

).
\end_layout

\begin_layout Subparagraph*
Variable Density
\end_layout

\begin_layout Standard
For a variable density flow, things are slightly more complicated due to
 Favre filtering.
 Recall that Favre filtering is defined as 
\begin_inset Formula $\overline{\rho\phi}\equiv\overline{\rho}\,\widetilde{\phi}$
\end_inset

.
 When test filtered, we make the following modification
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\widehat{\overline{\rho\phi}}=\widehat{\overline{\rho}\,\widetilde{\phi}}=\widehat{\overline{\rho}}\,\check{\widetilde{\phi}}\label{eq:wasatch-favre-test-filtering}
\end{equation}

\end_inset

where the over-check, 
\begin_inset Quotes eld
\end_inset


\begin_inset Formula $\check{}$
\end_inset


\begin_inset Quotes eld
\end_inset

, operation denotes a test-filtered quantity in the Favre sense.
 We will show below that there is no need to define the over-check filtering
 and thus view it as a mere mathematical device that allows us to arrive
 at the final dynamic formulation.
\end_layout

\begin_layout Standard
We start with the test-filtered variable density equations, given by
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\frac{\partial\widehat{\overline{\rho\mathbf{u}}}}{\partial t}=-\nabla\cdot\widehat{\overline{\mathbf{\rho u}\mathbf{u}}}-\nabla\cdot\widehat{\overline{\boldsymbol{\tau}}}_{ij}-\nabla\widehat{\overline{p}}.
\end{equation}

\end_inset

Because we are only interested in the residual stresses arising from test-filter
ing, we only need to focus on the convective fluxes, which are responsible
 for generating the residual dissipation.
 We therefore set
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\nabla\cdot\widehat{\overline{\rho\mathbf{u}\mathbf{u}}}=\nabla\cdot\widehat{\overline{\rho}}\,\check{\widetilde{\mathbf{u}\mathbf{u}}}=\nabla\cdot\widehat{\overline{\rho}}\,\check{\widetilde{\mathbf{u}}}\,\check{\widetilde{\mathbf{u}}}+\left(\nabla\cdot\widehat{\overline{\rho}}\,\check{\widetilde{\mathbf{u}\mathbf{u}}}-\nabla\cdot\widehat{\overline{\rho}}\,\check{\widetilde{\mathbf{u}}}\,\check{\widetilde{\mathbf{u}}}\right)\equiv\nabla\cdot\widehat{\overline{\rho}}\,\check{\widetilde{\mathbf{u}}}\,\check{\widetilde{\mathbf{u}}}+\nabla\cdot\mathbf{T}_{ij}^{\text{R}};\quad\mathbf{T}_{ij}^{\text{R}}\equiv\widehat{\overline{\rho}}\,\check{\widetilde{\mathbf{u}\mathbf{u}}}-\widehat{\overline{\rho}}\,\check{\widetilde{\mathbf{u}}}\,\check{\widetilde{\mathbf{u}}}
\end{equation}

\end_inset

As usual, 
\begin_inset Formula $\mathbf{T}_{ij}^{\text{R}}$
\end_inset

 is decomposed into a deviatoric and isotropic components as shown in 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:wasatch-sgs-tensor-decomposition-1"

\end_inset

.
 We neglect the isotropic part and model the deviatoric stress using the
 standard Smagorinsky model as
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\mathbf{T}_{ij}^{\mathrm{d}}=-2C_{\text{d}}\widehat{\overline{\rho}}\,\widehat{\Delta}^{2}\,\widehat{\widetilde{\mathcal{S}}}\,\widehat{\widetilde{S}}_{ij},\label{eq:wasatch-test-filtered-stress-tensor-1}
\end{equation}

\end_inset

To make further headway, we now take the difference between the grid-filtered
 and test-filtered residual stresses 
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\mathcal{L}_{ij}\equiv\mathbf{T}_{ij}^{\text{R}}-\widehat{\boldsymbol{\tau}_{ij}^{\mathrm{R}}}=\widehat{\overline{\rho}\,\widetilde{u}_{i}\,\widetilde{u}_{j}}-\widehat{\overline{\rho}}\,\check{\widetilde{u}}_{i}\,\check{\widetilde{u}}_{j}.
\end{equation}

\end_inset

At this point, the over-parenthese operation is still undefined which makes
 
\begin_inset Formula $\mathcal{L}_{ij}$
\end_inset

 useless unless we can rewrite the undefined quantities in terms of known
 ones.
 This is easily accomplished by using 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:wasatch-favre-test-filtering"

\end_inset

.
 This allows us to write
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\widehat{\overline{\rho}}\,\check{\widetilde{u}}_{i}\,\check{\widetilde{u}}_{j}=\frac{1}{\widehat{\overline{\rho}}}\,\widehat{\overline{\rho}}\,\check{\widetilde{u}}_{i}\,\widehat{\overline{\rho}}\,\check{\widetilde{u}}_{j}=\frac{1}{\widehat{\overline{\rho}}}\,\widehat{\overline{\rho}\,\widetilde{u}_{i}}\,\widehat{\overline{\rho}\,\widetilde{u}_{j}}
\end{equation}

\end_inset

which is an easily calculated quantity.
 Then
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\mathcal{L}_{ij}=\widehat{\overline{\rho}\,\widetilde{u}_{i}\,\widetilde{u}_{j}}-\frac{1}{\widehat{\overline{\rho}}}\,\widehat{\overline{\rho}\,\widetilde{u}_{i}}\,\widehat{\overline{\rho}\,\widetilde{u}_{j}}
\end{equation}

\end_inset

making 
\begin_inset Formula $\mathcal{L}_{ij}$
\end_inset

 a computable tensor.
 The final step in the dynamic model is to select a model for 
\begin_inset Formula $\mathcal{L}_{ij}$
\end_inset

, more specifically, for its deviatoric part.
 For this we use 
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\mathcal{L}_{ij}^{\text{d}}=\mathbf{T}_{ij}^{\text{d}}-\widehat{\boldsymbol{\tau}_{ij}^{\mathrm{d}}}=2C_{\text{d}}\underbrace{\left(\overline{\Delta}^{2}\widehat{\overline{\rho}\,\widetilde{\mathcal{S}}\,\widetilde{S}_{ij}}-\widehat{\Delta}^{2}\widehat{\overline{\rho}}\,\widehat{\widetilde{\mathcal{S}}}\,\widehat{\widetilde{S}}_{ij}\right)}_{\mathbf{M}_{ij}}\equiv2C_{\text{d}}\mathbf{M}_{ij}
\end{equation}

\end_inset

finally, we set 
\begin_inset Formula $\mathcal{L}_{ij}=\mathcal{L}_{ij}^{\text{d}}$
\end_inset

 and contract with 
\begin_inset Formula $\mathbf{M}_{ij}$
\end_inset

 to recover
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
C_{\text{d}}=\frac{1}{2}\frac{\mathcal{L}_{ij}\mathbf{M}_{ij}}{\mathbf{M}_{ij}\mathbf{M}_{ij}}
\end{equation}

\end_inset

Again, it is more customary to calculate the product 
\begin_inset Formula $C_{\text{d}}\overline{\Delta}^{2}$
\end_inset

 so that
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
C_{\text{d}}\overline{\Delta}^{2}=\frac{1}{2}\frac{\mathcal{L}_{ij}\mathbf{M}_{ij}}{\mathbf{M}_{ij}\mathbf{M}_{ij}};\quad\mathbf{M}_{ij}\equiv\widehat{\overline{\rho}\,\widetilde{\mathcal{S}}\,\widetilde{S}_{ij}}-\delta^{2}\widehat{\overline{\rho}}\,\widehat{\overline{\mathcal{S}}}\,\widehat{\overline{S}}_{ij},\quad\delta\equiv\frac{\widehat{\Delta}}{\overline{\Delta}}
\end{equation}

\end_inset

An important feature of our formulation is that one recovers the constant
 density version of the dynaimc model, a desirable feature in our code to
 avoid unecessary branch and promote polymorphism.
\end_layout

\begin_layout Standard
\begin_inset Note Note
status collapsed

\begin_layout Plain Layout
Here, we assumed that 
\begin_inset Formula $C_{\text{s}}$
\end_inset

 is 
\begin_inset Quotes eld
\end_inset

constant
\begin_inset Quotes erd
\end_inset

.
 This is certainly a workaround to get something out of the model, but it
 appears to work reasonably well for a wide range of flowfields.
 To make further headway, we write
\end_layout

\begin_layout Plain Layout
he filtered momentum equations may be written as
\begin_inset Formula 
\begin{equation}
\frac{\partial\overline{\rho}\widetilde{\mathbf{u}}}{\partial t}=-\nabla\cdot\overline{\rho}\widetilde{\mathbf{u}}\widetilde{\mathbf{u}}-\nabla\cdot\widetilde{\boldsymbol{\tau}_{ij}}-\nabla\overline{p}-\nabla\cdot\boldsymbol{\tau}_{ij}^{R}-\nabla\cdot\underbrace{\boldsymbol{\tau}_{ij}^{L}}_{\text{neglect}}+\overline{\rho\mathbf{g}}.\label{eq:wasatch-filtered-momentum-eq-3}
\end{equation}

\end_inset


\end_layout

\begin_layout Plain Layout
It is evident from 
\begin_inset CommandInset ref
LatexCommand formatted
reference "eq:wasatch-filtered-momentum-eq-3"

\end_inset

 that both subgrid tensors 
\begin_inset Formula $\boldsymbol{\tau}_{ij}^{R}$
\end_inset

 and 
\begin_inset Formula $\boldsymbol{\tau}_{ij}^{L}$
\end_inset

 require closure.
 However, it may be argued that the subgrid tensor 
\begin_inset Formula $\boldsymbol{\tau}_{ij}^{L}$
\end_inset

 resulting from the viscous terms is negligible compared to 
\begin_inset Formula $\boldsymbol{\tau}_{ij}^{R}$
\end_inset

 that results from filtering of the convective terms 
\begin_inset CommandInset citation
LatexCommand citep
key "geurts_les_1993,vreman_subgrid-modelling_1995"

\end_inset

.
 Hence, the resulting filtered momentum equations take the form
\begin_inset Formula 
\begin{equation}
\frac{\partial\overline{\rho}\widetilde{\mathbf{u}}}{\partial t}=-\nabla\cdot\overline{\rho}\widetilde{\mathbf{u}}\widetilde{\mathbf{u}}-\nabla\cdot\widetilde{\boldsymbol{\tau}_{ij}}-\nabla\overline{p}-\nabla\cdot\boldsymbol{\tau}_{ij}^{R}+\overline{\rho\mathbf{g}}.\label{eq:wasatch-filtered-momentum-eq-2-1}
\end{equation}

\end_inset

The subgrid stress tensor 
\begin_inset Formula $\tau_{ij}^{R}$
\end_inset

 requires closure as it introduces unknown quantities.
 The subject of closure is at the heart of the LES method and will be discussed
 in the next subsection.
\end_layout

\begin_layout Plain Layout
The most important difference between filtered and non-filtered momentum
 equation is in the diffusive term, 
\begin_inset Formula $\tau_{kl}$
\end_inset

.
 According to the Smagorinsky eddy viscosity model it can be modeled as
\begin_inset Formula 
\begin{equation}
\tau_{kl}-\frac{1}{3}q^{2}\delta_{kl}=-2C\bar{\rho}\Delta^{2}|\tilde{S}|(\tilde{S}_{kl}-\frac{1}{3}\tilde{S}_{mm}\delta_{kl}),\label{eq:wasatch-smagorinsky}
\end{equation}

\end_inset

where 
\begin_inset Formula $\tilde{S}_{kl}=\frac{1}{2}(\partial\tilde{u}_{k}/\partial x_{l}+\partial\tilde{u}_{l}/\partial x_{k})$
\end_inset

, 
\begin_inset Formula $|\tilde{S}|=(2\tilde{S}_{kl}\tilde{S}_{kl})^{1/2}$
\end_inset

 and 
\begin_inset Formula $q^{2}=\tau_{ii}$
\end_inset

.
 
\begin_inset Formula $q^{2}$
\end_inset

 is also parameterized using Yoshizawa's model to obtain
\begin_inset Formula 
\begin{equation}
q^{2}=2C_{I}\bar{\rho}\Delta^{2}|\tilde{S}|^{2},
\end{equation}

\end_inset

where 
\begin_inset Formula $\Delta$
\end_inset

 is the grid size.
\end_layout

\begin_layout Plain Layout
\begin_inset Formula $C$
\end_inset

 and 
\begin_inset Formula $C_{I}$
\end_inset

 are Smagorinsky constants which can be assumed to be a fixed number and
 also can be calculated using dynamic models.
 By using dynamic models and applying test-filters these constants are parameter
ized as
\begin_inset Formula 
\begin{eqnarray}
C_{I} & = & \frac{<\widehat{\bar{\rho}\tilde{v}_{k}\tilde{v}_{k}}-(1/\hat{\bar{\rho}})(\widehat{\bar{\rho}\tilde{v}_{k})}(\widehat{\bar{\rho}\tilde{v}_{k}})>}{<2\hat{\bar{\rho}}\hat{\Delta}^{2}|\hat{\tilde{S}}|^{2}-2\Delta^{2}\widehat{\bar{\rho}|\tilde{S}|^{2}}>},\\
C & = & \frac{\left\langle [\widehat{\bar{\rho}\tilde{v}_{k}\tilde{v}_{l}}-(1/\hat{\bar{\rho}})(\widehat{\bar{\rho}\tilde{v}_{k}}\widehat{\bar{\rho}\tilde{v}_{l}})]\tilde{S}_{kl}-\frac{1}{3}\tilde{S}_{mm}({\cal T}_{jj}-\hat{\tau}_{jj})\right\rangle }{\left\langle -2\hat{\bar{\rho}}\hat{\Delta}^{2}|\hat{\tilde{S}}|(\hat{\tilde{S}}_{kl}\tilde{S}_{kl}-\frac{1}{3}\hat{\tilde{S}}_{mm}\tilde{S}_{jj})+2\Delta^{2}(\widehat{\bar{\rho}|\tilde{S}|\tilde{S}_{kl}}\tilde{S}_{kl}-\frac{1}{3}\widehat{\bar{\rho}|\tilde{S}|\tilde{S}_{mm}}\tilde{S}_{jj})\right\rangle },
\end{eqnarray}

\end_inset


\begin_inset Formula 
\begin{equation}
\end{equation}

\end_inset

 where 
\begin_inset Formula $<>$
\end_inset

 indicates volume averaging and 
\begin_inset Formula ${\cal T}_{jj}-\hat{\tau}_{jj}={\cal L}_{jj}=\widehat{\bar{\rho}\tilde{v}_{j}\tilde{v}_{j}}-(1/\hat{\bar{\rho}})(\widehat{\bar{\rho}\tilde{v}_{j}})(\widehat{\bar{\rho}\tilde{v}_{j}})$
\end_inset

 and over hat means the test filter is applied.
\end_layout

\end_inset


\end_layout

\begin_layout Paragraph
Wall-Adapting Local Eddy-Viscosity (WALE)
\end_layout

\begin_layout Standard
In the WALE model 
\begin_inset CommandInset citation
LatexCommand citep
key "geurts_les_1993"

\end_inset

, the eddy-viscosity is modeled as
\begin_inset Formula 
\begin{equation}
\mu_{t}=\rho\left(C_{\mathrm{w}}\Delta\right)^{2}\frac{(S_{ij}^{d}S_{ij}^{d})^{3/2}}{(\widetilde{S}_{ij}\widetilde{S}_{ij})^{5/2}+(S_{ij}^{d}S_{ij}^{d})^{5/4}}.
\end{equation}

\end_inset

Here, 
\begin_inset Formula $C_{\mathrm{w}}$
\end_inset

 is the WALE model constant, 
\begin_inset Formula $\Delta$
\end_inset

 is the average cell size, and 
\begin_inset Formula $S_{ij}^{d}$
\end_inset

 is the traceless symmetric part f the square of the velocity gradient tensor,
 given by 
\begin_inset CommandInset citation
LatexCommand citep
key "nicoud_subgrid-scale_1999"

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
S_{ij}^{d}=\tfrac{1}{2}\left(g_{ij}^{2}+g_{ji}^{2}\right)-\tfrac{1}{3}\delta_{ij}g_{kk}^{2};\quad g_{ij}^{2}=g_{ik}g_{kj};\quad g_{ij}=\frac{\partial u_{i}}{\partial x_{j}}.
\end{equation}

\end_inset

Care must be taken in evaluating the components of 
\begin_inset Formula $S_{ij}^{d}$
\end_inset

.
\end_layout

\begin_layout Paragraph
Vreman Model
\end_layout

\begin_layout Standard
The Vreman model 
\begin_inset CommandInset citation
LatexCommand citet
key "vreman2004eddy"

\end_inset

 is supposed to compete with the dynamic model by performing analytical
 filtering thus avoiding the computationally-intensive dynamic filtering
 of the dynamic model.
 The model is relatively simple to implement and is given by
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\mu_{t}=\rho C_{\mathrm{v}}\Delta^{2}\sqrt{\frac{B_{\beta}}{\alpha_{ij}\alpha_{ij}}},
\end{equation}

\end_inset

where
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
C_{\mathrm{v}}\approx2.5C_{\mathrm{s}}^{2},
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\alpha_{ij}=\frac{\partial\widetilde{u_{j}}}{\partial x_{i}},
\end{equation}

\end_inset

and
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
B_{\beta}=\beta_{11}\beta_{22}\text{−}\beta_{12}^{2}+\beta_{11}\beta_{33}\text{−}\beta_{13}^{2}+\beta_{22}\beta_{33}\text{−}\beta_{23}^{2};\quad\beta_{ij}=\alpha_{mi}\alpha_{mj}.
\end{equation}

\end_inset


\end_layout

\begin_layout Section
Generic Scalar Transport 
\begin_inset Note Note
status open

\begin_layout Plain Layout
POORLY WRITTEN.
 REQUIRES CLEANUP.
\end_layout

\end_inset


\end_layout

\begin_layout Standard
Wasatch can solve any scalar transport equation of the general form
\begin_inset Formula 
\begin{equation}
\frac{\partial\rho\phi}{\partial t}=-\nabla\cdot\rho\phi\mathbf{u}+\nabla\cdot\rho\Gamma_{\phi}\nabla\phi+S_{\phi}.\label{eq:wasatch-transport-eq-strong-var-dens}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
This general form is basically the strong form of the scalar transport equation
 when density is variable.
 Wasatch has the capability of choosing between the strong form or the weak
 form of this transport equation.
 Density type can also be specified in the input files of wasatch to determine
 if it is constant or variable.
 Regarding these capabilities we can have three more possible forms of transport
 equations rather than 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:wasatch-transport-eq-strong-var-dens"

\end_inset

.
 Those forms are:
\end_layout

\begin_layout Itemize
Strong form with constant density,
\begin_inset Formula 
\begin{equation}
\frac{\partial\phi}{\partial t}=-\nabla\cdot\phi\mathbf{u}+\nabla\cdot\Gamma_{\phi}\nabla\phi+\frac{S_{\phi}}{\rho}.\label{eq:wasatch-transport-eq-strong-const-dens}
\end{equation}

\end_inset


\end_layout

\begin_layout Itemize
Weak form with variable density,
\begin_inset Formula 
\begin{equation}
\frac{\partial\phi}{\partial t}=-\mathbf{u}\cdot\nabla\phi+\frac{1}{\rho}\nabla\cdot\rho\Gamma_{\phi}\nabla\phi+\frac{S_{\phi}}{\rho}.\label{eq:wasatch-transport-eq-weak-var-dens}
\end{equation}

\end_inset


\end_layout

\begin_layout Itemize
Weak from with constant density
\begin_inset Formula 
\begin{equation}
\frac{\partial\phi}{\partial t}=-\mathbf{u}\cdot\nabla\phi+\nabla\cdot\Gamma_{\phi}\nabla\phi+\frac{S_{\phi}}{\rho}.\label{eq:wasatch-transport-eq-weak-const-dens}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
Wasatch can now solve transport equations in strong form with either constant
 or variable density.
 Solving the weak form of the equation has not been implemented yet and
 is in progress.
 
\end_layout

\begin_layout Standard
The main reason that wasatch keeps both strong and weak form is to compare
 their result in future to see which one is more beneficial.
 In strong form with variable density wasatch solves for, 
\begin_inset Formula $\rho\phi$
\end_inset

, and in order to update the for scalar variable we need to solve a nonlinear
 equation where, 
\begin_inset Formula $\rho\phi$
\end_inset

 and 
\begin_inset Formula $\rho=F(\phi)$
\end_inset

 are given, in order to find the scalar variable in the current time step.
 On the other hand, weak form has its own problems.
 For example to solve weak form equations' convective terms in order to
 apply limiters on this term this equation is used
\begin_inset Formula 
\begin{equation}
\mathbf{u}\cdot\nabla\phi=\nabla\cdot\phi\mathbf{u}-\phi\nabla\cdot\mathbf{u}.
\end{equation}

\end_inset

And limiters can be used on the terms on the RHS easily.
 The scalar variable in this case should be assumed to be approximately
 constant in each cell on the grid.
\end_layout

\begin_layout Subsection
LES Modeling
\end_layout

\begin_layout Standard
The process of filtering the generic scalar transport equation follows from
 that used for the momentum equations.
\end_layout

\begin_layout Paragraph
Filtered Scalar Transport Equation
\end_layout

\begin_layout Standard
By applying the traditional filter on the strong form of the scalar transport
 equation with variable density for capturing the most general form of the
 equation, the filtered scalar equation will be:
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\frac{\partial\overline{\rho\phi}}{\partial t}=-\nabla\cdot\overline{\rho\phi\mathbf{u}}+\nabla\cdot\overline{\rho\Gamma_{\phi}\nabla\phi}+\overline{S_{\phi}}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
Application of the Favre filtering to the scalar transport equation term-by-term
 yields:
\end_layout

\begin_layout Itemize

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
\begin_inset Formula $\frac{\partial\overline{\rho\phi}}{\partial t}=\frac{\partial\overline{\rho}\widetilde{\phi}}{\partial t}$
\end_inset


\end_layout

\begin_layout Itemize

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
\begin_inset Formula $\nabla\cdot\overline{\rho\phi\mathbf{u}}=\nabla\cdot\overline{\rho}\widetilde{\phi\mathbf{u}}=\nabla\cdot\overline{\rho}\widetilde{\phi}\widetilde{\mathbf{u}}+\left(\nabla\cdot\overline{\rho}\widetilde{\phi\mathbf{u}}-\nabla\cdot\overline{\rho}\widetilde{\phi}\widetilde{\mathbf{u}}\right)\equiv\nabla\cdot\overline{\rho}\widetilde{\phi}\widetilde{\mathbf{u}}+\nabla\cdot J_{t}^{R};\quad J_{t}^{R}\equiv\overline{\rho}\widetilde{\phi\mathbf{u}}-\overline{\rho}\widetilde{\phi}\widetilde{\mathbf{u}}$
\end_inset


\end_layout

\begin_layout Itemize

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
\begin_inset Formula $\nabla\cdot\overline{\rho\Gamma_{\phi}\nabla\phi}=\nabla.(\overline{\rho}\widetilde{\Gamma_{\phi}\nabla\phi})=\nabla.(\overline{\rho}\overline{\Gamma_{\phi}}\nabla\widetilde{\phi})+\left(\nabla.(\overline{\rho}\widetilde{\Gamma_{\phi}\nabla\phi})-\nabla.(\overline{\rho}\overline{\Gamma_{\phi}}\nabla\widetilde{\phi})\right)=\nabla.(\overline{\rho}\overline{\Gamma_{\phi}}\nabla\widetilde{\phi})+\nabla.J_{t}^{L};\quad J_{t}^{L}=\nabla.(\overline{\rho}\widetilde{\Gamma_{\phi}\nabla\phi})-\nabla.(\overline{\rho}\overline{\Gamma_{\phi}}\nabla\widetilde{\phi})$
\end_inset


\end_layout

\begin_layout Itemize
\begin_inset Formula $\overline{S_{\phi}}=\overline{S_{\phi}}$
\end_inset


\end_layout

\begin_layout Standard
where 
\begin_inset Formula $J_{t}^{R}$
\end_inset

 and 
\begin_inset Formula $J_{t}^{L}$
\end_inset

 are subgrid-scale diffusive fluxes, which are part of the filtered convective
 and diffusive terms in the scalar transport equations after applying Favre
 averaging, respectively.
 After substituting all of these terms back into the filtered scalar equation,
 the following equation will be obtained:
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\frac{\partial\overline{\rho}\widetilde{\phi}}{\partial t}=\nabla\cdot\overline{\rho}\widetilde{\phi}\widetilde{\mathbf{u}}+\nabla.(\overline{\rho}\overline{\Gamma_{\phi}}\nabla\widetilde{\phi})+\nabla\cdot J_{t}^{R}+\nabla.J_{t}^{L}+\overline{S_{\phi}}\label{eq:wasatch-filtered-scalar-eq}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
Now, 
\begin_inset Formula $J_{t}^{R}$
\end_inset

 and 
\begin_inset Formula $J_{t}^{L}$
\end_inset

 that require closure models, can be merged into one single subgrid-scale
 diffusive flux, 
\begin_inset Formula $J_{t}=J_{t}^{L}+J_{t}^{R}$
\end_inset

.
 Then the filtered scalar equation will become
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\frac{\partial\overline{\rho}\widetilde{\phi}}{\partial t}=\nabla\cdot\overline{\rho}\widetilde{\phi}\widetilde{\mathbf{u}}+\nabla.(\overline{\rho}\overline{\Gamma_{\phi}}\nabla\widetilde{\phi})+\nabla\cdot J_{t}+\overline{S_{\phi}}\label{eq:wasatch-filtered-scalar-eq-2}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
And now this new turbulent diffusive flux needs a closure model which will
 be discussed in the next section.
\end_layout

\begin_layout Subsubsection
Subgrid Scalar Closure
\end_layout

\begin_layout Standard
By using gradient diffusion hypothesis, the SGS diffusive flux can be rewritten
 as:
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
J_{t}=\overline{\rho}\Gamma_{\phi_{t}}\nabla\widetilde{\phi}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
Where 
\begin_inset Formula $\Gamma_{\phi_{t}}$
\end_inset

 is turbulent diffusivity constant that can be calculated from the turbulent
 Schmidt number which is defined as:
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
Sc_{t}=\frac{\mu_{t}}{\rho\Gamma_{\phi_{t}}}=\frac{\nu_{t}}{\Gamma_{\phi_{t}}}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
With this definition, after specifying the turbulent Schmidt number of the
 problem and getting the turbulent viscosity, 
\begin_inset Formula $\mu_{t}$
\end_inset

, from one of our closure models for momentum equation, the turbulent diffusivit
y constant will be 
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\Gamma_{\phi_{t}}=\frac{\rho Sc_{t}}{\mu_{t}}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
Finally, the filtered scalar transport equation will be reformed to the
 following equation:
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\frac{\partial\overline{\rho}\widetilde{\phi}}{\partial t}=\nabla\cdot\overline{\rho}\widetilde{\phi}\widetilde{\mathbf{u}}+\nabla.(\overline{\rho}(\overline{\Gamma_{\phi}}+\Gamma_{\phi_{t}})\nabla\widetilde{\phi})+\overline{S_{\phi}}
\end{equation}

\end_inset


\end_layout

\begin_layout Section
Population Balances
\end_layout

\begin_layout Standard
Wasatch currently supports a basic population balance equation with a single
 internal coordinate.
 The targeted equation is written as
\begin_inset Formula 
\begin{equation}
\frac{\partial N}{\partial t}=-\nabla\cdot\mathbf{u}N+\frac{\partial gN}{\partial r}+b;\quad N\equiv N(\mathbf{x},r,t),\label{eq:wasatch-pbe}
\end{equation}

\end_inset

where 
\begin_inset Formula $r$
\end_inset

 is an internal coordinate, 
\begin_inset Formula $g\equiv\frac{\mathrm{d}r}{\mathrm{d}t}$
\end_inset

 denotes the growth rate of 
\begin_inset Formula $r$
\end_inset

, and 
\begin_inset Formula $b$
\end_inset

 represents the death/birth rates of particles.
 To make further headway, solution of the population balance equation is
 usually achieved by solving for the moments of the number density function,
 
\begin_inset Formula $N$
\end_inset

.
 The 
\begin_inset Formula $k^{\mathrm{th}}$
\end_inset

 moment is defined as
\begin_inset Formula 
\begin{equation}
m_{k}\equiv\int_{-\infty}^{+\infty}r^{k}N(\mathbf{x},r,t)\,\mathrm{d}r.\label{eq:wasatch-moment-transform}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
By applying the moment transformation to 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:wasatch-pbe"

\end_inset

, we recover the moment transport equation
\begin_inset Formula 
\begin{equation}
\frac{\partial m_{k}}{\partial t}=-\nabla\cdot\mathbf{u}m_{k}-k\int_{-\infty}^{+\infty}r^{k-1}gN\,\mathrm{d}r+\int_{-\infty}^{+\infty}r^{k}b\,\mathrm{d}r\equiv F(m_{k+i});\quad i\in\mathbb{Q}.\label{eq:wasatch-moment-transport-eq}
\end{equation}

\end_inset

The right-hand-side (RHS) in 
\begin_inset CommandInset ref
LatexCommand formatted
reference "eq:wasatch-moment-transport-eq"

\end_inset

 may be a function of any moment order.
 As such, we can write additional transport equations for these moments.
 However, one usually ends up with a several moments that require closure.
 This may be achieve by the quadrature method of moments.
\end_layout

\begin_layout Standard
The quadrature method of moments (QMOM) is a closure technique used to solve
 the moment transport equations for population balance problems with a single
 internal coordinate.
 The technique is based on Gaussian quadrature to achieve closure for the
 unknown moments.
 Subsequently, the quadrature nodes and abscissae are obtained using the
 lower order moments by using the product-difference algorithm.
 The product-difference algorithm incurs a series of recursion formulas
 that result in an eigenvalue problem whose solution yields the abscissae
 (eigenvalues) and weights (eigenvectors).
\end_layout

\begin_layout Standard
We recently implemented the moment transport equation in Wasatch with the
 flexibility to solve for any number of moments.
 We also added three growth rate models; namely, constant growth, mono-surface
 nucleation, and bulk diffusion to illustrate the ease with which new growth
 models can be implemented.
\end_layout

\begin_layout Chapter
Numerics
\end_layout

\begin_layout Standard
Wasatch uses finite volume discretization on a staggered-grid arrangement.
 All scalars are stored at cell centers including the pressure, while the
 
\begin_inset Formula $x$
\end_inset

, 
\begin_inset Formula $y$
\end_inset

, and 
\begin_inset Formula $z$
\end_inset

 momentum and velocity components are stored at staggered locations.
 Fluxes are stored at the faces of their corresponding fields.
\end_layout

\begin_layout Section
Spatial Discretization
\end_layout

\begin_layout Subsection
Flux Limiters
\end_layout

\begin_layout Section
Time Integration
\end_layout

\begin_layout Standard
Wasatch currently entertains both forward Euler (FE) and third-order Rungue-Kutt
a strong stability preserving (RK3SSP) time integrators.
\end_layout

\begin_layout Subsection
Stable Timestep Selection
\end_layout

\begin_layout Standard
We use a simple stability constraint for timestep selection based on Von-Neumann
 stability analysis of convective and diffusive equations.
 Our stability constraint boils down to
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\frac{\left|u\right|\Delta t}{\Delta x}+\frac{\left|v\right|\Delta t}{\Delta y}+\frac{\left|w\right|\Delta t}{\Delta z}+\frac{\nu\Delta t}{\Delta x^{2}}+\frac{\nu\Delta t}{\Delta y^{2}}+\frac{\nu\Delta t}{\Delta z^{2}}\leq C_{\text{max}}
\end{equation}

\end_inset

or
\begin_inset Formula 
\begin{equation}
\Delta t\leq\frac{C_{\text{max}}}{S};\quad S\equiv\frac{\left|u\right|}{\Delta x}+\frac{\left|v\right|}{\Delta y}+\frac{\left|w\right|}{\Delta z}+\frac{\nu}{\Delta x^{2}}+\frac{\nu}{\Delta y^{2}}+\frac{\nu}{\Delta z^{2}}
\end{equation}

\end_inset

where 
\begin_inset Formula $u$
\end_inset

, 
\begin_inset Formula $v$
\end_inset

, and 
\begin_inset Formula $w$
\end_inset

 are the velocity components, 
\begin_inset Formula $\nu$
\end_inset

 is the kinematic viscosity, and 
\begin_inset Formula $\Delta x$
\end_inset

, 
\begin_inset Formula $\Delta y$
\end_inset

, and 
\begin_inset Formula $\Delta z$
\end_inset

 are the mesh spacings in the 
\begin_inset Formula $x$
\end_inset

, 
\begin_inset Formula $y$
\end_inset

, and 
\begin_inset Formula $z$
\end_inset

 directions, respectively.
 The value of 
\begin_inset Formula $C_{\text{max}}$
\end_inset

 is specified by the user through the input file (see: timestep_Multiplier)
 and is typically chosen to be 0.5.
\end_layout

\begin_layout Chapter
Order of Accuracy Verification
\end_layout

\begin_layout Section
Introduction
\end_layout

\begin_layout Standard
Order-of-accuracy analysis is based on the concept that the error must be
 reduced as spatial and temporal resolutions are increased.
 By comparing the errors at different grid and time resolutions, one can
 estimate the theoretical order of accuracy for a code.
 We first review the general concept of analyzing the order of accuracy
 of a code and follow that with the accuracy verification in Wasatch.
 
\end_layout

\begin_layout Standard
The order of accuracy of a discretization method is defined as 
\shape italic
the exponent of the leading order term in the total error
\shape default
 incurred by the discretization process 
\begin_inset CommandInset citation
LatexCommand citep
key "oberkampf_verification_2010"

\end_inset

.
 The total error refers to the accumulation of truncation and round off
 errors throughout the spatial and temporal domains.
 It can be generally defined as
\begin_inset Formula 
\begin{equation}
E=\left|\phi_{\mathrm{exact}}-\phi_{\mathrm{numerical}}\right|,\label{eq:wasatch-total-error}
\end{equation}

\end_inset

where 
\begin_inset Formula $\phi_{\mathrm{exact}}$
\end_inset

 and 
\begin_inset Formula $\phi_{\mathrm{numerical}}$
\end_inset

 refer to the exact and numerical solutions, respectively.
\end_layout

\begin_layout Standard
Round-off errors are those due to finite precision calculation on a computer
 while the truncation error represents the error induced by neglecting terms
 in a finite numerical approximation.
 For most practical purposes, one can neglect round-off errors and focus
 on how the truncation error is propagated throughout the solution domain.
 This is the strategy that we will adopt in this document.
 
\end_layout

\begin_layout Standard
To illustrate how the truncation error is estimated, we make use of Taylor
 series expansions to approximate the various differential terms in an equation.
 For example, for a transported scalar 
\begin_inset Formula $\phi$
\end_inset

 on a grid with uniform spacing 
\begin_inset Formula $\Delta x$
\end_inset

, the Taylor series at an arbitrary point 
\begin_inset Formula $i$
\end_inset

 is written as
\begin_inset Formula 
\begin{equation}
\phi_{i+1}=\phi_{i}+\frac{\mathrm{d}\phi_{i}}{\mathrm{d}x}\Delta x+\frac{\mathrm{d}^{2}\phi_{i}}{\mathrm{d}x^{2}}\frac{\Delta x^{2}}{2!}+\frac{\mathrm{d}^{3}\phi_{i}}{\mathrm{d}x^{3}}\frac{\Delta x^{3}}{3!}+\ldots.
\end{equation}

\end_inset

One can then approximate the first derivative at grid point 
\begin_inset Formula $i$
\end_inset

 via
\begin_inset Formula 
\begin{equation}
\frac{\mathrm{d}\phi_{i}}{\mathrm{d}x}=\frac{\phi_{i+1}-\phi_{i}}{\Delta x}+\underbrace{\frac{\mathrm{d}^{2}\phi_{i}}{\mathrm{d}x^{2}}\frac{\Delta x}{2!}+\frac{\mathrm{d}^{3}\phi_{i}}{\mathrm{d}x^{3}}\frac{\Delta x^{2}}{3!}+\ldots}_{\text{truncation error}}.
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
Then, one can choose to approximate the first derivative by using the first
 term on the right-hand-side of the previous equation.
 The remaining terms are then known as the truncation error.
 The truncation error has to satisfy certain properties for a discretization
 scheme to be consistent.
 For example, all terms in the truncation error must decrease monotonically.
 Furthermore, the coefficients in the truncation error must be bounded.
 
\end_layout

\begin_layout Standard
The truncation error is usually lumped into a single term and assigned the
 
\begin_inset Formula $\mathcal{O}$
\end_inset

 terminology
\begin_inset Formula 
\begin{equation}
T.E.=\underset{\Delta x\to0}{\mathcal{O}\left(\Delta x^{m}\right)},\quad m\in\mathbb{R}^{+}.
\end{equation}

\end_inset

This definition has a precise meaning: as 
\begin_inset Formula $\Delta x\to0$
\end_inset

, the truncation error is proportional to 
\begin_inset Formula $\Delta x^{p}$
\end_inset

 with a proportionality constant that is independent of 
\begin_inset Formula $\Delta x$
\end_inset

.
 Alternatively, one can write
\begin_inset Formula 
\begin{equation}
\lim_{\Delta x\to0}\frac{T.E.}{\Delta x^{m}}=M,
\end{equation}

\end_inset

where 
\begin_inset Formula $M$
\end_inset

 is a constant.
 Then, the truncation error can be written as
\begin_inset Formula 
\begin{equation}
T.E.=M\Delta x^{m}.
\end{equation}

\end_inset

Subsequently, and by neglecting round-off errors, the total error consists
 of the accumulated truncation error when discretization is carried out
 throughout the spatial or temporal domain.
 In general, this is not the sum of the truncation error incurred by applying
 a discretization method at a single point.
 We will discuss how the truncation error accumulates shortly, but for the
 moment, the total error can be written as
\begin_inset Formula 
\begin{equation}
E=\alpha\Delta x^{p},\label{eq:total-error-one-d}
\end{equation}

\end_inset

where 
\begin_inset Formula $\alpha$
\end_inset

 is a real constant that is independent of the mesh size while 
\begin_inset Formula $p$
\end_inset

 is a positive real number that designates the order-of-accuracy of a discretiza
tion method.
 The purpose of an order-of-accuracy verification is to determine the exponent
 
\begin_inset Formula $p$
\end_inset

 in the total error induced by the discretization process.
 
\end_layout

\begin_layout Section
Common Approaches for Order-of-Accuracy Calculation
\end_layout

\begin_layout Standard
There are two key approaches to estimating the order of accuracy of a given
 implementation.
 The first requires an exact solution and requires at least two mesh refinements
 while the second is based on Richardson extrapolation and requires at least
 three mesh refinements.
 The latter, however, does not require an analytical solution to estimate
 the truncation error.
\end_layout

\begin_layout Subsection
Using an Exact Solution
\end_layout

\begin_layout Standard
When an exact solution is available, the error is readily available as shown
 in 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:wasatch-total-error"

\end_inset

.
 Using 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:total-error-one-d"

\end_inset

, there are two unknowns (
\begin_inset Formula $\alpha$
\end_inset

 and 
\begin_inset Formula $p$
\end_inset

) and therefore one needs two equations to solve for 
\begin_inset Formula $p$
\end_inset

 (and 
\begin_inset Formula $\alpha$
\end_inset

).
 With knowledge of an exact solution, a test problem can be setup and solved
 on two different grid spacings, 
\begin_inset Formula $\Delta x_{1}$
\end_inset

 and 
\begin_inset Formula $\Delta x_{2}=\frac{\Delta x_{1}}{r_{x}}$
\end_inset

.
 Then, one calculates the errors associated with these two grids.
 These are given by
\begin_inset Formula 
\begin{equation}
\begin{cases}
E_{1}= & \alpha\Delta x_{1}^{p}\\
E_{2}= & \alpha\Delta x_{2}^{p}
\end{cases}.
\end{equation}

\end_inset

The order 
\begin_inset Formula $p$
\end_inset

 is readily calculated by taking the ratio of these two equations
\begin_inset Formula 
\begin{equation}
\frac{E_{1}}{E_{2}}=\left(\frac{\Delta x_{1}}{\Delta x_{2}}\right)^{p}=r_{x}^{p}.
\end{equation}

\end_inset

Finally, by taking the logarithm of the former equation, the observed order
 of accuracy is at hand
\begin_inset Formula 
\begin{equation}
p=\frac{\ln\frac{E_{1}}{E_{2}}}{\ln r_{x}}.
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
This method is usually well suited for ODEs or for PDEs when one is after
 the dominant error source.
 The method can be extended for combined order analysis but requires the
 solution of a nonlinear system of equations and at least seven mesh refinement
 levels 
\begin_inset CommandInset citation
LatexCommand citep
before "see"
key "oberkampf_verification_2010"

\end_inset

.
 A more convenient method uses Richardson's extrapolation and does not require
 an analytical solution.
\end_layout

\begin_layout Subsection
Using Richardson's Extrapolation
\end_layout

\begin_layout Standard
When an analytical solution is not available, or when one is dealing with
 PDEs where the effects of spatial and temporal errors compound, Richardson's
 extrapolation provides a convenient way of calculating the order of accuracy.
 Recall that the order of accuracy of a given discretization method determines
 the rate of convergence of the method.
 Hence, in principle, one does not need an analytical solution to analyze
 the rate of convergence.
 The key disadvantage of this approach is that one cannot assess the validity
 of the numerical solution.
 However, such verification may be carried out by comparing to experimental
 data or nuermical solutions obtained via other codes.
\end_layout

\begin_layout Standard
Given three numerical solutions that were obtained with systematic mesh
 refinement, the order of a method can be determined via
\begin_inset Formula 
\begin{equation}
p=\ln\left(\frac{f_{i+2}-f_{i+1}}{f_{i+1}-f_{i}}\right)\frac{1}{\ln\frac{1}{r}}.
\end{equation}

\end_inset


\end_layout

\begin_layout Subsection
Combined Spatio-Temporal Order-of-Accuracy Analysis
\end_layout

\begin_layout Standard
Without loss of generality, the truncation error may be represented as
\begin_inset Formula 
\begin{equation}
E=u_{\mathrm{exact}}-u_{\mathrm{numerical}}=\alpha\Delta t^{p}+\beta\Delta x^{q}+\gamma\Delta y^{r}+\delta\Delta z^{s}.
\end{equation}

\end_inset

This excludes all terms that have mixed orders in them.
\end_layout

\begin_layout Section
Order-of-Accuracy Verification in Wasatch
\end_layout

\begin_layout Subsection
Temporal Order of Accuracy
\end_layout

\begin_layout Standard
Wasatch currently entertains both forward Euler (FE) and third-order Rungue-Kutt
a strong stability preserving (RK3SSP) time integrators.
 To verify the temporal order of accuracy of these integrators, an ODE test
 was designed.
 In the first, we solve an ODE with a time dependent source term.
 Care must be taken when calculating the order of accuracy at the first
 time-step.
 In this scenario, the observed order of accuracy will be one order higher
 than the theoretical one.
 This can be shown as follows.
 Consider a time-stepping discretization of order 
\begin_inset Formula $p$
\end_inset

.
 This solves the following ODE
\begin_inset Formula 
\begin{equation}
\frac{\mathrm{d}\phi}{\mathrm{d}t}=L(\phi).
\end{equation}

\end_inset


\end_layout

\begin_layout Paragraph
ODE with Time-Dependent Source Term
\end_layout

\begin_layout Standard
Our choice falls upon
\begin_inset Formula 
\begin{equation}
\frac{\mathrm{d}\phi}{\mathrm{d}t}=\sin t;\quad\phi(0)=-1.
\end{equation}

\end_inset

The analytical solution for this case is 
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\phi_{\mathrm{exact}}=-\cos t.
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
The tests varied over a time interval of 1 second with systematic mesh refinemen
t.
 The results for both the FE and the RK3SSP are shown in the table below.
\end_layout

\begin_layout Standard
\begin_inset Float table
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
Observed temporal order of accuracy using 
\begin_inset Formula $\frac{\mathrm{d}\phi}{\mathrm{d}t}=\sin t$
\end_inset

.
 Results are taken at 
\begin_inset Formula $t=1\mathrm{s}$
\end_inset

 with systematic timestep refinement.
 
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="8" columns="5">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0">
<column alignment="center" valignment="top" width="0">
<column alignment="center" valignment="top" width="0">
<column alignment="center" valignment="top" width="0">
<column alignment="center" valignment="top" width="0">
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell multicolumn="1" alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Forward Euler
\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell multicolumn="1" alignment="center" valignment="top" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
RK3SSP
\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\Delta t$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $E=\left|\Phi-\phi\right|$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Observed Order
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $E=\left|\Phi-\phi\right|$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Observed Order
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
4.245
\begin_inset Formula $\times10^{-1}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $1.596\times10^{-8}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.05
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2.113
\begin_inset Formula $\times10^{-1}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
1.006
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $9.976\times10^{-10}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
4.000
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.025
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.054
\begin_inset Formula $\times10^{-1}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
1.003
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $6.623\times10^{-11}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
4.000
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.0125
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
5.265
\begin_inset Formula $\times10^{-2}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
1.001
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $3.900\times10^{-12}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
3.998
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.00625
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2.631
\begin_inset Formula $\times10^{-2}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
1.000
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $2.508\times10^{-13}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
3.959
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.003125
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.315
\begin_inset Formula $\times10^{-2}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
1.000
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $3.175\times10^{-14}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
2.984
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Paragraph
ODE with Implicit Source Term
\end_layout

\begin_layout Standard
In this verification test, we solve the following ODE
\begin_inset Formula 
\begin{equation}
\frac{\mathrm{d}\phi}{\mathrm{d}t}=\phi;\quad\phi(0)=1.
\end{equation}

\end_inset

The exact solution is given by
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\Phi=e^{t}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
Being a time-dependent ODE with no spatial variation, the mesh resolution
 is set to [2, 2, 2] in Wasatch to reduce computational time.
 The code is run with both FE and RK3 time integrators with 6 refinement
 levels (or a total of 7 tests) starting with 
\begin_inset Formula $\Delta t_{0}=0.1\mathrm{s}$
\end_inset

 with a refinement ratio of 
\begin_inset Formula $r_{t}=2$
\end_inset

 (recall that 
\begin_inset Formula $r_{t}\equiv\frac{\Delta t_{i}}{\Delta t_{i+1}}$
\end_inset

 where 
\begin_inset Formula $\Delta t_{i}$
\end_inset

 and 
\begin_inset Formula $\Delta t_{i+1}$
\end_inset

 correspond to the coarse and fine meshes, respectively).
\end_layout

\begin_layout Standard
\begin_inset Float table
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
Observed temporal order of accuracy using 
\begin_inset Formula $\frac{\mathrm{d}\phi}{\mathrm{d}t}=\phi$
\end_inset

.
 Results are taken at 
\begin_inset Formula $t=2\mathrm{s}$
\end_inset

 with systematic timestep refinement.
 
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="9" columns="5">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0">
<column alignment="center" valignment="top" width="0">
<column alignment="center" valignment="top" width="0">
<column alignment="center" valignment="top" width="0">
<column alignment="center" valignment="top" width="0">
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell multicolumn="1" alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Forward Euler
\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell multicolumn="1" alignment="center" valignment="top" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
RK3SSP
\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\Delta t$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $E=\left|\Phi-\phi\right|$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Observed Order
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $E=\left|\Phi-\phi\right|$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Observed Order
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $6.615\times10^{-1}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $5.684\times10^{-4}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.05
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $3.491\times10^{-1}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
0.922
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $7.395\times10^{-5}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
2.942
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.025
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $1.795\times10^{-1}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
0.959
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $9.431\times10^{-6}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
2.971
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.0125
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $9.103\times10^{-2}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
0.979
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $1.191\times10^{-6}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
2.985 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.00625
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $4.584\times10^{-2}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
0.989
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $1.496\times10^{-7}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
2.992
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.003125
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $2.301\times10^{-3}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
0.994
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $1.874\times10^{-8}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
2.996
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.0015625
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $1.152\times10^{-3}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
0.977
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $2.346\times10^{-9}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
2.997
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Paragraph
Pressure Projection with Taylor-Green Vortex
\end_layout

\begin_layout Subsection
Spatial Order of Accuracy
\end_layout

\begin_layout Standard
A method of manufactured solution has been done on wasatch using forward
 Euler method on a Taylor-Vortex problem to check the spatial and temporal
 order of accuracy.
 We state the spatial order of accuracy here as long as the temporal order
 of accuracy has been already shown in this document in previous subsection.
\end_layout

\begin_layout Standard
In order to check the spatial order of accuracy we looked at the four different
 grid resolutions for our domain, and we chose 0.001, 0.0005, 0.00025 and 0.000125
 respectively for their time step.
 However, we just looked at the results after the first time step.
 This is in order to neglecting the temporal accuracy in the explicit solvers.
 Because, those terms will be calculated in the previous time step, therefore,
 in all of our cases they will be calculated at time zero.
 So, because of using the same time for these terms we don’t let the time
 accuracy to influence our results for grid convergence study
\end_layout

\begin_layout Standard
Taylor-Vortex problem is a 2D problem where the exact solutions are:
\begin_inset Formula 
\begin{eqnarray}
u(x,y,t) & = & 1-A\cos(x-t)\sin(y-t)\exp(-2\nu t),\\
v(x,y,t) & = & 1+A\sin(x-t)\cos(y-t)\exp(-2\nu t).
\end{eqnarray}

\end_inset

Where in this study, 
\begin_inset Formula $A=4$
\end_inset

 and 
\begin_inset Formula $\nu=0.1$
\end_inset

.
\end_layout

\begin_layout Standard
In order to calculate the error the norm over the whole area is taken to
 obtain
\begin_inset Formula 
\begin{equation}
E=\left\Vert u_{exact}-u_{numerical}\right\Vert .
\end{equation}

\end_inset

So we can consider all of the point on the grid together.
 
\end_layout

\begin_layout Subparagraph
Results for Spatial order of accuracy
\end_layout

\begin_layout Standard
The results for both 
\begin_inset Formula $u$
\end_inset

 and 
\begin_inset Formula $v$
\end_inset

 using the FE are shown in the table below
\end_layout

\begin_layout Standard
\begin_inset Float table
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
Observed spatial order of accuracy using Taylor-Vortex.
 Results are taken at 
\begin_inset Formula $t=2\mathrm{s}$
\end_inset

 with systematic time-step refinement.
 
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="6" columns="5">
<features tabularvalignment="middle">
<column alignment="center" valignment="top" width="0">
<column alignment="center" valignment="top" width="0">
<column alignment="center" valignment="top" width="0">
<column alignment="center" valignment="top" width="0">
<column alignment="center" valignment="top" width="0">
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell multicolumn="1" alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $u$
\end_inset


\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell multicolumn="1" alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $v$
\end_inset


\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\Delta x$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $E=norm(U-u)$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Observed Order
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $E=norm(U-u)$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Observed Order
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.1257
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $1.856\times10^{-3}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $1.856\times10^{-3}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.0628
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $4.650\times10^{-4}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
1.997
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $4.650\times10^{-4}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
1.997
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.0314
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $1.163\times10^{-4}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
1.999
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $1.163\times10^{-4}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
1.999
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.0157
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $2.908\times10^{-5}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
2.000
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $2.908\times10^{-5}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
2.000
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
As it is clear from the table the spatial order of accuracy is 2 as it was
 expected for the FE method with central 3 point discretization in space.
\end_layout

\begin_layout Chapter
Scalability
\end_layout

\begin_layout Standard
To test some scalability aspects of Wasatch, we implemented the model discussed
 in 
\begin_inset CommandInset ref
LatexCommand formatted
reference "eq:pde-example"

\end_inset

.
 [DEVIN, can you add some results here?]
\end_layout

\begin_layout Chapter
Boundary Conditions
\end_layout

\begin_layout Section
Overview of Defining Boundary Conditions
\begin_inset CommandInset label
LatexCommand label
name "sec:overview-bcs"

\end_inset


\end_layout

\begin_layout Standard
Wasatch provides the machinery to apply Dirichlet and Neumann boundary condition
s.
 Our approach is based on setting boundary conditions on ghost cells at
 the boundaries of the computational domain to reproduce the desired boundary
 at the face.
 This is illustrated in 
\begin_inset CommandInset ref
LatexCommand formatted
reference "fig:boundary-condition-specification"

\end_inset

.
 
\end_layout

\begin_layout Standard
\begin_inset Float figure
placement H
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename figures/pdf/wasatch_bc_treatment.pdf

\end_inset


\begin_inset Caption

\begin_layout Plain Layout
Boundary condition specification in Wasatch.
 Here, 
\begin_inset Formula $\Phi_{\text{BC}}$
\end_inset

 designates the desired value of the scalar or its flux at the boundary,
 
\begin_inset Formula $\phi_{\text{interior }}$
\end_inset

 is the interior value of the scalar, and 
\begin_inset Formula $\phi_{\text{ghost}}$
\end_inset

 is the ghost value to be set.
\begin_inset CommandInset label
LatexCommand label
name "fig:boundary-condition-specification"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
Mathematically, this may be written as follows.
 Consider a scalar 
\begin_inset Formula $\phi$
\end_inset

 for which a boundary condition is to be specified.
 The ghost value of 
\begin_inset Formula $\phi$
\end_inset

 may then be written as
\begin_inset Formula 
\begin{equation}
\phi_{\text{ghost}}=\alpha\phi_{\text{interior}}+\beta\Phi_{\text{{BC}}},
\end{equation}

\end_inset

where 
\begin_inset Formula $\alpha$
\end_inset

 and 
\begin_inset Formula $\beta$
\end_inset

 are real coefficients that depend on the type of boundary condition specified.
 These are summarized in 
\begin_inset CommandInset ref
LatexCommand formatted
reference "tbl:summary-of-coefficients-cell-centered"

\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset Float table
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="3" columns="3">
<features tabularvalignment="middle">
<column alignment="center" valignment="top" width="0">
<column alignment="center" valignment="top" width="0">
<column alignment="center" valignment="top" width="0">
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\alpha$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\beta$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Dirichlet
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.5
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.5
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Neumann
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.0
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $-\Delta x$
\end_inset


\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
Summary of coefficients for setting values at ghost cells to reproduce a
 desired boundary condition at a physical boundary.
\begin_inset CommandInset label
LatexCommand label
name "tbl:summary-of-coefficients-cell-centered"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
For Staggered fields on uniform structured grids, a simplification follows
 for setting Dirichlet conditions.
 In this case, certain boundary faces coincide with staggered control volumes
 and the desired Dirichlet condition may be set directly on those cells.
\end_layout

\begin_layout Section
Scalar Transport Boundary Conditions
\end_layout

\begin_layout Standard
The treatment of scalar boundary conditions follows from the previous discussion.
 Specification of either fixed values or fluxes of transported scalars is
 easily achieved using the machinery discussed in 
\begin_inset CommandInset ref
LatexCommand formatted
reference "sec:overview-bcs"

\end_inset

.
\end_layout

\begin_layout Section
Fluid Flow Boundary Conditions
\end_layout

\begin_layout Subsection
Inlets, Walls, and Moving Walls
\end_layout

\begin_layout Standard
\begin_inset Float figure
placement b
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename figures/pdf/wasatch_pressure_bc_treatment.pdf

\end_inset


\begin_inset Caption

\begin_layout Plain Layout
Derivation of pressure boundary conditions.
\begin_inset CommandInset label
LatexCommand label
name "fig:boundary-condition-pressure-specification-1"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
Inlets and walls, whether moving or stationary, share the same boundary
 condition specification.
 The user only specifies the momentum at those boundaries,
\begin_inset Formula 
\begin{equation}
\rho\mathbf{u}=\rho(U,V,W).\label{eq:wasatch-bc-ppe-1d-1}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
Treatment of the pressure is derived from the pressure Poisson equation
 as follows.
 For simplicity, we illustrate this in one-dimension at a boundary cell
 on the 
\begin_inset Formula $x$
\end_inset

-minus side of the computational domain as shown in 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:boundary-condition-pressure-specification-1"

\end_inset

.
 In this case, the pressure poisson equation is written as
\begin_inset Formula 
\begin{equation}
\frac{\partial^{2}p}{\partial x^{2}}=\frac{\partial F}{\partial x}.\label{eq:wasatch-bc-ppe-1d}
\end{equation}

\end_inset

Using second order finite differencing, 
\begin_inset CommandInset ref
LatexCommand formatted
reference "eq:wasatch-bc-ppe-1d"

\end_inset

 may be written as
\begin_inset Formula 
\begin{equation}
\frac{p_{-1}-2p_{0}+p_{1}}{\Delta x^{2}}=\frac{F_{\tfrac{1}{2}}-F_{-\tfrac{1}{2}}}{\Delta x}.\label{eq:wasatch-bc-ppe-1d-discrete}
\end{equation}

\end_inset

Here, both 
\begin_inset Formula $p_{-1}$
\end_inset

 and 
\begin_inset Formula $F_{i-\tfrac{1}{2}}$
\end_inset

 are unknown and one may be inclined to specify these quantities at the
 boundary.
 However, by using the 
\begin_inset Formula $x$
\end_inset

-momentum equation, one can relate these quantities by projecting and evaluating
 the momentum equations in the direction normal to the boundary.
 In our example, on an 
\begin_inset Formula $x$
\end_inset

-minus face, we evaluate the 
\begin_inset Formula $x$
\end_inset

-momentum equation at the 
\begin_inset Formula $x$
\end_inset

-minus face.
 This yields
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\left(\frac{\partial\rho u}{\partial t}\right)_{-\tfrac{1}{2}}=-\left(\frac{\partial p}{\partial x}\right)_{-\tfrac{1}{2}}-F_{-\tfrac{1}{2}}.
\end{equation}

\end_inset

Again, using central finite differencing, one recovers
\begin_inset Formula 
\begin{equation}
\left(\frac{\partial\rho u}{\partial t}\right)_{-\tfrac{1}{2}}=-\frac{p_{0}-p_{-1}}{\Delta x}-F_{i-\tfrac{1}{2}}
\end{equation}

\end_inset

or
\begin_inset Formula 
\begin{equation}
\frac{p_{-1}-p_{0}}{\Delta x}=\left(\frac{\partial\rho u}{\partial t}\right)_{-\tfrac{1}{2}}+F_{-\tfrac{1}{2}}.\label{eq:wasatch-xmom-1d}
\end{equation}

\end_inset

The force balance in 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:wasatch-xmom-1d"

\end_inset

 states that the pressure gradient is balanced by accumulation of momentum
 and convective and diffusive fluxes - a restatement of Newton's second
 law.
 One then substitutes 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:wasatch-xmom-1d"

\end_inset

 into 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:wasatch-bc-ppe-1d-discrete"

\end_inset

.
 This operation returns the following Poisson equation at the boundary
\begin_inset Formula 
\begin{equation}
\frac{\left(\frac{\partial\rho u}{\partial t}\right)_{-\tfrac{1}{2}}}{\Delta x}+\frac{F_{-\tfrac{1}{2}}}{\Delta x}+\frac{-p_{0}+p_{1}}{\Delta x^{2}}=\frac{F_{\tfrac{1}{2}}-F_{-\tfrac{1}{2}}}{\Delta x}.
\end{equation}

\end_inset

Notice how the diffusive and convective fluxes cancel out and one is left
 with
\begin_inset Formula 
\begin{equation}
\frac{-p_{0}+p_{1}}{\Delta x^{2}}=\frac{F_{\tfrac{1}{2}}}{\Delta x}-\frac{\left(\frac{\partial\rho u}{\partial t}\right)_{-\tfrac{1}{2}}}{\Delta x}.\label{eq:wasatch-inlet-wall-bc-ppe-1d-discrete-final}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
According to 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:wasatch-inlet-wall-bc-ppe-1d-discrete-final"

\end_inset

, both the pressure-coefficient-matrix and the pressure right-hand-side
 must be modified.
 Because 
\begin_inset Formula $F_{-\tfrac{1}{2}}$
\end_inset

 never shows up in 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:wasatch-inlet-wall-bc-ppe-1d-discrete-final"

\end_inset

, we simply set it to zero in the Wasatch input file while also setting
 the coefficient for 
\begin_inset Formula $p_{-1}$
\end_inset

 to 0 (the code automatically takes care of that).
\end_layout

\begin_layout Subsection
Outflow
\end_layout

\begin_layout Standard
An outflow boundary condition is one where 
\begin_inset Quotes eld
\end_inset

most
\begin_inset Quotes erd
\end_inset

 of the flow is leaving the domain.
 Specifically, an outflow boundary must reduce reflections and promote 
\begin_inset Quotes eld
\end_inset

absorption
\begin_inset Quotes erd
\end_inset

 of the flow.
 For simplicity, consider an x+ outflow boundary.
 we specify the following
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\begin{cases}
\rho u_{i+\tfrac{1}{2}}^{n}\geq0 & \frac{\partial\widehat{\rho u}}{\partial x}=0\\
\rho u_{i+\tfrac{1}{2}}^{n}<0 & \widehat{\rho u}=0
\end{cases}
\end{equation}

\end_inset

where
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\widehat{\rho u}=(\rho u)^{n}+\Delta tF^{n}
\end{equation}

\end_inset

is the uncorrected velocity field that does not satisfy mass conservation.
 For wasatch, the first condition implies, at first order
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\frac{\partial\widehat{\rho u}}{\partial x}\approx\frac{(\widehat{\rho u})_{i+\tfrac{1}{2}}^{n}-(\widehat{\rho u})_{i-\tfrac{1}{2}}^{n}}{\Delta x}=0
\end{equation}

\end_inset

or
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
(\widehat{\rho u})_{i+\tfrac{1}{2}}^{n}=(\widehat{\rho u})_{i-\tfrac{1}{2}}^{n}
\end{equation}

\end_inset

in other words
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
(\rho u)_{i+\tfrac{1}{2}}^{n}+\Delta tF_{i+\tfrac{1}{2}}^{n}=(\rho u)_{i-\tfrac{1}{2}}^{n}+\Delta tF_{i-\tfrac{1}{2}}^{n}
\end{equation}

\end_inset

All quantities are known except for 
\begin_inset Formula $F_{i+\tfrac{1}{2}}^{n}$
\end_inset

.
 This leads us to specifying
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
F_{i+\tfrac{1}{2}}^{n}=-\frac{1}{\Delta t}(\rho u)_{i+\tfrac{1}{2}}^{n}+\frac{1}{\Delta t}(\rho u)_{i-\tfrac{1}{2}}^{n}+F_{i-\tfrac{1}{2}}^{n}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
The remaining boundary condition is simple and implies that
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
F_{i+\tfrac{1}{2}}^{n}=-\frac{1}{\Delta t}(\rho u)_{i+\tfrac{1}{2}}^{n}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
In summary, we have the following
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\begin{cases}
(\rho u)_{i+\tfrac{1}{2}}^{n}\geq0 & F_{i+\tfrac{1}{2}}^{n}=-\frac{1}{\Delta t}(\rho u)_{i+\tfrac{1}{2}}^{n}+\frac{1}{\Delta t}(\rho u)_{i-\tfrac{1}{2}}^{n}+F_{i-\tfrac{1}{2}}^{n}\\
(\rho u)_{i+\tfrac{1}{2}}^{n}<0 & F_{i+\tfrac{1}{2}}^{n}=-\frac{1}{\Delta t}(\rho u)_{i+\tfrac{1}{2}}^{n}
\end{cases}
\end{equation}

\end_inset


\end_layout

\begin_layout Subsection
Open Boundary Condition
\end_layout

\begin_layout Standard
The open boundary condition is the oposite of the outflow BC and is thought
 of as to encourage the flow to enter the domain.
 At the outset, we have
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\begin{cases}
(\rho u)_{i+\tfrac{1}{2}}^{n}\leq0 & F_{i+\tfrac{1}{2}}^{n}=-\frac{1}{\Delta t}(\rho u)_{i+\tfrac{1}{2}}^{n}+\frac{1}{\Delta t}(\rho u)_{i-\tfrac{1}{2}}^{n}+F_{i-\tfrac{1}{2}}^{n}\\
(\rho u)_{i+\tfrac{1}{2}}^{n}>0 & F_{i+\tfrac{1}{2}}^{n}=-\frac{1}{\Delta t}(\rho u)_{i+\tfrac{1}{2}}^{n}
\end{cases}
\end{equation}

\end_inset


\end_layout

\begin_layout Subsection
Pressure Outlet
\end_layout

\begin_layout Standard
The designation of a pressure outlet has a different meaning for different
 CFD schools of thought.
 In Wasatch, a pressure outlet is simply an artificial location in space
 where one does not have information about the velocity or momentum profile.
 In practice, however, one may have knowledge of the pressure at such boundaries.
\end_layout

\begin_layout Standard
The user must specify a value for the outlet pressure.
 This value may be specified at the extra-cell or on the domain boundary
 face.
 Both options give stable results.
 In Wasatch, we implement the latter option.
\end_layout

\begin_layout Standard
Treatment of the pressure follows the same guidelines exposed in the previous
 section.
 In this case, however, the pressure 
\begin_inset Formula $p_{-1}$
\end_inset

 may be related to 
\begin_inset Formula $P_{-\tfrac{1}{2}}$
\end_inset

 on the boundary face.
 Given that the pressure lives on scalar cell centers, using second order
 approximation, we have
\begin_inset Formula 
\begin{equation}
P_{-\tfrac{1}{2}}=\frac{p_{-1}+p_{0}}{2}
\end{equation}

\end_inset

or
\begin_inset Formula 
\begin{equation}
p_{-1}=2P_{-\tfrac{1}{2}}-p_{0}.
\end{equation}

\end_inset

Then, the pressure poisson equation (evaluated at the boundary) returns
\begin_inset Formula 
\begin{equation}
\frac{-3p_{0}+p_{1}}{\Delta x^{2}}=-2P_{-\tfrac{1}{2}}+\frac{F_{\tfrac{1}{2}}-F_{-\tfrac{1}{2}}}{\Delta x}.\label{eq:wasatch-bc-ppe-1d-discrete-1}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
The momentum partial right-hand-side remains unknown in the previous equation.
 One can choose either of the following conditions
\begin_inset Formula 
\begin{equation}
\begin{cases}
F_{-\tfrac{1}{2}}=0\\
\frac{\partial F}{\partial x}=0
\end{cases}.
\end{equation}

\end_inset

The former may be interpreted to imply a balance between diffusive and convectiv
e fluxes at the pressure outlet boundary.
 It may also be interpreted as a zero flux condition for convective and
 diffusive fluxes.
 The latter is self evident where one is assuming a self-similar profile
 for convective and diffusive fluxes.
\end_layout

\begin_layout Chapter
Complex Geometry
\end_layout

\begin_layout Standard
Wasatch can, in principle, handle geometries of arbitrary complexity by
 using a discrete stairstepping procedure.
 This approach may be thought of as a simplified version of the cut-cell
 method where only integer volume (and area) fractions are allowed.
 A volume fraction field is defined as the amount of fluid that fills a
 given control volume while the area-fraction corresponds to the fraction
 of the cell-boundary at a fluid-solid interface.
\end_layout

\begin_layout Standard
\noindent
\align center
\begin_inset Float figure
placement h
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Float figure
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\begin_inset Graphics
	filename figures/pdf/wasatch_embedded_cylinder_cut_cell_approach.pdf
	width 3in

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
Embedded cylinder using cut-cells.
\end_layout

\end_inset


\end_layout

\end_inset


\begin_inset Float figure
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\begin_inset Graphics
	filename figures/pdf/wasatch_embedded_cylinder_stairstepping.pdf
	width 3in

\end_inset


\begin_inset Caption

\begin_layout Plain Layout
Embedded cylinder using stairstepping.
\end_layout

\end_inset


\end_layout

\end_inset


\begin_inset Caption

\begin_layout Plain Layout
Comparison of cut-cells and stairstepping for embedded geometries.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Section
Rational Formulation
\end_layout

\begin_layout Standard
To handle embedded geometries, Wasatch first calculates four scalar fields,
 
\begin_inset Formula $\varphi_{\mathrm{v}}$
\end_inset

, 
\begin_inset Formula $\varphi_{\mathrm{x}}$
\end_inset

, 
\begin_inset Formula $\varphi_{\mathrm{y}}$
\end_inset

, and 
\begin_inset Formula $\varphi_{\mathrm{z}}$
\end_inset

.
 These correspond to the cell-centered and x, y, z-staggered volume fractions,
 respectively.
 The staggered volume fractions are nothing more than the area-fractions.
 We call them staggered volume fractions, however, because of the nature
 of stairstpping and the fact that area fractions have integer values in
 this case and hence coincide with staggered volumes on structured, uniform
 grids.
 These are shown in figure 1 below where the various volume fractions are
 depicted along with their associated control volumes.
\end_layout

\begin_layout Standard
\begin_inset Float figure
placement h
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename figures/pdf/wasatch_embedded_vol_area_fractions.pdf

\end_inset


\begin_inset Caption

\begin_layout Plain Layout
Cell-centered and staggered volume fractions associated with a solid intrusion.
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Subsection
Momentum Transport
\end_layout

\begin_layout Standard
In order for the solid intrusions to affect the fluid dynamics, the surface
 (convection, diffusion) and volume (pressure) forces must be set appropriately
 at cell boundaries.
 In general, one must multiply surface forces by the area fractions while
 volume forces get multiplied by the cell-centered volume fraction.
 In Wasatch, this may be easily accomplished by multiplying the momentum
 partial-right-hand-side expressions by their corresponding area fractions,
 as follows
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\frac{\partial\rho\mathbf{u}}{\partial t}=\boldsymbol{\varphi}\cdot\mathbf{F}-\varphi_{\mathrm{v}}\nabla p;\quad\mathbf{F}\equiv-\nabla\cdot\rho\mathbf{u}\mathbf{u}-\nabla\cdot\boldsymbol{\tau}_{ij};\quad\boldsymbol{\varphi}\equiv(\varphi_{\mathrm{x}},\varphi_{\mathrm{y}},\varphi_{\mathrm{z}})
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
The pressure poisson equation is also modified to account for the presence
 of the solids.
 We assume that the pressure is uniformly known inside the solid (e.g.
 
\begin_inset Formula $p=0$
\end_inset

) and modify the matrix accordingly.
 For a cell inside a solid, we set all matrix coefficients to zero except
 the center coefficient which is set to 1
\end_layout

\begin_layout Standard

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
\begin_inset Formula 
\begin{equation}
a.w=a.e=a.n=a.s=a.t=a.b=0,\quad a.p=1
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
For a fluid cell neighboring a solid, treatment is similar to that at a
 wall.
 For illustration purposes, we give the following example at a corner cell.
\end_layout

\begin_layout Standard
\noindent
\align center
\begin_inset Float figure
placement h
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename figures/pdf/wasatch_embedded_pressure_coefs_interior.pdf

\end_inset


\end_layout

\begin_layout Plain Layout
\align center
\begin_inset Caption

\begin_layout Plain Layout
Pressure matrix coefficients near embedded boundaries.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Section
Input Specification
\end_layout

\begin_layout Standard
Wasatch provides a simple interface for specifying intrusions as shown in
 
\begin_inset CommandInset ref
LatexCommand formatted
reference "lst:wasatch-embedded-geometry-ups-spec"

\end_inset

.
 Geometry, which is represented by volume and area fractions, can be specified
 via three mechanisms:
\end_layout

\begin_layout Enumerate
Uintah's geometry objects: These include all of Uintah's geometry pieces
 as well as geometry operations such as unions, intersections, differences,
 etc...
 Please refer to Uintah's UPS specification for a list of supported geometry
 objects.
\end_layout

\begin_layout Enumerate
Wasatch's geometry expressions: These are useful when designing special
 geometry objects not handled by Uintah including time-dependent geometry.
\end_layout

\begin_layout Enumerate
External volume and area fractions: This is useful when another Uintah component
 (e.g.
 Arches) is driving Wasatch and that component calculates area and volume
 fractions.
 All one needs in this case is to provide the names of the volume and area
 fractions calculated by the external component.
\end_layout

\begin_layout Standard
\begin_inset listings
lstparams "language=XML,tabsize=2"
inline false
status open

\begin_layout Plain Layout

<EmbeddedGeometry  spec="OPTIONAL NO_DATA"                        
\end_layout

\begin_layout Plain Layout

                   children1="ONE_OF(CHILD Intrusion, GeometryExpression,
 External)" >        
\end_layout

\begin_layout Plain Layout

  <Inverted       spec="OPTIONAL NO_DATA"/>      
\end_layout

\begin_layout Plain Layout

  <MovingGeometry spec="OPTIONAL NO_DATA"/>          
\end_layout

\begin_layout Plain Layout

  <External       spec="OPTIONAL NO_DATA">         
\end_layout

\begin_layout Plain Layout

    <SVolFraction     spec="REQUIRED STRING"/>        
\end_layout

\begin_layout Plain Layout

    <XVolFraction     spec="REQUIRED STRING"/>         
\end_layout

\begin_layout Plain Layout

    <YVolFraction     spec="REQUIRED STRING"/>         
\end_layout

\begin_layout Plain Layout

    <ZVolFraction     spec="REQUIRED STRING"/>                         
      
\end_layout

\begin_layout Plain Layout

  </External>                
\end_layout

\begin_layout Plain Layout

  <Intrusion      spec="MULTIPLE NO_DATA">       
\end_layout

\begin_layout Plain Layout

    <geom_object  spec="REQUIRED"/>     
\end_layout

\begin_layout Plain Layout

  </Intrusion>      
\end_layout

\begin_layout Plain Layout

  <GeometryExpression            spec="OPTIONAL" />        
\end_layout

\begin_layout Plain Layout

</EmbeddedGeometry>
\end_layout

\begin_layout Plain Layout

\begin_inset Caption

\begin_layout Plain Layout
Specification of embedded geometry in Wasatch.
\begin_inset CommandInset label
LatexCommand label
name "lst:wasatch-embedded-geometry-ups-spec"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
As an illustrative example of using some of Uintah's geometry objects, 
\begin_inset CommandInset ref
LatexCommand formatted
reference "lst:wasatch-embedded-geometry-example"

\end_inset

 summarizes the embedded geometry specification for the intrusion of two
 parallelpepipeds and a cylinder in a cross-flow.
\end_layout

\begin_layout Standard
\begin_inset listings
lstparams "language=XML,tabsize=2"
inline false
status open

\begin_layout Plain Layout

<EmbeddedGeometry>
\end_layout

\begin_layout Plain Layout

 <Intrusion>
\end_layout

\begin_layout Plain Layout

		<geom_object>
\end_layout

\begin_layout Plain Layout

		<union>
\end_layout

\begin_layout Plain Layout

			 <cylinder>
\end_layout

\begin_layout Plain Layout

					<bottom>[0,0,-1]</bottom>
\end_layout

\begin_layout Plain Layout

					<top>[0,0,1]</top>
\end_layout

\begin_layout Plain Layout

					<radius>0.15</radius>
\end_layout

\begin_layout Plain Layout

			 </cylinder>
\end_layout

\begin_layout Plain Layout

			 <parallelepiped>
\end_layout

\begin_layout Plain Layout

				 <p1>[0,0.3,1]</p1>
\end_layout

\begin_layout Plain Layout

				 <p2>[0,0.55,1]</p2>
\end_layout

\begin_layout Plain Layout

				 <p3>[0.5,0.55,1]</p3>
\end_layout

\begin_layout Plain Layout

				 <p4>[0,0.3,-1]</p4>                                       
\end_layout

\begin_layout Plain Layout

			 </parallelepiped>             
\end_layout

\begin_layout Plain Layout

			 <parallelepiped>
\end_layout

\begin_layout Plain Layout

				 <p1>[0.35, -0.3,  1]</p1>
\end_layout

\begin_layout Plain Layout

				 <p2>[0.35, -0.55, 1]</p2>
\end_layout

\begin_layout Plain Layout

				 <p3>[0.65, -0.55, 1]</p3>
\end_layout

\begin_layout Plain Layout

				 <p4>[0.35, -0.3, -1]</p4>                                       
\end_layout

\begin_layout Plain Layout

			 </parallelepiped>                        
\end_layout

\begin_layout Plain Layout

		 </union>
\end_layout

\begin_layout Plain Layout

	 </geom_object>
\end_layout

\begin_layout Plain Layout

 </Intrusion>    
\end_layout

\begin_layout Plain Layout

</EmbeddedGeometry>
\end_layout

\begin_layout Plain Layout

\begin_inset Caption

\begin_layout Plain Layout
Example of embedding multiple geometrical objects in Wasatch.
\begin_inset CommandInset label
LatexCommand label
name "lst:wasatch-embedded-geometry-example"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
The specification shown in 
\begin_inset CommandInset ref
LatexCommand formatted
reference "lst:wasatch-embedded-geometry-example"

\end_inset

 produces the snapshows shown in 
\begin_inset CommandInset ref
LatexCommand formatted
reference "fig:Embedded-geometry-example-snapshots"

\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset Float figure
placement h
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename figures/raster/wasatch-embedded-flow-past-objects.png
	lyxscale 10
	width 5in

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
Illustration of the embedded geometry shown in 
\begin_inset CommandInset ref
LatexCommand formatted
reference "lst:wasatch-embedded-geometry-example"

\end_inset

.
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\align center
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename figures/raster/wasatch-embedded-flow-past-objects-1.png
	width 5in

\end_inset


\begin_inset Caption

\begin_layout Plain Layout
Flow over multiple intrusions showing scalar mixing in the wake region of
 the embedded geometry.
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\begin_inset Caption

\begin_layout Plain Layout
Embedded geometry example in Wasatch.
\begin_inset CommandInset label
LatexCommand label
name "fig:Embedded-geometry-example-snapshots"

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Section
Limitations
\end_layout

\begin_layout Standard
At the time of writing (January 2013), Wasatch embedded boundaries have
 the following limitations:
\end_layout

\begin_layout Itemize
Simple wall boundary conditions: embedded objects are assumed to be simple/inert
 walls with no scalar or momentum fluxes at their boundaries.
\end_layout

\begin_layout Itemize
Embedded geometry is assumed to be stationary.
\end_layout

\begin_layout Standard
Future efforts in this arena will address the above limitations.
 There is currently no interest, however, in moving from stairstepping towards
 cut-cell methods.
\end_layout

\begin_layout Chapter
Modeling General Scalar Transport
\end_layout

\begin_layout Chapter
Modeling Species Transport
\end_layout

\begin_layout Chapter
Modeling Dispersed-Phase Flows
\end_layout

\begin_layout Section
Precipitation
\end_layout

\begin_layout Standard
Wasatch supports precipitation-physics reactions utilizing the quadrature
 method of moments to solve the population balance equation.
 The internal coordinate in this case is the particle radius.
\end_layout

\begin_layout Subsection
Governing Equations
\end_layout

\begin_layout Standard
The precipitation model utilized in Wasatch uses the implemented moment
 transport equations.
\begin_inset Formula 
\begin{equation}
\frac{\partial m_{k}}{\partial t}=-\nabla\cdot\mathbf{u}m_{k}-k\int_{-\infty}^{+\infty}r^{k-1}gN\,\mathrm{d}r+\int_{-\infty}^{+\infty}r^{k}b\,\mathrm{d}r\equiv F(m_{k+i});\quad i\in\mathbb{Q},\label{eq:wasatch-moment-transport-eq-1}
\end{equation}

\end_inset

with QMOM used as closure for the moments.
 The moments that require closure will change based on the growth rate model
 that is utilized, and the closure is taken care of automatically in the
 Wasatch algorithm.
 The relavent terms dictating the reaction rate are tabulated by the extent
 of reaction and the mixture fraction.
 The main term required is the supersaturation value of the liquid.
 The source term for the reaction progress is
\begin_inset Formula 
\begin{equation}
S_{\xi}=\frac{1}{\iota}\sum_{\alpha=1}^{n}\nu_{\alpha}S_{3,\alpha},
\end{equation}

\end_inset

where 
\begin_inset Formula $S_{3,\alpha}$
\end_inset

 is the source term of the third moment, representing the volume, of species
 
\begin_inset Formula $\alpha$
\end_inset

, 
\begin_inset Formula $\nu_{\alpha}$
\end_inset

 is the molecular volume, and 
\begin_inset Formula $\iota$
\end_inset

 is the maximum moles of precipitate.
\end_layout

\begin_layout Subsection
Birth Models
\end_layout

\begin_layout Standard
Nucleation terms in Wasatch can be specifed as one of three distributions,
 point, uniform, and normal.
 Each of these distributions requires the specification of a nucleation
 radius which can either be set as a constant or as the critical radius
 
\begin_inset Formula $r^{*}=r_{0}/\log(S)$
\end_inset

.
 The uniform and normal distributions also require a specified standard
 deviation for the distribution.
 The coefficient used for the birth term can either be set as constant or
 using the classical nucleation definition
\begin_inset Formula 
\begin{equation}
B_{0}=\exp\left[\tfrac{16\pi}{3}(\tfrac{\gamma}{K_{B}T})^{3}\frac{\nu}{N_{\text{A}}\log(S)^{2}}\right],
\end{equation}

\end_inset

where 
\begin_inset Formula $\gamma$
\end_inset

 is the surface energy, 
\begin_inset Formula $K_{B}$
\end_inset

 is the Boltzman constant, 
\begin_inset Formula $T$
\end_inset

 is the temperature in Kelvin, 
\begin_inset Formula $\nu$
\end_inset

 is the molecular volume, and 
\begin_inset Formula $N_{\text{A}}$
\end_inset

 is Avogadro's constant.
 The Wasatch formulation also includes a 
\begin_inset Quotes eld
\end_inset

pre-Birth coefficient
\begin_inset Quotes erd
\end_inset

 which is used as a converison factor from SI units into smaller lengths
 (
\emph on
i.e.

\emph default
 
\begin_inset Formula $\mu$
\end_inset

m or nm) used as precipitate measurements.
\end_layout

\begin_layout Subsection
Growth Models
\end_layout

\begin_layout Standard
Currently Wasatch has three growth models implemented; constant growth,
 bulk diffusion and monosurface nucleation.
 Each model uses a different form of 
\begin_inset Formula $g(r)$
\end_inset

 with 
\begin_inset Formula $g(r)=g_{0}$
\end_inset

, 
\begin_inset Formula $g(r)=g_{0}\frac{1}{r}$
\end_inset

, and 
\begin_inset Formula $g(r)=g_{0}r^{2}$
\end_inset

, respectively, as well as a different requirement for the closure of the
 moment transport equations as: none, 
\begin_inset Formula $m_{-2}$
\end_inset

 & 
\begin_inset Formula $m_{-1}$
\end_inset

, and 
\begin_inset Formula $m_{k+1}$
\end_inset

.
 The bulk diffusion model uses the appropriate coefficient as
\begin_inset Formula 
\begin{equation}
g_{0}=\nu DC_{eq}(S-\bar{S}),\;\;\; g(r)=1/r
\end{equation}

\end_inset

with 
\begin_inset Formula $D$
\end_inset

 as the diffusion coefficient, 
\begin_inset Formula $C_{eq}$
\end_inset

 as the equilibirum concentration and where 
\begin_inset Formula $\bar{S}$
\end_inset

 can either be set as one, or set as needed for Ostwald ripening as 
\begin_inset Formula 
\begin{equation}
\bar{S}=\exp(2\nu\gamma/RTr)
\end{equation}

\end_inset

For Ostwald ripening, the 
\begin_inset Formula $r$
\end_inset

 appearing in the exponential does not allow for this term to be converted
 into a moment of the problem, therefore the quadrature weights and abscissae
 are used to evaluate the Ostwald ripening term.
 A similar model is also available for bulk diffusion growth on cylindrical
 particles as
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
g_{0}=\frac{7\nu DC_{\text{{eq}}}(\bar{{S}}-S)}{6\log(1/2)},\;\;\; g(r)=1/r
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
For monosurface nucleation the growth coefficient is 
\begin_inset Formula 
\begin{equation}
g_{0}=\beta_{A}Dd^{3}exp(-\Delta G/K_{B}T),\;\;\; g(r)=r^{2}
\end{equation}

\end_inset

with 
\begin_inset Formula 
\begin{equation}
\Delta G=\frac{\beta_{L}\gamma^{2}d^{2}}{4\beta_{A}K_{B}T\log(S)},
\end{equation}

\end_inset

where 
\begin_inset Formula $\beta_{L}$
\end_inset

 and 
\begin_inset Formula $\beta_{A}$
\end_inset

 are shape factors, and 
\begin_inset Formula $d$
\end_inset

 is the molecular diameter.
 As with the birth models, a 
\begin_inset Quotes eld
\end_inset

pre-Growth coeffcient
\begin_inset Quotes erd
\end_inset

 can be used for unit conversions.
 A kintically limted model can be used that has no size dependence of the
 particles, this is essentially the constant model with supersaturation
 dependence.
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
g_{0}=K_{A}(S-\bar{S}),\;\;\; g(r)=1
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
Here 
\begin_inset Formula $K_{A}$
\end_inset

 is a kinetic growth coefficient to be determined from fitting experimental
 data.
\end_layout

\begin_layout Subsection
Aggregation Models
\end_layout

\begin_layout Standard
To account for aggregation in particulate systems, two terms must be considered
 the death kernel from two particles combining alogn with the birth kernel
 from the new particle.
 The general form for each of these is in volume formulation 
\begin_inset Formula 
\begin{equation}
\frac{1}{2}\int_{0}^{v}\beta(v-\epsilon,\epsilon)n'(v-\epsilon;t)n'(\epsilon;t)d\epsilon
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
-n'(v;t)\int_{0}^{\infty}\beta'(v,\epsilon)n'(\epsilon;t)d\epsilon
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
Converting the population balance into a radius formulation, and applying
 a moment transform, using quadrature on the integrals yields 
\begin_inset Formula 
\begin{equation}
\frac{1}{2}\sum_{i}w_{i}\sum_{j}w_{j}(r_{i}^{3}+r_{j}^{3})^{k/3}\beta_{ij}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
-\sum_{i}r_{i}^{k}w_{i}\sum\beta_{ij}w_{j}
\end{equation}

\end_inset

where 
\begin_inset Formula $\beta_{ij}$
\end_inset

 is a specified frequency kernel, and 
\begin_inset Formula $r_{i}$
\end_inset

 & 
\begin_inset Formula $w_{i}$
\end_inset

 are the abscissae and weights.
 The Wasatch formulation spilts the frequency term into two, the size dependent
 frequncy and the fluid property frequency.
 The fluid property frequency can then be factored outside of the summation.
 For aggregation due to Brownian motion
\begin_inset Formula 
\begin{equation}
\beta_{ij}=\frac{2k_{B}T}{3\rho}\times\frac{(r_{i}+r_{j})^{2}}{r_{i}r_{j}},
\end{equation}

\end_inset

where 
\begin_inset Formula $k_{B}$
\end_inset

 is the Boltzmann cosntant, 
\begin_inset Formula $T$
\end_inset

 is the temperature, and 
\begin_inset Formula $\rho$
\end_inset

 is the fluid density.
 For aggregation due to turbulent shear forces the frequency kernel is
\begin_inset Formula 
\begin{equation}
\beta_{ij}=\frac{4}{3}\left(\frac{3\pi}{10}\right)^{1/2}\left(\frac{\epsilon}{\nu}\right)^{1/2}\times\left(r_{i}+r_{j}^{3}\right),
\end{equation}

\end_inset

where 
\begin_inset Formula $\epsilon$
\end_inset

 is the energy dissipation and 
\begin_inset Formula $\nu$
\end_inset

 is the kinematic viscosity of the fluid.
 In addition a simple constant frequency is included, 
\begin_inset Formula $B_{ij}=1$
\end_inset

.
\end_layout

\begin_layout Subsection
Multi Environment Mixing Model
\end_layout

\begin_layout Standard
Wasatch has a subgrid scale model for mixing for the precipitation flows.
 Since the source terms of the moment transport equations are highly dependent
 on the current value of the moments, which are solved on the slow scale,
 a tabulation of data for use in a continuous PDF (i.e.
 such as a flamelet) is not a viable option.
 Instead a discrete PDF is used consisting of three delta functions, one
 at mixture fraction 
\begin_inset Formula $z=0$
\end_inset

, one at mixture fraction 
\begin_inset Formula $z=1$
\end_inset

, and the third at the average mixture fraction.
 In precipitation flows, no reaction occurs at either mixture fraction 0
 or 1, so only the source terms from the central delta function need to
 be solved.
\end_layout

\begin_layout Standard
Wasatch requires the averaged mixture fraction and the scalar variance to
 be solved on the grid.
 Then the weights of the three delta functions are calculated as 
\begin_inset Formula 
\begin{eqnarray}
w_{1} & = & \frac{\left\langle z'^{2}\right\rangle }{\left\langle z\right\rangle },\\
w_{2} & = & \frac{\left\langle z'^{2}\right\rangle -\left\langle z\right\rangle +\left\langle z\right\rangle ^{2}}{\left\langle z\right\rangle ^{2}-\left\langle z\right\rangle },\\
w_{3} & = & \frac{-\left\langle z'^{2}\right\rangle }{\left\langle z\right\rangle -1},
\end{eqnarray}

\end_inset

where 
\begin_inset Formula $\left\langle z\right\rangle $
\end_inset

 is the average mixture fraction, and 
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none

\begin_inset Formula $\left\langle z'^{2}\right\rangle $
\end_inset

 is the scalar variance.
\end_layout

\begin_layout Standard
When the Multi Environment Model is enabled, the moment equations are only
 solved for the second environment with the moments from environments 1
 and 3 held constant.
 The averaged moments are then post-processed based on the values of the
 environment weights.
 In addition the transport of the second environment requires a new source
 term to account for the change in the moments due to mixing
\begin_inset Formula 
\begin{equation}
S_{\phi_{\alpha,2},\; mix}=-\frac{dw_{1}/dt}{w_{2}}\left(\phi_{\alpha,1}-\phi_{\alpha,2}\right)-\frac{dw_{3}/dt}{w_{2}}\left(\phi_{\alpha,3}-\phi_{\alpha,2}\right),
\end{equation}

\end_inset

where 
\begin_inset Formula $\phi_{\alpha,i}$
\end_inset

 represents the 
\begin_inset Formula $\alpha$
\end_inset

th precipitate moment located in the 
\begin_inset Formula $i$
\end_inset

th mixing environment.
 With the time derivatives of the weights of the mixing environments calculated
 as
\begin_inset Formula 
\begin{eqnarray}
\frac{dw_{1}}{dt} & = & \frac{-\left\langle \epsilon_{\phi}\right\rangle }{\left\langle z\right\rangle },\\
\frac{dw_{3}}{dt} & = & \frac{-\left\langle \epsilon_{\phi}\right\rangle }{1-\left\langle z\right\rangle },
\end{eqnarray}

\end_inset

where 
\begin_inset Formula $\left\langle \epsilon_{\phi}\right\rangle $
\end_inset

 is the scalar dissipation rate.
\end_layout

\begin_layout Subsection
Viscosity Model
\end_layout

\begin_layout Standard
Wasatch has one model to account for the viscosity change of the fluid as
 particles precipitate.
 The two parameters dictating the viscosity are the volume fraction of particles
 and the strain tensor magnitude.
 The volume fraction is calculated as
\begin_inset Formula 
\begin{equation}
\phi=\sum_{i}^{n}\frac{4\pi}{3}\left(\frac{m_{1,i}}{m_{0,i}}\right)^{3}m_{0,i},
\end{equation}

\end_inset

where 
\begin_inset Formula $m_{1,i}$
\end_inset

 and 
\begin_inset Formula $m_{0,i}$
\end_inset

 are the first and zeroth moments of the 
\begin_inset Formula $i$
\end_inset

th polymorph phase.
 In flows with low volume fractions of particles the relative viscosity
 can be solved for using kinetic theory with ideal assumptions as
\begin_inset Formula 
\begin{equation}
\mu_{r}=\frac{\mu}{\mu_{0}}=1+2.5\lambda\phi,
\end{equation}

\end_inset

with 
\begin_inset Formula $\lambda$
\end_inset

 as a correction factor for non-idealities.
 In some case particle flows will have a shear thinning phenomena in which
 case the viscosity can be expressed as a power law with relation to the
 strain rate.
 The model used by Wasatch combines this with the linear fit of the kinetic
 theory assumptions so that
\begin_inset Formula 
\begin{equation}
\mu_{r}=(1+2.5\lambda\phi)\left|S\right|^{n},
\end{equation}

\end_inset

where 
\begin_inset Formula $\left|S\right|$
\end_inset

 is the strain tensor magnitude.
 The parameters 
\begin_inset Formula $n$
\end_inset

 and 
\begin_inset Formula $\lambda$
\end_inset

 should then be fit to experimental data.
 If no shear thinning is expected, 
\begin_inset Formula $n$
\end_inset

 can be set as 
\begin_inset Formula $0$
\end_inset

.
 This formulation should only be used for low volume fractions of particles.
\end_layout

\begin_layout Chapter
Verification and Benchmark Studies
\end_layout

\begin_layout Section
Constant Density Lid-Driven-Cavity
\end_layout

\begin_layout Standard
\begin_inset Float figure
placement !b
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename figures/pdf/wasatch_verification_cavity_geometry.pdf

\end_inset


\begin_inset Caption

\begin_layout Plain Layout
Lid-Driven-Cavity geometry.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
This case aims at verifying the results obtained by the Wasatch pressure
 projection method with wall boundary conditions.
 Although experimental data is scarcely available for this test case, there
 are several numerical studies on the lid-driven-cavity that one may employ
 for comparison purposes.
 Our choice falls on the study by 
\begin_inset CommandInset citation
LatexCommand citet
key "ghia_lid_driven_cavity_1982"

\end_inset

 which presents a comprehensive review of data in the literature as well
 as a reliable benchmark for comparison purposes.
 Here, we reproduce all the cases discussed in their study.
\end_layout

\begin_layout Subsection
Problem Description
\end_layout

\begin_layout Standard
Consider a 
\begin_inset Formula $1\mathrm{m}\mathrm{x}1\mathrm{m}$
\end_inset

 square cavity that is filled with a fluid with the top lid moving at a
 constant speed.
 We choose water at 293 K as our working fluid.
 The domain is discretized into 
\begin_inset Formula $N_{x}=N_{y}=128$
\end_inset

 equally spaced control volumes (Note that in Uintah, we must specify a
 nonzero dimension in the orthogonal direction to the cavity's plane.
 here, we set 
\begin_inset Formula $L_{z}=1\mathrm{m}$
\end_inset

 and 
\begin_inset Formula $N_{z}=2$
\end_inset

 with periodic conditions in the 
\begin_inset Formula $z$
\end_inset

-direction.
 We also only solve the momentum equations in the plane of the driven cavity).
\end_layout

\begin_layout Standard
We test seven cases with different Reynolds number.
 The Reynolds number for the cavity is defined as 
\begin_inset Formula $\text{Re}=\frac{\rho U_{\text{wall}}L}{\mu}$
\end_inset

 where 
\begin_inset Formula $\rho$
\end_inset

 is the density of the fluid (in this case, water @ 293 K), 
\begin_inset Formula $U_{\text{wall}}$
\end_inset

 is the velocity of the lid, 
\begin_inset Formula $L$
\end_inset

 is the width of the lid, and 
\begin_inset Formula $\mu$
\end_inset

 is the dynamic viscosity.
 The Reynolds numbers range is given by Re = {100, 400, 1000, 3200, 5000,
 7500, 10000} as dictated by the reference data.
 The boundary conditions on all walls are set to no-slip and no-permeability
 conditions (
\begin_inset Formula $\rho\mathbf{u}=\mathbf{0}$
\end_inset

) except on the moving lid where the tangential momentum is set to reproduce
 
\begin_inset Formula $U_{\text{wall}}$
\end_inset

 that corresponds to the desired Reynolds number while the normal velocity
 is set to zero.
 A summary of these conditions is given in Table
\end_layout

\begin_layout Standard
\begin_inset Float table
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
Summary of parameters used for the various cases.
 
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="8" columns="4">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0">
<column alignment="center" valignment="top" width="0">
<column alignment="center" valignment="top" width="0">
<column alignment="center" valignment="top" width="0">
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Re
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\rho U_{\text{wall}}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\Delta t$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
CFL
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
100
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.1002
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.75
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.0096
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
400
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.4008
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.75
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.0385
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
1000
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.002
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.75
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.0963
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
3200
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
3.2064
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.75
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.3083
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
5000
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
5.01
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.5
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.3212
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
7500
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
7.515
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.25
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.2409
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
10000
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
10.02
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.125
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.1606
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard

\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Graphics
	filename figures/pdf/wasatch_verification_cavity_x_velocity_Re100.pdf

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
Normalized 
\begin_inset Formula $u$
\end_inset

-velocity component.
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Graphics
	filename figures/pdf/wasatch_verification_cavity_y_velocity_Re100.pdf

\end_inset


\begin_inset Caption

\begin_layout Plain Layout
Normalized 
\begin_inset Formula $y$
\end_inset

-velocity component.
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\begin_inset Caption

\begin_layout Plain Layout
Comparison of Wasatch results with those presented in 
\begin_inset CommandInset citation
LatexCommand citet
key "ghia_lid_driven_cavity_1982"

\end_inset

 for Re = 100.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Graphics
	filename figures/pdf/wasatch_verification_cavity_x_velocity_Re400.pdf

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
Normalized 
\begin_inset Formula $u$
\end_inset

-velocity component.
\end_layout

\end_inset


\end_layout

\end_inset


\begin_inset Float figure
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\begin_inset Graphics
	filename figures/pdf/wasatch_verification_cavity_y_velocity_Re400.pdf

\end_inset


\begin_inset Caption

\begin_layout Plain Layout
Normalized 
\begin_inset Formula $y$
\end_inset

-velocity component.
\end_layout

\end_inset


\end_layout

\end_inset


\begin_inset Caption

\begin_layout Plain Layout
Comparison of Wasatch results with those presented in 
\begin_inset CommandInset citation
LatexCommand citet
key "ghia_lid_driven_cavity_1982"

\end_inset

 for Re = 400.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Graphics
	filename figures/pdf/wasatch_verification_cavity_x_velocity_Re1000.pdf

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
Normalized 
\begin_inset Formula $u$
\end_inset

-velocity component.
\end_layout

\end_inset


\end_layout

\end_inset


\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Graphics
	filename figures/pdf/wasatch_verification_cavity_y_velocity_Re1000.pdf

\end_inset


\begin_inset Caption

\begin_layout Plain Layout
Normalized 
\begin_inset Formula $y$
\end_inset

-velocity component.
\end_layout

\end_inset


\end_layout

\end_inset


\begin_inset Caption

\begin_layout Plain Layout
Comparison of Wasatch results with those presented in 
\begin_inset CommandInset citation
LatexCommand citet
key "ghia_lid_driven_cavity_1982"

\end_inset

 for Re = 1000.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Graphics
	filename figures/pdf/wasatch_verification_cavity_x_velocity_Re3200.pdf

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
Normalized 
\begin_inset Formula $u$
\end_inset

-velocity component.
\end_layout

\end_inset


\end_layout

\end_inset


\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Graphics
	filename figures/pdf/wasatch_verification_cavity_y_velocity_Re3200.pdf

\end_inset


\begin_inset Caption

\begin_layout Plain Layout
Normalized 
\begin_inset Formula $y$
\end_inset

-velocity component.
\end_layout

\end_inset


\end_layout

\end_inset


\begin_inset Caption

\begin_layout Plain Layout
Comparison of Wasatch results with those presented in 
\begin_inset CommandInset citation
LatexCommand citet
key "ghia_lid_driven_cavity_1982"

\end_inset

 for Re = 3200.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Section
Taylor Flow in a Channel
\end_layout

\begin_layout Standard
The Taylor flow in a channel describes the steady inviscid state of a fluid
 in a channel with permeable sidewalls.
 This is a great case for testing inlet and outflow boundary conditions.
\end_layout

\begin_layout Section
Decay of Isotropic Turbulence
\end_layout

\begin_layout Standard
This classic verification case provides a somewhat reasonable benchmark
 to verify the sanity of our turbulence model implementations.
 It consists of an initial isotropic velocity field in a periodic box that
 is allowed to decay over time.
 The initial condition is made to fit an experimentally-measured energy
 spectrum.
 The code is then allowed to calculate the decay of this initial field,
 whose energy spectrum is measured at subsequent times and compared with
 experimental measurements.
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Graphics
	filename figures/raster/wasatch-decay_isotropic_turbulence_csmag_64-t0s.png
	width 3.13in

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
\begin_inset Formula $t=0$
\end_inset

 s
\end_layout

\end_inset


\end_layout

\end_inset


\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Graphics
	filename figures/raster/wasatch-decay_isotropic_turbulence_csmag_64-t0.67s.png
	width 3.13in

\end_inset


\begin_inset Caption

\begin_layout Plain Layout
\begin_inset Formula $t=0.67$
\end_inset

 s
\end_layout

\end_inset


\end_layout

\end_inset


\begin_inset Caption

\begin_layout Plain Layout
Contours of velocity magnitude for the decay of isotropic turbulence in
 a periodic box.
 Results are shown using the Smagorinsky-Lilly model at (a) 
\begin_inset Formula $t=0$
\end_inset

 s and (b) 
\begin_inset Formula $t=0.67$
\end_inset

 s.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Graphics
	filename figures/pdf/wasatch-tke_csmag_32_spectrum.pdf
	width 3.13in

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\end_inset


\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Graphics
	filename figures/pdf/wasatch-tke_csmag_64_spectrum.pdf
	width 3.13in

\end_inset


\begin_inset Caption

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\end_inset


\begin_inset Caption

\begin_layout Plain Layout
Turbulent kinetic energy spectrum for the constant Smagorinsky model with
 
\begin_inset Formula $C_{\mathrm{s}}=0.2$
\end_inset

 and for grid sizes (a) 32x32x32, and (b) 64x64x64.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Graphics
	filename figures/pdf/wasatch-tke_wale_32_spectrum.pdf
	width 3.13in

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\end_inset


\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Graphics
	filename figures/pdf/wasatch-tke_wale_64_spectrum.pdf
	width 3.13in

\end_inset


\begin_inset Caption

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\end_inset


\begin_inset Caption

\begin_layout Plain Layout
Turbulent kinetic energy spectrum for the WALE model with 
\begin_inset Formula $C_{\mathrm{w}}=0.7$
\end_inset

 and for grid sizes (a) 32x32x32, and (b) 64x64x64.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Graphics
	filename figures/pdf/wasatch-tke_vreman_32_spectrum.pdf
	width 3.13in

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\end_inset


\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Graphics
	filename figures/pdf/wasatch-tke_vreman_64_spectrum.pdf
	width 3.13in

\end_inset


\begin_inset Caption

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\end_inset


\begin_inset Caption

\begin_layout Plain Layout
Turbulent kinetic energy spectrum for the Vreman model with 
\begin_inset Formula $C_{\mathrm{s}}=0.2$
\end_inset

 (or 
\begin_inset Formula $C_{\mathrm{v}}=2.5C_{\mathrm{s}}^{2}=0.1$
\end_inset

) and for grid sizes (a) 32x32x32, and (b) 64x64x64.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Graphics
	filename figures/pdf/wasatch-tke_dsmag_32_spectrum.pdf
	width 3.13in

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\end_inset


\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Graphics
	filename figures/pdf/wasatch-tke_dsmag_64_spectrum.pdf
	width 3.13in

\end_inset


\begin_inset Caption

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\end_inset


\begin_inset Caption

\begin_layout Plain Layout
Turbulent kinetic energy spectrum for the dynamic Smagorinsky model for
 grid sizes (a) 32x32x32, and (b) 64x64x64.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Chapter
Summary of Supported Expressions
\end_layout

\begin_layout Section
Field Expressions
\end_layout

\begin_layout Section*
Constant
\end_layout

\begin_layout Standard
The 
\begin_inset listings
inline true
status open

\begin_layout Plain Layout

Constant
\end_layout

\end_inset

 expression is the most elemental type of expression used in Wasatch.
 As the name designates, this expression creates a constant field for any
 quantity.
 For example, 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
prettyref{lst:wasatch-const-expr}
\end_layout

\end_inset

 shows the input specification for a constant expression that initializes
 a field 
\begin_inset Formula $\phi$
\end_inset

 to 
\begin_inset Formula $1.0$
\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset CommandInset include
LatexCommand lstinputlisting
filename "listings/Constant-example.xml"
lstparams "caption={Specification of a Constant expression.},label={lst:wasatch-const-expr}"

\end_inset


\end_layout

\begin_layout Section*
ExprAlgebra
\end_layout

\begin_layout Standard
The 
\begin_inset listings
inline true
status open

\begin_layout Plain Layout

ExprAlgebra
\end_layout

\end_inset

 expression provides a simple and intuitive mechanism to add, subtract,
 or multiply an arbitrary number of source expressions.
 As an example, consider initializing a scalar variable 
\begin_inset Formula $\phi$
\end_inset

 as
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\phi=x+y+z
\end{equation}

\end_inset

This may be easily accomplished by The 
\begin_inset listings
inline true
status open

\begin_layout Plain Layout

ExprAlgebra
\end_layout

\end_inset

 expression.
 The input specification is shown in 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
prettyref{lst:wasatch-expr-algebra}
\end_layout

\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset CommandInset include
LatexCommand lstinputlisting
filename "listings/ExprAlgebra-example.xml"
lstparams "caption={Specification of an ExprAlgebra expression as the sum of three other expressions.},label={lst:wasatch-expr-algebra}"

\end_inset


\end_layout

\begin_layout Standard
It is possible to construct highly complicated expressions with 
\begin_inset listings
inline true
status open

\begin_layout Plain Layout

ExprAlgebra
\end_layout

\end_inset

 by combining different 
\begin_inset listings
inline true
status open

\begin_layout Plain Layout

ExprAlgebra
\end_layout

\end_inset

 expressions.
 This, however, is highly costly from the point of view of graph granularity
 and scheduling.
 It is highly desirable that dedicated expressions be written that accomplish
 specific purposes.
 However, 
\begin_inset listings
inline true
status open

\begin_layout Plain Layout

ExprAlgebra
\end_layout

\end_inset

 remains a very useful expression for constructing complex initial conditions
 where the cost invested at initialization is shadowed by the time advance
 solution.
\end_layout

\begin_layout Section*
LinearFunction
\end_layout

\begin_layout Standard
The 
\begin_inset listings
inline true
status open

\begin_layout Plain Layout

LinearFunction
\end_layout

\end_inset

 expression applies a linear transformation to any field of your choice
 according to 
\begin_inset Formula 
\begin{equation}
\psi=a\phi+b,
\end{equation}

\end_inset

where 
\begin_inset Formula $\psi$
\end_inset

 is the destination field, 
\begin_inset Formula $\phi$
\end_inset

 is the source field, 
\begin_inset Formula $a$
\end_inset

 is the slope, and 
\begin_inset Formula $b$
\end_inset

 is the intercept.
 Below is an example of using the LinearFunction expression to initialize
 a scalar field 
\begin_inset Formula $\phi$
\end_inset

 as a linear function of the the coordinate 
\begin_inset Formula $x$
\end_inset

 as 
\begin_inset Formula $\phi=0.1x+1.25$
\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset CommandInset include
LatexCommand lstinputlisting
filename "listings/LinearFunction-example.xml"
lstparams "caption={Specification of a LinearFunction as an initial condition for a scalar field $\\phi$.},label={lst:wasatch-linear-function}"

\end_inset


\end_layout

\begin_layout Section*
ParabolicFunction
\end_layout

\begin_layout Standard
As the name implies, the 
\begin_inset listings
inline true
status open

\begin_layout Plain Layout

ParabolicFunction
\end_layout

\end_inset

 expression generates a field of the form
\begin_inset Formula 
\begin{equation}
\phi=ax^{2}+bx+c.
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
The following listing shows how to initialize a field with a 
\begin_inset listings
inline true
status open

\begin_layout Plain Layout

ParabolicFunction
\end_layout

\end_inset

 as 
\begin_inset Formula $\phi=0.1x^{2}+1.25x+0.3$
\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset CommandInset include
LatexCommand lstinputlisting
filename "listings/LinearFunction-example.xml"
lstparams "caption={Specification of a ParabolicFunction as an initial condition for a scalar field $\\phi$.},label={lst:wasatch-parabolic-function}"

\end_inset


\end_layout

\begin_layout Section*
SineFunction
\end_layout

\begin_layout Standard
As the name implies, the 
\begin_inset listings
inline true
status open

\begin_layout Plain Layout

SineFunction
\end_layout

\end_inset

 expression generates a field of the form
\begin_inset Formula 
\begin{equation}
\phi=A\sin(\omega x)+\psi.
\end{equation}

\end_inset

where 
\begin_inset Formula $A$
\end_inset

 is the amplitude, 
\begin_inset Formula $\omega$
\end_inset

 is the frequency, and 
\begin_inset Formula $\psi$
\end_inset

 is the offset.
 The specification of a 
\begin_inset listings
inline true
status open

\begin_layout Plain Layout

SineFunction
\end_layout

\end_inset

 takes three attributes and the nametag of an independent variable (e.g.
 
\begin_inset Formula $x$
\end_inset

).
 The following listing shows how to initialize a field with a 
\begin_inset listings
inline true
status open

\begin_layout Plain Layout

SineFunction
\end_layout

\end_inset

 as 
\begin_inset Formula $f=2\sin(10x)+3$
\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset CommandInset include
LatexCommand lstinputlisting
filename "listings/SineFunction-example.xml"
lstparams "caption={Specification of a SineFunction as an initial condition for a scalar field $f$.},label={lst:wasatch-sinefunction-example}"

\end_inset


\end_layout

\begin_layout Section*
GaussianFunction
\end_layout

\begin_layout Standard
Generates a field of the form
\begin_inset Formula 
\begin{equation}
f(x)=y_{0}+a\exp\left[\frac{\left(x-\mu\right)^{2}}{2\sigma^{2}}\right]
\end{equation}

\end_inset

where 
\begin_inset Formula $a$
\end_inset

 is the amplitude, 
\begin_inset Formula $\mu$
\end_inset

 is the mean, and 
\begin_inset Formula $\sigma$
\end_inset

 is the deviation, and 
\begin_inset Formula $y_{0}$
\end_inset

 is the baseline.
 The specification of a 
\begin_inset listings
inline true
status open

\begin_layout Plain Layout

GaussianFunction
\end_layout

\end_inset

 takes four attributes and the nametag of an independent variable (e.g.
 
\begin_inset Formula $x$
\end_inset

).
 The following listing shows how to initialize a field with a 
\begin_inset listings
inline true
status open

\begin_layout Plain Layout

GaussianFunction
\end_layout

\end_inset

 as 
\begin_inset Formula $f=1+20\exp\left[\frac{\left(x-5\right)^{2}}{8}\right]$
\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset CommandInset include
LatexCommand lstinputlisting
filename "listings/GaussianFunction-example.xml"
lstparams "caption={Specification of a GaussianFunction as an initial condition for a scalar field $f$.},label={lst:wasatch-gaussianfunction-example}"

\end_inset


\end_layout

\begin_layout Section*
DoubleTanhFunction
\end_layout

\begin_layout Standard
Generates a field of the form
\begin_inset Formula 
\begin{equation}
f(x)=\frac{A}{2}\left(1+\tanh\left(\frac{x-L_{1}}{w}\right)\right)\left(1-\frac{1}{2}\tanh\left(\frac{x-L_{2}}{w}\right)\right)
\end{equation}

\end_inset

where 
\begin_inset Formula $w$
\end_inset

 is the width of the transition, 
\begin_inset Formula $A$
\end_inset

 is the amplitude of the transition, 
\begin_inset Formula $L_{1}$
\end_inset

 is the midpoint for the upward transition, and 
\begin_inset Formula $L_{2}$
\end_inset

 is the midpoint for the downward transition.
 The following listing shows how to initialize a field with a 
\begin_inset listings
inline true
status open

\begin_layout Plain Layout

DoubleTanhFunction
\end_layout

\end_inset

 as 
\begin_inset Formula $f(x)=5\left(1+\tanh\left(\frac{x-1}{4}\right)\right)\left(1-\frac{1}{2}\tanh\left(\frac{x-2}{4}\right)\right)$
\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset CommandInset include
LatexCommand lstinputlisting
filename "listings/DoubleTanhFunction-example.xml"
lstparams "caption={Specification of a DoubleTanhFunction as an initial condition for a scalar field $f$.},label={lst:wasatch-doubletanhfunction-example}"

\end_inset


\end_layout

\begin_layout Section*
StepFunction
\end_layout

\begin_layout Standard
Generates a Heaviside step function of the form
\begin_inset Formula 
\begin{equation}
f(x)=\begin{cases}
l & x<x_{0}\\
g & x\geq x_{0}
\end{cases}
\end{equation}

\end_inset

where 
\begin_inset Formula $x_{0}$
\end_inset

 is the transition point, 
\begin_inset Formula $l$
\end_inset

 is referred to as the low value and denotes the value of 
\begin_inset Formula $f$
\end_inset

 below the transition point, and 
\begin_inset Formula $g$
\end_inset

 is referred to as the high value and denotes the value of 
\begin_inset Formula $f$
\end_inset

 above the transition point.
 The following listing shows how to initialize a field with a 
\begin_inset listings
inline true
status open

\begin_layout Plain Layout

StepFunction
\end_layout

\end_inset

 as 
\begin_inset Formula $f(x)=\begin{cases}
2 & x<0.1\\
1 & x\geq0.1
\end{cases}$
\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset CommandInset include
LatexCommand lstinputlisting
filename "listings/StepFunction-example.xml"
lstparams "caption={Specification of a StepFunction as an initial condition for a scalar field $f$.},label={lst:wasatch-stepfunction-example}"

\end_inset


\end_layout

\begin_layout Section*
ReadFromFile
\end_layout

\begin_layout Standard
Creates an expression that reads data from a file.
 The file is formatted as 
\begin_inset Quotes eld
\end_inset

x y z value
\begin_inset Quotes erd
\end_inset

 ASCII and then zipped.
 A sample file is found in the Wasatch inputs directory.
 The specification is shown below.
\begin_inset CommandInset include
LatexCommand lstinputlisting
filename "listings/ReadFromFile-example.xml"
lstparams "caption={ReadFromFile specification as an initial condition for a scalar field $f$.},label={lst:wasatch-readfromfile-example}"

\end_inset


\end_layout

\begin_layout Section*
ExponentialVortex
\end_layout

\begin_layout Standard
This expression implements a rotating vortex in a uniform stream.
 The corresponding streamfunction is given by the superposition of an exponentia
l vortex and a uniform flow and is given by
\begin_inset Formula 
\begin{equation}
\psi=\Gamma\exp\left(-\frac{r^{2}}{2R^{2}}\right)-Vx+Uy,
\end{equation}

\end_inset

where 
\begin_inset Formula $\Gamma$
\end_inset

 is the strength of the vortex, 
\begin_inset Formula $r=\sqrt{(x-x_{0})^{2}+(y-y_{0})^{2}}$
\end_inset

 is the radial distance from the center of the vortex, 
\begin_inset Formula $R$
\end_inset

 is the radius of the vortex, and 
\begin_inset Formula $V$
\end_inset

 and 
\begin_inset Formula $U$
\end_inset

 are the the transverse and axial free stream velocities, respectively.
 The resulting velocity field is then calculated using the Stokes' streamfunctio
n
\begin_inset Formula 
\begin{equation}
u=\frac{\partial\psi}{\partial y}=U-\frac{\Gamma}{R^{2}}(y-y_{0})\exp\left(-\frac{r^{2}}{2R^{2}}\right)
\end{equation}

\end_inset

and
\begin_inset Formula 
\begin{equation}
v=-\frac{\partial\psi}{\partial x}=V+\frac{\Gamma}{R^{2}}(x-x_{0})\exp\left(-\frac{r^{2}}{2R^{2}}\right).
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
This expression is best used as an initialization for the momentum or velocity
 fields.
 
\end_layout

\begin_layout Standard
What follows is an example for initializating the axial and transverse momentum
 components with an exponential vortex, centered at 
\begin_inset Formula $[0.5,0.5]$
\end_inset

 with a strength of 
\begin_inset Formula $10^{-3}$
\end_inset

, a radius of 
\begin_inset Formula $R_{0}=0.1$
\end_inset

, and a free stream velocity 
\begin_inset Formula $U_{0}=1$
\end_inset

.
 Note that you must specify both velocity or momentum components to recover
 physically relevant initial conditions.
 You can find the 
\begin_inset Quotes eld
\end_inset

ups
\begin_inset Quotes erd
\end_inset

 file in the Wasatch inputs directory under the name 
\begin_inset Quotes eld
\end_inset

exponential-vortex-example.ups
\begin_inset Quotes erd
\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset CommandInset include
LatexCommand lstinputlisting
filename "listings/ExponentialVortex-example-x.xml"
lstparams "caption={Specification of an ExponentialVortex as an initial condition for axial momentum.},label={lst:wasatch-exponentialvortex-xmom}"

\end_inset


\end_layout

\begin_layout Standard
\begin_inset CommandInset include
LatexCommand lstinputlisting
filename "listings/ExponentialVortex-example-y.xml"
lstparams "caption={Specification of an ExponentialVortex as an initial condition for transverse momentum.},label={lst:wasatch-exponentialvortex-ymom}"

\end_inset


\end_layout

\begin_layout Standard
The resulting flow field generated by this initialization is shown below.
\end_layout

\begin_layout Standard
\begin_inset Float figure
placement H
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Float figure
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\begin_inset Graphics
	filename figures/raster/wasatch-exponential-vortex-xmom.png
	width 2in

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
\begin_inset Formula $x$
\end_inset

-momentum
\end_layout

\end_inset


\end_layout

\end_inset


\begin_inset Float figure
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
\begin_inset Formula $y$
\end_inset

-momentum
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Graphics
	filename figures/raster/wasatch-exponential-vortex-ymom.png
	width 2in

\end_inset


\end_layout

\end_inset


\begin_inset Caption

\begin_layout Plain Layout
Momentum field resulting from ExponentialVortex initialization.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Section*
LambsDipole
\end_layout

\begin_layout Standard
Lamb's dipole is a steady-state solution to the Euler equations using a
 vorticity-streamfunction approach.
 In this approach, one specifies an explicit relation between the vorticity
 and the streamfunction.
 Lamb's dipole solution assumes that the azimuthal vorticity has a linear
 dependence on the streamfunction such that
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\omega_{z}=k^{2}\psi
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
The solution to the Euler equations in this case, in an infinite mass of
 fluid, results in the following
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\psi_{\text{dipole}}(r,\theta)=\begin{cases}
\frac{2U_{0}}{kJ_{0}(kR)}J_{1}(kr)\sin\theta & r\leq R\\
U_{0}(r-\frac{R^{2}}{r})\sin\theta & r>R
\end{cases}
\end{equation}

\end_inset

where 
\begin_inset Formula $U_{0}$
\end_inset

 is the propagation velocity of the dipole, 
\begin_inset Formula $k$
\end_inset

 is the proportionality constant relating the vorticity to the streamfunction
 and may be determined from 
\begin_inset Formula $J_{1}(kR)=0$
\end_inset

 or 
\begin_inset Formula $kR\approx3.8317$
\end_inset

, 
\begin_inset Formula $R$
\end_inset

 is the radius of the dipole, and 
\begin_inset Formula $J_{0}$
\end_inset

 and 
\begin_inset Formula $J_{1}$
\end_inset

 are the zeroth- and first-order Bessel functions of the first kind, respectivel
y.
 The dipole is finall be superimposed on a uniform stream.
\end_layout

\begin_layout Standard
To make this solution accessible to code implementation, it must be transformed
 to cartesian coordinates.
 We also wish to place the dipole at any location in the flow field.
 We first calculate the radial and tangenial velocities of 
\begin_inset Formula $\psi_{\text{dipole}}$
\end_inset

.
 These are given by the polar streamfunction relations
\end_layout

\begin_layout Standard

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
\begin_inset Formula 
\begin{equation}
u_{r}=\frac{1}{r}\frac{\partial\psi}{\partial\theta};\quad u_{\theta}=-\frac{\partial\psi}{\partial r}
\end{equation}

\end_inset


\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\uuline default
\uwave default
\noun default
\color inherit
These calculations return
\end_layout

\begin_layout Standard

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
\begin_inset Formula 
\begin{equation}
u_{r,\text{dipole}}=\begin{cases}
\frac{2U_{0}}{kJ_{0}(kR)}J_{1}(kr)\cos\theta & r\leq R\\
U_{0}(1-\frac{R^{2}}{r^{2}})\cos\theta & r>R
\end{cases}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
\begin_inset Formula 
\begin{equation}
u_{\theta,\text{dipole}}=\begin{cases}
-U_{0}\sin\theta+\frac{U_{0}}{J_{0}(kR)}J_{2}(kr)\sin\theta & r\leq R\\
-U_{0}(1+\frac{R^{2}}{r^{2}})\cos\theta & r>R
\end{cases}
\end{equation}

\end_inset


\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\uuline default
\uwave default
\noun default
\color inherit
Finally, the axial and transverse velocities are constructed by setting
\end_layout

\begin_layout Standard

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
\begin_inset Formula 
\begin{equation}
u_{x,\text{dipole}}=u_{r,\text{dipole}}\cos\theta-u_{\theta,\text{dipole}}\sin\theta
\end{equation}

\end_inset


\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\uuline default
\uwave default
\noun default
\color inherit
and
\end_layout

\begin_layout Standard

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
\begin_inset Formula 
\begin{equation}
u_{y,\text{dipole}}=u_{r,\text{dipole}}\sin\theta+u_{\theta,\text{dipole}}\cos\theta
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
By subsituting 
\begin_inset Formula $\theta=\tan^{-1}(\frac{y}{x})$
\end_inset

 or using 
\begin_inset Formula $\cos\theta=\frac{x}{r}$
\end_inset

 and 
\begin_inset Formula $\sin\theta=\frac{y}{r}$
\end_inset

, we recover
\end_layout

\begin_layout Standard

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
\begin_inset Formula 
\begin{equation}
u_{x,\text{dipole}}=\begin{cases}
\frac{2U_{0}}{kJ_{0}(kR)r^{3}}[kry^{2}J_{0}(kr)+(x^{2}-y^{2})J_{1}(kr)] & r\leq R\\
U_{0}+\frac{U_{0}R^{2}}{r^{4}}(r^{2}-2x^{2}) & r>R
\end{cases};\quad r=\sqrt{x^{2}+y^{2}}
\end{equation}

\end_inset


\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\uuline default
\uwave default
\noun default
\color inherit
and
\end_layout

\begin_layout Standard

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
\begin_inset Formula 
\begin{equation}
u_{y,\text{dipole}}=\begin{cases}
\frac{2U_{0}}{J_{0}(kR)r^{2}}J_{2}(kr) & r\leq R\\
-\frac{2U_{0}R^{2}}{r^{4}}xy & r>R
\end{cases};\quad r=\sqrt{x^{2}+y^{2}}
\end{equation}

\end_inset


\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\uuline default
\uwave default
\noun default
\color inherit
Finally, the total flowfield with a uniform flow given by 
\begin_inset Formula $U$
\end_inset

 in the 
\begin_inset Formula $x$
\end_inset

-direction is computed as
\end_layout

\begin_layout Standard

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
\begin_inset Formula 
\begin{equation}
u_{x}=U+u_{x,\text{dipole}}
\end{equation}

\end_inset


\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\uuline default
\uwave default
\noun default
\color inherit
and
\end_layout

\begin_layout Standard

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
\begin_inset Formula 
\begin{equation}
u_{y}=u_{y,\text{dipole}}
\end{equation}

\end_inset


\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\uuline default
\uwave default
\noun default
\color inherit
To place the dipole at a random point 
\begin_inset Formula $(x_{0},y_{0})$
\end_inset

, we simply perform the following substitutions in the above equations
\end_layout

\begin_layout Standard

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
\begin_inset Formula 
\begin{equation}
x\to x-x_{0};\quad y\to y-y_{0};\quad r\to\sqrt{(x-x_{0})^{2}+(y-y_{0})^{2}}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
What follows is an example for initializating the axial and transverse momentum
 components with a Lamb-dipole vortex, centered at 
\begin_inset Formula $[0.0,0.0]$
\end_inset

 with a propagation velocity of 
\begin_inset Formula $U_{0}=0.9$
\end_inset

, a radius of 
\begin_inset Formula $R_{0}=0.1$
\end_inset

, and a free stream velocity 
\begin_inset Formula $U=0.1$
\end_inset

.
 Note that you must specify both velocity or momentum components to recover
 physically relevant initial conditions.
 You can find the 
\begin_inset Quotes eld
\end_inset

ups
\begin_inset Quotes erd
\end_inset

 file in the Wasatch inputs directory under the name 
\begin_inset Quotes eld
\end_inset

dipole-vortex-example.ups
\begin_inset Quotes erd
\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset CommandInset include
LatexCommand lstinputlisting
filename "listings/LambsDipole-example-x.xml"
lstparams "caption={Specification of a LambsDipole expression as an initial condition for axial momentum.},label={lst:wasatch-lambsdipole-xmom}"

\end_inset


\end_layout

\begin_layout Standard
\begin_inset CommandInset include
LatexCommand lstinputlisting
filename "listings/LambsDipole-example-y.xml"
lstparams "caption={Specification of a LambsDipole expression as an initial condition for transverse momentum.},label={lst:wasatch-lambsdipole-ymom}"

\end_inset


\end_layout

\begin_layout Standard
The resulting flow field generated by this initialization is shown below.
\end_layout

\begin_layout Standard
\begin_inset Float figure
placement H
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\align center
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Graphics
	filename figures/raster/wasatch-lambs-dipole-xmom.png
	width 2in

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
\begin_inset Formula $x$
\end_inset

-momentum
\end_layout

\end_inset


\end_layout

\end_inset


\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
\begin_inset Formula $y$
\end_inset

-momentum
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Graphics
	filename figures/raster/wasatch-lambs-dipole-ymom.png
	width 2in

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\align center
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Graphics
	filename figures/raster/wasatch-lambs-dipole-vorticity-with-vectors.png
	width 2in

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
vorticity field wih vectors
\end_layout

\end_inset


\end_layout

\end_inset


\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
vorticity field with streamlines
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Graphics
	filename figures/raster/wasatch-lambs-dipole-vorticity-streamlines.png
	width 2in

\end_inset


\end_layout

\end_inset


\begin_inset Caption

\begin_layout Plain Layout
Momentum and vorticity fields resulting from LambsDipole initialization.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Section*
Reduction
\end_layout

\begin_layout Standard
The Reduction expression provides a means for specifying MPI-Reduction operation
s on Wasatch expressions.
 The Reduction expression consumes a field by applying a certain reduction
 operation (i.e.
 min) and returns a single value that is the same across all patches.
 Reduction variables can be driven through the input file with the following
 spec
\end_layout

\begin_layout Standard
\begin_inset CommandInset include
LatexCommand lstinputlisting
filename "listings/Reduction-spec.xml"
lstparams "caption={XML specification for a Reduction expression},label={lst:wasatch-reduction-spec}"

\end_inset

The comments in 
\begin_inset CommandInset ref
LatexCommand formatted
reference "lst:wasatch-reduction-spec"

\end_inset

 describe the available options that can be used when specifying reduction
 variables via input.
 As an example of defining a reduction variable through the input file,
 consider calculating the maximum velocity (i.e.
 
\begin_inset Formula $u$
\end_inset

) and outputing it to the terminal.
 This may achived via the following specification
\end_layout

\begin_layout Standard
\begin_inset CommandInset include
LatexCommand lstinputlisting
filename "listings/Reduction-example.xml"
lstparams "caption={Specification of a reduction variable that calculates the maximum velocity and outputs its value to the terminal.},label={lst:wasatch-reduction-example}"

\end_inset


\begin_inset CommandInset ref
LatexCommand formatted
reference "lst:wasatch-reduction-example"

\end_inset

 creates an expression called u_max that stores the maximum value of the
 velocity field.
\end_layout

\begin_layout Standard
Warning: Reduction expressions cannot be saved by design (e.g.
 PerPatch variable).
 However, the reduction counterpart can be saved.
 Therefore, to save reduction variables, simply append their name with 
\begin_inset Quotes eld
\end_inset

_uintah
\begin_inset Quotes erd
\end_inset

 and use that in the DataArchiver section of the ups input file.
 For example, to the save 
\begin_inset Quotes eld
\end_inset

u_max
\begin_inset Quotes erd
\end_inset

 shown in 
\begin_inset CommandInset ref
LatexCommand formatted
reference "lst:wasatch-reduction-example"

\end_inset

, use the following in the DataArchiver <save label="u_max_uintah"/>.
\end_layout

\begin_layout Section*
RayleighTaylor
\end_layout

\begin_layout Standard
Generates an initial condition for a Rayleigh-Taylor instability simulation
 with a perturbed interface.
 The formula is
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
f(y)=\begin{cases}
l & y<y_{0}+A\sin(2\pi x_{1})\sin(2\pi x_{2})\\
g & \text{otherwise}
\end{cases}
\end{equation}

\end_inset

where 
\begin_inset Formula $l$
\end_inset

 and 
\begin_inset Formula $g$
\end_inset

 are constants, 
\begin_inset Formula $y$
\end_inset

, 
\begin_inset Formula $x_{1}$
\end_inset

, and 
\begin_inset Formula $x_{2}$
\end_inset

 are coordinates.
 An example of the RayleighTaylor expression is shown below
\end_layout

\begin_layout Standard
\begin_inset CommandInset include
LatexCommand lstinputlisting
filename "listings/RayleighTaylor-example.xml"
lstparams "caption={Specification of a RayleighTaylor expression.},label={lst:wasatch-rayleightaylor-example}"

\end_inset


\end_layout

\begin_layout Section*
GeometryBased
\end_layout

\begin_layout Standard
The 
\begin_inset listings
inline true
status open

\begin_layout Plain Layout

GeometryBased
\end_layout

\end_inset

 expression is a very powerful tool for setting values on fields using complex
 gometrical shapes.
 This expression uses geometry primitives to build complicated shapes with
 different values inside those primitives.
 The specification is shown in 
\begin_inset CommandInset ref
LatexCommand formatted
reference "lst:wasatch-geometrybased-spec"

\end_inset

.
 An example is shown in 
\begin_inset CommandInset ref
LatexCommand formatted
reference "lst:wasatch-geometrybased-example"

\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset CommandInset include
LatexCommand lstinputlisting
filename "listings/GeometryBased-spec.xml"
lstparams "caption={Specification of a GeometryBased expression.},label={lst:wasatch-geometrybased-spec}"

\end_inset


\end_layout

\begin_layout Standard
\begin_inset CommandInset include
LatexCommand lstinputlisting
filename "listings/GeometryBased-example.xml"
lstparams "caption={Example of a GometryBased expression.},label={lst:wasatch-geometrybased-example}"

\end_inset


\end_layout

\begin_layout Section
Boundary-Condition Expressions
\end_layout

\begin_layout Section*
TurbulentInlet
\end_layout

\begin_layout Standard
The 
\begin_inset listings
inline true
status open

\begin_layout Plain Layout

TurbulentInlet
\end_layout

\end_inset

 expression is a boundary expression that provides a means for applying
 time-dependent data that is correlated based on turbulence arguments.
 This expression requires that the random data be first generated by the
 DigitalFilterGenerator (DFG) tool.
 The DFG tool can be found in the StandAlone directory (e.g.
 build/StandAlone).
 Details about using the DFG can be found in the Uintah user guide, in the
 Arches chapter.
\end_layout

\begin_layout Standard
\begin_inset CommandInset include
LatexCommand lstinputlisting
filename "listings/TurbulentInlet-spec.xml"
lstparams "caption={TurbulentInlet UPS specification}"

\end_inset


\end_layout

\begin_layout Standard
An example of using 
\begin_inset listings
inline true
status open

\begin_layout Plain Layout

TurbulentInlet
\end_layout

\end_inset

 in Wasatch is shown here.
 In this example, the 
\begin_inset listings
inline true
status open

\begin_layout Plain Layout

TurbulentInlet
\end_layout

\end_inset

 expression will parse the data provided through the specified inputfile.
 The Wasatch parser will then create three expressions corresponding to
 the 
\begin_inset Formula $u$
\end_inset

, 
\begin_inset Formula $v$
\end_inset

, and 
\begin_inset Formula $w$
\end_inset

 velocities, respectively.
 The names of these expressions are 
\begin_inset listings
inline true
status open

\begin_layout Plain Layout

x-basename
\end_layout

\end_inset

, 
\begin_inset listings
inline true
status open

\begin_layout Plain Layout

y-basename
\end_layout

\end_inset

, and 
\begin_inset listings
inline true
status open

\begin_layout Plain Layout

z-basename
\end_layout

\end_inset

.
 These can be set into the 
\begin_inset listings
inline true
status open

\begin_layout Plain Layout

<functor_name>
\end_layout

\end_inset

 specification for the boundary conditions.
 The 
\begin_inset listings
inline true
status open

\begin_layout Plain Layout

period
\end_layout

\end_inset

 specifies the number of timesteps at which the next turbulent data is loaded
 into the turbulent inlet while the 
\begin_inset listings
inline true
status open

\begin_layout Plain Layout

timeperiod
\end_layout

\end_inset

 specifies after how many seconds the next turbulent data is loaded.
 Both of these are optional and if omitted, the data is loaded at every
 timestep.
 When the turbulent data file is parsed entirely, the data is repeated from
 the begining.
\end_layout

\begin_layout Chapter
Summary of Current Capabilities and Work in Progress
\end_layout

\begin_layout Standard
\begin_inset Float table
placement h
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "tbl:wasatch-development"

\end_inset

Synopsis of Wasatch development.
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="15" columns="2">
<features booktabs="true" tabularvalignment="middle">
<column alignment="left" valignment="top" width="4in">
<column alignment="left" valignment="top" width="0pt">
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Task
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Status
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Advective terms including flux limiters 
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
completed
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Diffusive terms for basic diffusive flux expressions
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
completed
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Tabular property evaluation for implementation of common combustion models
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
completed
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Pressure projection 
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
completed
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Basic CFD algorithm using expressions graph
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
completed
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Boundary conditions for scalar transport
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
completed
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Quadrature method of moments
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
completed
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Basic population balance equation
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
completed
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Filter operator for dynamic turbulent models
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
completed
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Boundary conditions for momentum equations
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
in progress
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Weak form of transport equations
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
in progress
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Variable density algorithm (including appropriate terms in the pressure
 projection)
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
in progress
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Higher-order time integrator (Runge-Kutta based)
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
in progress
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
LES models for turbulent diffusive fluxes (Smagorinsky and dynamic models)
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
in progress
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset CommandInset bibtex
LatexCommand bibtex
bibfiles "wasatch_documentation_references"
options "apalike"

\end_inset


\end_layout

\end_body
\end_document
