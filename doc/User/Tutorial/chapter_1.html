<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=iso-8859-1">
<meta name="generator" content="Adobe GoLive 4">
<title>Geometry Visualization</title>
</head>

<body bgcolor="#a9a9a9">
<table align="center" border="0" cellpadding="0" cellspacing="0" width="306" bgcolor="#cccccc">
<tr>
<td><img height="92" width="600" src="images/sub-banner.jpg" border="0"
    usemap="#sub-banner8662a0c4"><map name="sub-banner8662a0c4"><area
    coords="581,65,598,84" shape="rect" title nohref><area
    href="chapter_7.html" coords="557,64,575,83" shape="rect"
    title="Feedback"><area href="chapter_6.html" coords="532,64,550,82"
    shape="rect" title="Putting Simulation and Visualization
    Together"><area href="chapter_5.html" coords="508,64,527,83"
    shape="rect" title="Bioelectric Field Simulation"><area
    href="chapter_4.html" coords="483,64,502,83" shape="rect"
    title="Multi-Vis"><area href="chapter_3.html" coords="460,64,478,83"
    shape="rect" title="Derived Fields"><area href="chapter_2.html"
    coords="436,64,454,83" shape="rect" title="Looking at the Data"><area
    href="chapter_1.html" coords="412,64,430,81" shape="rect"
    title="Geometry Visualization"><area href="Intro.html"
    coords="354,64,406,84" shape="rect" title="Introduction"><area
    href="http://software.sci.utah.edu/doc/index.html"
    coords="205,63,343,83" shape="rect" title="Documentation"><area
    href="http://software.sci.utah.edu/" coords="103,63,195,82"
    shape="rect" title="Software"><area href="index.html"
    coords="1,65,92,81" shape="rect" title="Tutorial Home"></map></td> 
</tr>

<tr>
<td>
<center>
<table border="0" cellpadding="0" cellspacing="5" width="600">
<tr>
<td>
 <center>
<p><br><A name="section-11"></A>
<font size="4"
face="Arial,Helvetica,Geneva,Swiss,SunSans-Regular" 
color="maroon">
<a NAME=chapter1>    
<b>Chapter 1: Geometry Visualization</b></font> </p>
<p>&nbsp; </p>
</center>
<div align="left">
<p><b><H4><A href="#section-1">FieldReader user interface</H4></b></A>
<p><b><H4><A href="#section-2">Overview of field types</H4></b></A>
<p><b><H4><A href="#section-4">Hooking modules together</H4></b></A>
<p><b><H4><A href="#section-5">Viewer module</H4></b></A>
<p><b><H4><A href="#section-6">Navigating the Viewer Window</H4></b></A>
<p><b><H4><A href="#section-7">Mouse controls</H4></b></A>
<p><b><H4><A href="#section-8">Setting visualization parameters</H4></b></A>
<p><b><H4><A href="#section-10">Saving and reloading networks</H4></b></A>
    
    
    <p><b>Chapter Overview</b><br>
    
    <p>In this first chapter, we will construct a SCIRun network (see the 
    <a HREF="../Guide/usersguide/srug3.html#sec:startingup">User's Guide 3.0,
    Starting SCIRun</a>) that performs a visualization task: 
    rendering a
    tetrahedral mesh.  Our &quot;net,&quot will consist of three
    types of modules: data reader, geometry converter, and renderer.  These modules are FieldReader, ShowField, and Viewer.<br> 
    
 
    <p>We will read the Field data from a file, set some rendering
    properties for the nodes, edges, and faces (the
    nodes will be rendered as blue spheres), and render the
    geometry to the screen in an interactive Viewer window.<br>  
    
    <p>To begin, we will construct a net (as shown,
    completed, in <b>Figure 1.1</b>), and in the chapters that follow, we will
    expand on this network, adding more features and
    functionality as we progress.<br>
    
    </div>
    <center>
    <a NAME=figure-1.1>
    <p><img height="461" width="450" src="images/figures/1_1.gif"><br>
    <b>Figure 1.1, SCIRun environment after building the Chapter 1 network</b></p>
    </center>
    <div align="left">
    <p>
    
    <p><b><H4><A name="section-1">FieldReader User Interface</A></b></H4>
    
    <p>You should set two environment variables in your shell
     before starting SCIRun. For more information about environment
     variables, you may consult the <a
     HREF="../Guide/usersguide/srug3.html#sec:scirundata">User's Guide 3.4,
     SCIRun_DATA</a>.  This process assumes that you have downloaded the SCIRunData directory, a separate download from the SCIRun build.  
    <ol>
      <p><li value="1.">The SCIRUN_DATA variable points to the location 
      of the SCIRunData directory on your system.</p>  
      <p><li value="2.0">The SCIRUN_DATASET variable indicates which dataset
      to load 
      since many of our example networks run with a variety of data inputs such as sphere, brain-EG, and utahtorso-lowres.</p></ol> 

<p>To begin, we will construct a network that loads a geometric mesh from disk and renders it to the screen.  In your Unix shell window:</p>
<ol>
  <p><li value="1.">Set your SCIRUN_DATA variable, pointing to the
  location of SCIRun Data.</p>  
  <p><li value="2.">Set your SCIRUN_DATASET variable to utahtorso-lowres
  (as shown in <b>Figure 1.2</b>).</p></ol>
  
  </div>
  <center>
  <p><img height="240" width="450" src="images/figures/1_2.gif"><br>
  <b>Figure 1.2.1 Set environment variables using C-style shell (csh,
  tcsh)</b></p>
  </center>
  <div align="left">
  <p><br> 
  
  </div>
  <center>
  <p><img height="240" width="450" src="images/figures/1_2b.gif"><br>
  <b>Figure 1.2.2 Setup using a Borne-style shell (bash, ksh, sh)</b></p>
  </center>
  <div align="left">
  <p><br> 
  
  
  <p>Having set these environment variables, you are now ready to
  start SCIRun.   
  <ol>
    <p><li value="1.">Change into your SCIRun/src/ directory, and
    enter the command &quot;./scirun&quot;.  SCIRun cannot be run as a background application.  
    <p><li value="2.">The SCIRun NetworkEditor window appears on your
    screen, as shown in 
    <b>Figure 1.3</b>.</p></ol>
	<p> The NetworkEditor screen consists of three frames: the GlobalView frame in the left uppermost corner; the Error frame in the right uppermost corner, and the NetEdit frame. The NetEdit frame is a large area in which you will construct your networks of modules.</p>
<p> Since the NetEdit frame is so extensive, the Global View frame shows you which part of the NetEdit frame you are currently viewing. The Error frame will show errors that appear in red during startup, or during the execution of a net.  
    
    </div>
    <center>
    <p><img height="410" width="400" src="images/figures/1_3.gif"><br>
    <b>Figure 1.3, SCIRun environment showing blank NetworkEditor window</b></p>
    </center>
    <div align="left">
    <p><br>
   <p> A module is a single-purpose unit that functions within a dataflow environment. Modules will always have at least one input port for receiving data, located at the top of the module, or one output port for sending data, located at the bottom.</p> 
<p>For a more complete description of modules, you may consult the <a
    HREF="../Guide/usersguide/srug2.html#sec:modulesandnetworks">User's Guide, Section 2.3 Modules and Networks</a>.</p>
<p> Each datatype in SCIRun has a unique color such as yellow, purple, or pink.  You may connect ports of the same color. These colors are described in more detail in the <a
    HREF="../Guide/usersguide/srug4.html#sec:anatomyofamodule">User's Guide, Section 4.2, Anatomy of a Module</a>.</p> 
<p>By joining the modules together, data passes from one module to another; two or more connected modules form a SCIRun network (&quot;net&quot;).</p>

    <p>We will first create a FieldReader module that loads a SCIRun Field.</p>
	<p><ul><li>From the
    SCIRun menu, select DataIO/FieldReader, as shown in
    <b>Figure 1.3.1</b>.</p></ul>
<p> To find out more about using nets, see the <a
    HREF="../Guide/usersguide/srug4.html#sec:workingwithnets">User's Guide
    4.0, Working 
    with Networks.</a></p> 
    
    </div>
    <center>
    <p><img height="274" width="450" src="images/figures/1_3a.gif"><br>
    <b>Figure 1.3.1, showing drop-down menus that create the FieldReader module</b></p>
    </center>
    <div align="left">
    <p><br>
<p>Set the user interface (UI) settings for the FieldReader module:
   <ol>
      <p><li value="1.">Press the UI button to launch the file
      browser window, titled "Open field file." Your SCIRun environment should look like <b>Figure 1.4</b>.</p></li>  
    <li value="2."><A name="voltage"></A>Type, or point-and-click to the
      utahtorso-lowres/utahtorso-lowres-voltage.tvd.fld input file. This dataset is a low resolution tetrahedral mesh of a human
      torso.</p>
<li><p>Select the filename in the file-browser
	  window, press &quot;Open.&quot;  The file-browser window
	  disappears and the module begins to execute.</p><br>  
    </div>
    <center>
    <p><img height="512" width="500" src="images/figures/1_4.gif"><br>
    <b>Figure 1.4, shows the file browser window that corresponds to this module</b></p>
    </center>
    <div align="left">
    <p>
     <ul>
      <li><p>The module finishes computing and the progress bar turns green.</p> 
      <li><p>The module icon displays a number that indicates the amount of
	  CPU time required to complete its execution (<b>Figure 1.5</b>).</p>
	<li><p> You have just loaded a SCIRun Field.</p>
    </ul><br>
    
    </div>
    <center>
    <p><img height="67" width="161" src="images/figures/1_5.gif"><br>
    <b>Figure 1.5</b></p>
    </center>
    <div align="left">
    <p><br>
    
    <p>A Field contains a geometric mesh and
    a collection of data values mapped onto that mesh. Data can be stored at the nodes, edges, faces, and cells of the mesh. In this case,
    we use a tetrahedral mesh with voltages defined at the nodes of the
    mesh.</p> 
<p>The dimensionality of the mesh type limits
    the available storage locations. For example, TriSurf has nodes,
    edges, and planar faces, but not cells, which we assume to be
    three-dimensional elements.  As a result, a TriSurf cannot store any
    data in cells--but it can store data in edges or faces.</p>
<p>The brief overview below describes the various types
    of geometric meshes, data values, and mappings that SCIRun
    supports.</p><br>
    
    <p><A name="section-2"><b>Overview of field types</A></b><br>
    
    <p>SCIRun has eight different geometric meshes
    available for Fields:
    
 
	<p><img height="100" width="100" src="images/figures/pointcloud.gif" align="left" valign="top">
         <b>PointCloudMesh:</b> unconnected points.<br clear="all">
      

	
	<p><img height="60" width="100" src="images/figures/ScanlineField.gif" align="left" valign="top">
        <b>ScanlineMesh:</b>a regularly segmented straight line 
	(a regular 1D grid).<br clear="all">
	

	
	<p><img height="60" width="100" src="images/figures/ContourField.gif" align="left" valign="top">
	   <b>CurveMesh:</b> a segmented curve.<br clear="all">
	

	
	<p><img height="100" width="100" src="images/figures/ImageField.gif" align="left" valign="top">        
         <b>ImageMesh:</b> a regular 2D grid.<br clear="all">
	

      
	<p><img height="65" width="100" src="images/figures/trisurf.gif" align="left" valign="top">
         <b>TriSurfMesh:</b> a surface made of connected triangles.<br clear="all">
      

	
	<p><img height="83" width="100" src="images/figures/quadsurf.gif" align="left" valign="top">
         <b>QuadSurfMesh:</b> a surface made of connected quadrilaterals.<br clear="all">
	

	
	<p><img height="87" width="100" src="images/figures/latticevol.gif" align="left" valign="top">
         <b>LatVolMesh:</b> a regular 3D grid.<br clear="all">
	

      
	<p><img height="60" width="100" src="images/figures/tetvol.gif" align="left" valign="top">
         <b>TetVolMesh:</b> a subdivision of space into tetrahedral elements.<br clear="all">
     

	
	<p><img height="84" width="100" src="images/figures/hexvol.gif" align="left" valign="top">
         <b>HexVolMesh:</b> a subdivision of space into hexagonal elements.<br clear="all">
	

        <br>
    
    <p>The following data types can be stored in a Field:<br>
    </p>
    <ul>
      <li>tensor
      <li>vector
      <li>double precision
      <li>float(ing point)
      <li>int(eger)
      <li>short (integer)
      <li>char
      <li>unsigned int(eger)
      <li>unsigned short (integer)
      <li>unsigned char<br>
    </ul>
    <p><br>
    
    <p><b><A name="section-4">Hooking modules together</b><br></A>
    
    <p>We will now add a second module to our network to visualize various Field types.  You will connect the two modules in your canvas so that data can 
    flow between them.</p>  
   
       
     <p><ol><li>Select ShowField from the SCIRun/Visualization menu.</li></p>
 <p><li value="2.">Position the
      mouse pointer over the yellow output port on
      the FieldReader. Now press and hold
      the mouse middle button. You will see the name of
      the port and a line that indicates a possible connection.
    </p>
    </div>
    <center>
    <p><img height="250" width="250" src="images/figures/1_7a.gif"><br>
    <b>Figure 1.6.1</b></p>
    </center>
    <div align="left">
 <ol><li value="3."> Continue to hold the button and drag your mouse toward the yellow ShowField input port.</p> 
      <p><li>The line turns red, showing the desired connection. Release the mouse
	  button.</p>   
    </div>
    <center>
    <p><img height="250" width="250" src="images/figures/1_7b.gif"><br>
    <b>Figure 1.6.2</b></p>
    </center>
    <div align="left">
<ol><li value="4.">You should see a yellow pipe showing a data flow connection
	  between FieldReader and ShowField.
    </p></ol>
    </p><br>
    </div>
    <center>
    <p><img height="250" width="250" src="images/figures/1_7c.gif"><br>
    <b>Figure 1.6.3</b></p>
    </center>
    <div align="left">


    <p><b>Setting the ShowField User Interface</b></p>

    
    <p>The ShowField module has options for changing the visual representations of a Field's geometry.  For example, in the dataset we have just loaded (using the FieldReader module), you will change the color of the nodes to blue spheres.</p>
 
        
    <p><ol>
      <li value="1.">Select the UI button on the ShowField
      module.</p>
    <p><li value= "2.">Select the Default Color button
      near the bottom of the GUI to change the default color and a separate &quot;color&quot; GUI appears.</p>    
      <li ><p>In the color GUI, you can use the sliders to adjust the color values. Set Red and Green to 0.00, and Blue to 1.00. The Alpha value remains at 0.50. </p>  
      <li><p>Select the &quot;OK&quot; button in the color GUI. Notice that the Default Color swatch in the ShowField GUI has changed to blue.  Your SCIRun environment should look like <b>Figure 1.7</b>.</p>  
      <li ><p>In the color GUI, Select &quot;Cancel&quot; to close the window.</p></ol>
</div>
    <center>
    <p><img height="461" width="450" src="images/figures/1_8.gif"><br>
    <b>Figure 1.7 SCIRun environment after changing ShowField's Default Color</b></p>
    </center>
    <div align="left">
<br>
<p>We will now change the scale and resolution of the nodes.</p>
 
      <ol><li><p>In the ShowField GUI, you can increase the Node Scale interval by a power of 10 by pressing the + button.  Set the Node Scale to 2.</p>
<p><li>Set the Sphere Resolution
	  to 5.</p> 
      <li><p>Go to the Edges tab and turn off the display of edges by deselecting the &quot;Show Edges&quot; check box.</p>  
      <li><p>Go the the Faces tab and repeat the same action.</p>
      <li><p>Close the ShowField GUI by pressing the Dismiss button.</p></ol>
      <p>The ShowField module is now ready to render the nodes as blue
	  spheres. The module will &quot;Interactively Update,&quot; by default, to execute after every change.  Or, you may select &quot;Execute Button Only&quot; that holds all changes until you press the Execute button. Consult the <a HREF="../Guide/usersguide/srug4.html#sec:executenet">
    User's Guide 4.5,
    Executing a Network</a> for more details.</p> 
    <p>ShowField works with any of the SCIRun Field data types. These data types must be first compiled into a shared library as needed where they are saved for future use.  This process is called &quot;Dynamic Compilation.&quot;</p>
<p>As a result, Dynamic Compilation causes a delay when the module executes for the first time. For more detail about this process, refer to the PDF document <a
    href="http://www.sci.utah.edu/publications/mcole01/dyn.pdf">Dynamic
    Compilation</a>.

    <p><b><A name="section-5">Viewer module</b><br></A>
    
    <p>The Viewer is the last module that we will add to our
    network. You may find more information about the Viewer in the <a
    HREF="../Guide/usersguide/srug5.html#sec:viewer">User's Guide 5.0,
    Visualization with the Viewer</a>. 
    <ol>
      <p><li>Locate the Viewer under the SCIRun/Render
	  menu.</p>  
      <li><p>Connect the output port from ShowField into the Viewer
	  input port. The Viewer module now has a new
	  input port; an example of a SCIRun module that
	  has dynamic input ports.</p> 
      <li><p>Open the Viewer window by pressing the Viewer's UI button.</p>
      <li><p>In the Viewer window, you will see a set of axes, representing X, Y, and Z directions. Press the Autoview button near the bottom of the window, and you should see the points of the geometry, similar to <b>Figure 1.8</b>  
    .</ol></p> 
	<p>The image in your Viewer will appear at a somewhat different angle, since the image in <b>Figure 1.8</b> has been rotated.</p>  	
    </div>
    <center>
    <p><img height="451" width="450" src="images/figures/1_10.gif"><br>
    <b>Figure 1.8, Viewer window showing the utahtorso-lowres-voltage.tvd.fld data</b></p>
    </center>
    <div align="left">
    <p><br>
    
       <p><b><A name="section-6">Navigating the View Window</b><br></A>
    
    <p>Since the Viewer is one of the most important SCIRun modules, the <a
    HREF="../Guide/usersguide/srug5.html#sec:view-anatomy">User's Guide 5.1,
    Anatomy of the Viewer Window</a> provides a full description of the
    Viewer.   
           
    <p><b><A name="section-7">Mouse controls</b><br></A>
    
    <p>In the Viewer, you can rotate, scale, and translate your image using the mouse. The <a
    HREF="../Guide/usersguide/srug5.html#sec:view-mouse">User's Guide 5.2,
    Mouse Control in the Viewer</a> 
	provides more complete information.</p><br>
<p><b>Translating the image</b></p>
    <ol>
      <p><li> Move the mouse to the center of the image.</p>
      <p><li> Click and hold the left mouse button.</p> 
      <p><li> Move the mouse in order to move the image.</p>  
      <p><li>Release the button and the image will stay where you have placed it within the Viewer window.</p></ol><br>
<p><b>Rotating the image</b>.</p>
      <ol><p><li> Click and hold the middle mouse button.</p> 
	<p><li>Move the mouse in order to rotate the image.</p>
<p><li>Release the mouse button.</p>
	<p><li>If you release the mouse button while dragging, the image will continue to rotate.</p>
<p><li>Click the middle mouse button to stop rotation.</p>
</ol>  
    
    <p><b>Scaling the scene</b></p>

    <ol><p><li>Click the right mouse button and drag the mouse.</p>
<p><li>Move the mouse up or to the left in order to zoom the image out.</p>
<p><li>Move the mouse down or to the right in order to zoom the image in.</p>
 <p><b>Figure 1.8.1</b> shows the image rotated approximately 90 degrees and scaled. 
    
    </div>
    <center>
    <p><img height="451" width="450" src="images/figures/1_10_1.gif"><br>
    <b>Figure 1.8.1, rotated and scaled image</b></p>
    </center>
    <div align="left">
    <p><br>
    
    
 

    <p><b><A name="section-8">Setting Visualization Parameters</b><br></A>
    
   
    
    <p>Now we will use the controls at the bottom of the View window, <b>Figure 1.8.2</b>. Here, you see buttons
    for the 
    following functions:
    <br>
    <ul>
      <p><li>Autoview: restores the display back to its default
	  condition; very useful when first viewing an object or when some
	  combination of settings results in objects disappearing from the
	  View window.</p> 
      <p><li>Set Home View: captures the setting of the current view so you
	  can return to it later by clicking the ``Go home'' 
	  button.</p>
      <p><li>Go home: restores the current home view.</p>  
      <p><li>Views: lists a number of standard viewing angles and
	  orientations for you to select.</p>
    </ul>
  </div>
    <center>
    <p><img height="64" width="500" src="images/figures/1_10_2.gif"><br>
    <b>Figure 1.8.2, basic Viewer controls</b></p>
    </center>
    <div align="left">
    <p><br>
 </div>
    
           
    <p>To access even more display options:
    <ul>
      <p><li>Locate the "+" button in the lower right corner of the Viewer
	  window to access the Extended Control Window which contains additional Viewer settings<b>(Figure 1.8.3)</b>, as described in the <a
	  HREF="../Guide/usersguide/srug5.html#sec:view-control">User's Guide
	  5.3, Extended Control Window</a>.</p> 
    </ul> 
<center>
    <p><img height="273" width="500" src="images/figures/1_10_3.gif"><br>
    <b>Figure 1.8.3, Extended Control Window</b></p>
    </center>
    <div align="left">
    <p><br>
  <p>Using the Extended Control Window, you can manipulate various settings for individual objects and see their possible effects.</p><br> 
    
     
    <p><b><A name="section-10">Saving and reloading networks</b><br></A> 

    <p>Since you have created a three-module network, you
    can now save the net to disk. This net may be reloaded in a future SCIRun
    session. 

    <p>Saving a SCIRun network:
    <ol>
      <p><li value="1.">Click on the File menu and select &quot;Save As&quot;.</p>  
      <p><li>When the file browser appears, follow the prompt to choose a
	  location and filename for your net. By convention, most
	  nets are stored in the SCIRun/src/nets/ directory, but you can store them in another location.</p>
      <p><li>For this example, store the net as
	  SCIRun/src/nets/show-torso-mesh.net, as in <b>Figure 1.9</b>. The .net suffix represents a SCIRun network file.</p>
    </ol><br> 

    </div>
    <center>
    <p><img height="216" width="320" src="images/figures/1_11.gif"><br>
    <b>Figure 1.9, &quot;Save As&quot; GUI</b>
    </center>
    <div align="left">
    </p><br>
    <ol>
<p><li>Click the &quot;Save&quot; button. The network will be saved, and the GUI disappears.</p>
      <p><li>Exit SCIRun.</p></ol>
<p>Loading a SCIRun network:</p>  
      <ol><p><li>Start SCIRun.</p>
<p><li>From the File drop-down menu, select the 
      the &quot;Load...&quot; option.</p>
      <li>Select SCIRun/src/nets/show-torso-mesh.net. 
    </ol><br>
    
    </div>
    <center>
    <p><img height="369" width="500" src="images/figures/1_12.gif"><br>
    <b>Figure 1.10, GUI for loading a network</b></p>
    </center>
    <div align="left">
    <p><br>
    </div>
    
    <p>The net should reload into SCIRun, where you previously saved it.  
    After changing any module settings (<i>e.g.</i>, rotating the view
    in the View Window or changing
    the rendering color of the nodes in ShowField), you have
    two options for re-saving the net:</p>
    <ul>
      <p><li>Overwrite the existing show-torso-mesh.net file by
	  using File/Save from the drop-down menu.</p>  
      <p><li>Or, you can save the net to a new file by using File/Save As...</p>  
    </ul>
    
      
    <p><b><H4>Summary</b></H4>
    
    <p>In this chapter, we created a three module network to visualize the
    geometry of a mesh.  We rendered that mesh to the viewing window, and practiced
    saving and reloading networks.

    <p>The next chapter features additional tools to examine data values, 
    and instructions for varying colors over the geometry. 
    <br>
	<p><A HREF="#section-11">Back to Top</A>
    <br>
</td>
</tr>
</table>
</center>
</td>
</tr>
<tr>
<td><img height="35" width="600" src="images/sub-banner-bottom.jpg"
    border="0" usemap="#sub-banner-bottom8abfd9a4"><map
    name="sub-banner-bottom8abfd9a4"><area href="chapter_2.html"
    coords="564,3,589,18" shape="rect"><area href="Intro.html"
    coords="537,6,560,21" shape="rect"><area href="http://www.sci.utah.edu"
    coords="6,7,67,31" shape="rect" title="SCI Institute"></map></td> 
</tr>
</table>
</body>
</html>
