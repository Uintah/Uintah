<!--Converted with LaTeX2HTML 98.1p1 release (March 2nd, 1998)
originally by Nikos Drakos (nikos@cbl.leeds.ac.uk), CBLU, University of Leeds
* revised and updated by:  Marcus Hennecke, Ross Moore, Herb Swan
* with significant contributions from:
  Jens Lippmann, Marek Rouchal, Martin Wilck and others -->
<HTML>
<HEAD>
<TITLE>4. Working with Networks</TITLE>
<META NAME="description" CONTENT="4. Working with Networks">
<META NAME="keywords" CONTENT="usersguide">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=iso-8859-1">
<LINK REL="STYLESHEET" HREF="usersguide.css">
<LINK REL="next" HREF="node6.html">
<LINK REL="previous" HREF="node4.html">
<LINK REL="up" HREF="usersguide.html">
<LINK REL="next" HREF="node6.html">
</HEAD>
<BODY >
<!--Navigation Panel-->
<A NAME="tex2html166"
 HREF="node6.html">
<IMG WIDTH="37" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next" SRC="next_motif.gif"></A> 
<A NAME="tex2html162"
 HREF="usersguide.html">
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up" SRC="up_motif.gif"></A> 
<A NAME="tex2html156"
 HREF="node4.html">
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous" SRC="previous_motif.gif"></A> 
<A NAME="tex2html164"
 HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="contents" SRC="contents_motif.gif"></A> 
<A NAME="tex2html165"
 HREF="node10.html">
<IMG WIDTH="43" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="index" SRC="index_motif.gif"></A> 
<BR>
<B> Next:</B> <A NAME="tex2html167"
 HREF="node6.html">5. Visualization with the</A>
<B> Up:</B> <A NAME="tex2html163"
 HREF="usersguide.html">No Title</A>
<B> Previous:</B> <A NAME="tex2html157"
 HREF="node4.html">3. Starting SCIRun</A>
<BR>
<BR>
<!--End of Navigation Panel-->
<!--Table of Child-Links-->
<A NAME="CHILD_LINKS"><strong>Subsections</strong></A>
<UL>
<LI><A NAME="tex2html168"
 HREF="node5.html#SECTION00051000000000000000">4.1 Creating a Module</A>
<LI><A NAME="tex2html169"
 HREF="node5.html#SECTION00052000000000000000">4.2 Anatomy of a Module</A>
<LI><A NAME="tex2html170"
 HREF="node5.html#SECTION00053000000000000000">4.3 Creating a Connection</A>
<LI><A NAME="tex2html171"
 HREF="node5.html#SECTION00054000000000000000">4.4 Setting Module Properties</A>
<LI><A NAME="tex2html172"
 HREF="node5.html#SECTION00055000000000000000">4.5 Executing a Network</A>
<LI><A NAME="tex2html173"
 HREF="node5.html#SECTION00056000000000000000">4.6 Deleting a Connection</A>
<LI><A NAME="tex2html174"
 HREF="node5.html#SECTION00057000000000000000">4.7 Selecting Modules</A>
<LI><A NAME="tex2html175"
 HREF="node5.html#SECTION00058000000000000000">4.8 Moving Module(s)</A>
<LI><A NAME="tex2html176"
 HREF="node5.html#SECTION00059000000000000000">4.9 Destroying Module(s)</A>
<LI><A NAME="tex2html177"
 HREF="node5.html#SECTION000510000000000000000">4.10 Documenting the Use of a Module</A>
<LI><A NAME="tex2html178"
 HREF="node5.html#SECTION000511000000000000000">4.11 Viewing a Module's Log</A>
<LI><A NAME="tex2html179"
 HREF="node5.html#SECTION000512000000000000000">4.12 Documenting a Network</A>
<LI><A NAME="tex2html180"
 HREF="node5.html#SECTION000513000000000000000">4.13 Saving a Network</A>
<LI><A NAME="tex2html181"
 HREF="node5.html#SECTION000514000000000000000">4.14 Opening a Network</A>
<LI><A NAME="tex2html182"
 HREF="node5.html#SECTION000515000000000000000">4.15 Navigating a Network</A>
<LI><A NAME="tex2html183"
 HREF="node5.html#SECTION000516000000000000000">4.16 The <EM>SCIRun</EM> Shell</A>
</UL>
<!--End of Table of Child-Links-->
<HR>

<H1><A NAME="SECTION00050000000000000000">&#160;</A>
<A NAME="sec:workwithnets">&#160;</A>
<BR>
4. Working with Networks
</H1>

<P>
This section describes how to create, save, open, execute, and edit
networks.

<P>
When started with no arguments the <TT>scirun</TT> command will create a
main window with a blank network pane.  The goal then is to create and
connect modules to form a network.

<P>

<H2><A NAME="SECTION00051000000000000000">&#160;</A>
<A NAME="sec:creatingmodules">&#160;</A>
<BR>
4.1 Creating a Module
</H2>

<P>
To create a module select its name from one of the package (<EM>e.g.,</EM> <EM>SCIRun</EM>)
menus' category sub-menus.  The package menus may be accessed from the main
window's menu bar and from the network pane's pop-up menu.

<P>
You may activate the network pane's pop-up menu by clicking mouse button 3
while the mouse pointer is in the network pane (but not over a module or
connection).  

<P>
The pop-up menu contains a list of category sub-menus from the <EM>SCIRun</EM> package
and other installed packages.  And each category sub-menu provides
access to the modules within the category.

<P>
After creating a module its graphic ``front end'' will be created and
placed in the network pane.

<P>

<H2><A NAME="SECTION00052000000000000000">&#160;</A>
<A NAME="sec:modanatomy">&#160;</A>
<BR>
4.2 Anatomy of a Module
</H2>

<P>
All modules are represented similarly by a graphic within the network pane.
See Figure&nbsp;<A HREF="node5.html#fig:modgraphic">3</A>. This graphical ``front end'' is the same
for all modules and consists of the following components:

<P>
<DL>
<DT><STRONG>Name</STRONG>
<DD>The module's name.
<DT><STRONG>Input ports</STRONG>
<DD>Zero or more input ports located on the top of the
module.  Each port corresponds to a data type and each data type has a
  unique color.  Table&nbsp;<A HREF="node5.html#tab:portcolors">1</A> maps port colors to data types.
  Input ports connect to other modules' output ports.  Connections can only
  be made between ports of the same type.
<DT><STRONG>Output ports</STRONG>
<DD>Zero or more output ports located on the bottom of the
  module.  Output ports connect to other modules' input ports.  Every
  module has, of course, at least 1 input or 1 output port.
<DT><STRONG>UI button</STRONG>
<DD>Pressing the <B>UI</B> button displays the module's
  control dialog. Some modules have no such dialog. Some have very simple
  dialogs.  Some have very complex dialogs which allow elaborate control
  over the module.  Figure&nbsp;<A HREF="node5.html#fig:moddialog">4</A> shows the control dialog for
  <TT>Show Field</TT> module.
<DT><STRONG>Progress bar</STRONG>
<DD>Shows the module's progress.
<DT><STRONG>Timer</STRONG>
<DD>Displays the amount of CPU time the module has consumed.
  Located to the left of the progress bar.
<DT><STRONG>Pop-up Menu</STRONG>
<DD>Pressing mouse button 3 while the mouse
  pointer is over a module gives access to the module's pop-up menu.  The
  pop-up menu gives access to the following items:
  <DL>
<DT><STRONG>::Package_Category_Name_Instance</STRONG>
<DD>This item is a label (not a
selectable item).  It provides the module's name and the category and
    package to which to module belongs.  The Instance part is a unique
    number which distinguishes multiple instances of the same module.
  <DT><STRONG><B>Execute</B></STRONG>
<DD>Executes the network.
  <DT><STRONG><B>Notes</B></STRONG>
<DD>This item displays the module's note pad.  Use the note pad
    to document the purpose of the module in the current network.
  <DT><STRONG><B>Destroy</B></STRONG>
<DD>Destroys the module.
  <DT><STRONG><B>Show Log</B></STRONG>
<DD>Displays the module's message log.  Most modules will
    write messages to their log during the course of their execution.
  <DT><STRONG><B>Show Status</B></STRONG>
<DD>This item is a toggle button which turns off/on the
    display of the progress indicator.  Turning off the progress indicator
    can help speed up the execution of complex networks.
  </DL></DL>
<P>
<BR>
<DIV ALIGN="CENTER"><A NAME="1186">&#160;</A>
<TABLE>
<CAPTION><STRONG>Table 1:</STRONG>
Data Types and their Port Colors</CAPTION>
<TR><TD>
  <DIV ALIGN="CENTER">
<TABLE CELLPADDING=3 BORDER="1" ALIGN="CENTER">
<TR><TH ALIGN="LEFT"><B>Data Type</B></TH>
<TH ALIGN="LEFT"><B>Port Color</B></TH>
</TR>
<TR><TD ALIGN="LEFT">Field</TD>
<TD ALIGN="LEFT">Yellow</TD>
</TR>
<TR><TD ALIGN="LEFT">Field Set</TD>
<TD ALIGN="LEFT">Green</TD>
</TR>
<TR><TD ALIGN="LEFT">Matrices</TD>
<TD ALIGN="LEFT">Blue</TD>
</TR>
<TR><TD ALIGN="LEFT">Geometric Objects</TD>
<TD ALIGN="LEFT">Pink</TD>
</TR>
<TR><TD ALIGN="LEFT">Color Maps</TD>
<TD ALIGN="LEFT">Purple</TD>
</TR>
<TR><TD ALIGN="LEFT">Camera Path</TD>
<TD ALIGN="LEFT">Brown</TD>
</TR>
</TABLE>    
    <A NAME="tab:portcolors">&#160;</A>  </DIV></TD></TR>
</TABLE>
</DIV>
<BR>
<P>
<BR>
<DIV ALIGN="CENTER"><A NAME="fig:modgraphic">&#160;</A><A NAME="1296">&#160;</A>
<TABLE WIDTH="50%">
<CAPTION><STRONG>Figure 3:</STRONG>
Module Graphic (<TT>Show
      Field</TT> Module)</CAPTION>
<TR><TD><IMG
  WIDTH="256" ALIGN="TOP"
 SRC="../figures/modgraphic-1.gif"
 ALT="SCIRun Module Graphic"></TD></TR>
</TABLE>
</DIV>
<BR>
<P>
<BR>
<DIV ALIGN="CENTER"><A NAME="fig:moddialog">&#160;</A><A NAME="1297">&#160;</A>
<TABLE WIDTH="50%">
<CAPTION><STRONG>Figure 4:</STRONG>
Module Control Dialog (<TT>Show
      Field</TT> Module)</CAPTION>
<TR><TD><IMG
  ALIGN="TOP"
 SRC="../figures/moddialog.jpg"
 ALT="SCIRun Module Dialog"></TD></TR>
</TABLE>
</DIV>
<BR>
<P>

<H2><A NAME="SECTION00053000000000000000">&#160;</A>
<A NAME="sec:connectmods">&#160;</A>
<BR>
4.3 Creating a Connection
</H2>

<P>
Mouse button 2 is used to connect the output (input) port of one module to the
input (output) port of another module.  

<P>
Position the mouse pointer over a module's input (output) port.  Then press
button 2 and drag the the mouse pointer towards another module's output (input)
port.   

<P>
When button 2 is first pressed the program shows all valid connections as
black lines.  It also draws one red colored connection which is the
connection that will be made if you stop the drag by releasing 
button 2.

<P>
Make the final connection by releasing button 2 when the pointer is over
the desired destination port or when the red colored connection is the
desired one.  The connection will be drawn using an appropriate data type
color.

<P>
You may connect a module's output port to the input ports of 1 or more
modules.

<P>

<H2><A NAME="SECTION00054000000000000000">&#160;</A>
<A NAME="sec:setmodprops">&#160;</A>
<BR>
4.4 Setting Module Properties
</H2>

<P>
To change a module's properties click its <B>UI</B> button.  This will
display the module's control dialog.  Use this dialog to change the
module's properties.  Each module's reference documentation explains the
use of its control dialog.  Figure&nbsp;<A HREF="node5.html#fig:moddialog">4</A> shows the control
dialog for the <TT>Show Field</TT>.

<P>

<H2><A NAME="SECTION00055000000000000000">&#160;</A>
<A NAME="sec:executenet">&#160;</A>
<BR>
4.5 Executing a Network
</H2>

<P>
``Network Execution'' means that 1 or more modules must be executed in a
coordinated fashion. The coordinated execution of modules is managed by
<EM>SCIRun</EM>'s <EM>scheduler</EM>.

<P>

<H3><A NAME="SECTION00055100000000000000">
4.5.1 The Basics</A>
</H3>

<P>
The scheduler is invoked when an event occurs that <EM>triggers</EM> a
module's execution.  The scheduler creates a list of all modules that must
executed in coordination with the triggered module. Modules
<EM>upstream</EM> (directly or indirectly) from the triggered module will be
put on the execution list if they have not previously executed.  And all
modules <EM>downstream</EM> from the triggered module will be put on the
list.  Once the scheduler determines which modules must be executed, it
executes them.

<P>
Network execution is mostly transparent.  That is, the events that trigger
module execution will usually be generated automatically while you work
(<EM>e.g.,</EM>by changing a module's property).  Sometimes though you must manually
generate a triggering event by choosing the <B>Execute</B> item from a
module's pop-up menu.

<P>

<H3><A NAME="SECTION00055200000000000000">
4.5.2 Details</A>
</H3>

<P>
Each module executes in its own thread and blocks (waits) until its upstream
modules can supply it with data.  After a module completes its computation
it sends its results to its downstream modules.  This completes a module's
execution cycle.  Its next chance to receive data from its input ports
and send data to its output ports won't arise until some event
causes it to be put on the scheduler's execution list again.  

<P>
This behavior prevents modules from computing in an iterative fashion,
sending intermediate results to their downstream modules.  This is because
downstream modules can't receive these results until they are in their
execution cycle.  They would need to be executed each time the
upstream module posts an intermediate result.

<P>

<H3><A NAME="SECTION00055300000000000000">
4.5.3 Intermediate Results</A>
</H3>

<P>
Some modules are designed to be used in an iterative fashion.  They send
data to their output ports in a special way.  They use a method called
<TT>send_intermediate</TT> to send the results of each iteration.  When
this method is used the scheduler (re)executes downstream modules each time
the upstream module posts its next result.  Downstream modules are
therefore able to receive the results of each iteration as soon as the
upstream module sends them.

<P>
Currently module <TT>SolveMatrix</TT> (from the <TT>(</TT><EM>SCIRun</EM>) package and
<TT>Math</TT> category) is the only module that computes iteratively
using the <TT>send_intermediate</TT> method.

<P>

<H3><A NAME="SECTION00055400000000000000">
4.5.4 Feedback Loops</A>
</H3>

<P>
Some modules that are designed to be used in feedback loops (and if fact,
they can only be used this way).  Their output ports may be connected
directly or indirectly to their input ports.  These modules also use the
<TT>send_intermediate</TT> method.

<P>
The list of feedback modules is <TT>DipoleSearch</TT> and
<TT>ConductivitySearch</TT> from the <TT>Inverse</TT> category of the
<TT>BioPSE</TT> package and <TT>BuildLeadField</TT> from the
<TT>LeadField</TT> category of the <TT>BioPSE</TT> package.

<P>

<H2><A NAME="SECTION00056000000000000000">&#160;</A>
<A NAME="sec:deleteconnections">&#160;</A>
<BR>
4.6 Deleting a Connection
</H2>

<P>
Delete a connection by pressing button 3 while the pointer is
over a connection.

<P>

<H2><A NAME="SECTION00057000000000000000">&#160;</A>
<A NAME="sec:selectmods">&#160;</A>
<BR>
4.7 Selecting Modules
</H2>

<P>
A few operations (see <A HREF="node5.html#sec:movemod"><EM>Moving Module(s)</EM></A> and
<A HREF="node5.html#sec:destroymod"><EM>Destroying Module(s)</EM></A>) act on a group of
modules.  There are 2 ways to create a group of modules.

<P>
<DL COMPACT>
<DT>1.
<DD>Press mouse button 2 while the pointer is in the network pane but not over
a module or a connection.  Then drag the mouse.  This will draw a box
outline.  Modules intersecting the box will be part of the group.  Release
button 2 to complete your selection.
<DT>2.
<DD>Select the first module by clicking mouse button 2 while the pointer is
over a module.  Then add modules to the group by pressing (and holding
down) the <TT>control</TT> key while you click on modules with button 2.
</DL>
<P>
Selected modules will be drawn in a slightly darker shade of grey.

<P>
You may mix selection methods - you may always add modules the group by
pressing the control key while making selections using the above methods.
If you don't press the control key then the previous group will be
forgotten and a new one will be created.

<P>

<H2><A NAME="SECTION00058000000000000000">&#160;</A>
<A NAME="sec:movemod">&#160;</A>
<BR>
4.8 Moving Module(s)
</H2>

<P>
Modules may be moved around in the network pane.  To move a module simply
press button 1 while the pointer is over a module and drag the module to
its new location.

<P>
Multiple modules may be moved at one time.  To do this first
<A HREF="node5.html#sec:selectmods">select</A> 1 or more
modules. Then press button 1 while the pointer is over any one of the
modules in the selected group and then drag the modules to their new location.

<P>

<H2><A NAME="SECTION00059000000000000000">&#160;</A>
<A NAME="sec:destroymod">&#160;</A>
<BR>
4.9 Destroying Module(s)
</H2>

<P>
Delete a module by selecting the <B>Destroy</B> menu item from the
module's pop-up menu.

<P>
Multiple modules may be deleted at one time.  To do this first
<A HREF="node5.html#sec:selectmods">select</A> 1 or more
modules. Then choose, from the pop-up menu of any one of the modules in the
selected group, the <B>Destroy Selected</B> item.

<P>

<H2><A NAME="SECTION000510000000000000000">&#160;</A>
<A NAME="sec:docmodule">&#160;</A>
<BR>
4.10 Documenting the Use of a Module
</H2>

<P>
It is often useful to document the purpose of a module within a network.
Each module maintains a note pad for this purpose.  You may edit the
module's note pad by selecting <B>Notes</B> item from the module's
pop-up menu.  This will display the module's note pad editor.  This simple
editor allows you to write notes or otherwise document the use of the
module within the context of its network.

<P>

<H2><A NAME="SECTION000511000000000000000">&#160;</A>
<A NAME="sec:viewmodslog">&#160;</A>
<BR>
4.11 Viewing a Module's Log
</H2>

<P>
Each module supports a message log.  The module may write error messages or
other types of messages to its log.  To view this log select the
<B>Show Log</B> item from the module's pop-up menu.

<P>

<H2><A NAME="SECTION000512000000000000000">&#160;</A>
<A NAME="sec:docnetwork">&#160;</A>
<BR>
4.12 Documenting a Network
</H2>

<P>
It is useful to document the purpose of a network.  You may use a network's
note pad for this purpose.  To edit the network's note pad select the
<B>Add Info</B> item from the main window's <B>File</B> menu.  This
will display the network's note pad editor.  This simple editor allows you
to write notes or otherwise document the purpose and use of the network.

<P>

<H2><A NAME="SECTION000513000000000000000">&#160;</A>
<A NAME="sec:savenet">&#160;</A>
<BR>
4.13 Saving a Network
</H2>

<P>
<EM>SCIRun</EM> can save networks to files.  Network files have an extension of
<TT>.net</TT> (although in the past they have also had .sr and .uin
extensions).  

<P>
To save a network select the <B>Save</B> item from the main window's
<B>File</B> menu.  A file browser dialog will prompt you for the
name (and location) of the network file.

<P>
Network files are actually <EM>Tool Command Language</EM> (TCL) scripts and
are edit-able (although this topic is beyond the scope of this guide).

<P>

<H2><A NAME="SECTION000514000000000000000">&#160;</A>
<A NAME="sec:opennet">&#160;</A>
<BR>
4.14 Opening a Network
</H2>

<P>
To open a network file select the <B>Open</B> item from the main
window's <B>File</B> menu.   A file browser dialog will prompt you for the
name (and location) of the network file.

<P>
Note that opening a network file merges the network in the file with the
network in the network pane.  There is currently no way to ``close'' a
network and then open a new one - you must quit and restart <EM>SCIRun</EM> to do
this.

<P>

<H2><A NAME="SECTION000515000000000000000">&#160;</A>
<A NAME="sec:navnetwork">&#160;</A>
<BR>
4.15 Navigating a Network
</H2>

<P>
A complex network may not be entirely visible in the network pane.  You may
use the network pane's scroll bars to bring other parts of a network into
view.  Or you may use the navigation tool to view complex networks.

<P>
The navigation pane shows the entire ``network world.''  The small
rectangular region (outlined in black) within the navigation pane is the
network navigation tool and it is a window on the network world.  The
position of the navigation tool determines the part of the network that is
visible in the network pane.  To view other parts of the network, press
button 1 while the pointer is anywhere in the navigation pane - this will
move the tool to the location of the pointer -  then drag the tool to the
new location.

<P>

<H2><A NAME="SECTION000516000000000000000">&#160;</A>
<A NAME="sec:termapp">&#160;</A>
<BR>
4.16 The <EM>SCIRun</EM> Shell
</H2>

<P>
After starting, <EM>SCIRun</EM> will run a shell-like application in the terminal
window called the <EM><EM>SCIRun</EM> shell</EM>.  It displays the prompt
<TT>scirun&gt;</TT> in the terminal window.  This program is a
<EM>Tool Command Language</EM> (TCL) shell program that has been extended with
<EM>SCIRun</EM> specific commands.

<P>
It possible to type TCL <EM>SCIRun</EM> commands at the prompt.  For
instance, to load a network file you may type <TT>source
  <I>&lt;network file name&gt;</I></TT>.  This has the same effect as the <B>File</B>
menu's <B>Open</B> command.

<P>

<P>
<HR>
<!--Navigation Panel-->
<A NAME="tex2html166"
 HREF="node6.html">
<IMG WIDTH="37" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next" SRC="next_motif.gif"></A> 
<A NAME="tex2html162"
 HREF="usersguide.html">
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up" SRC="up_motif.gif"></A> 
<A NAME="tex2html156"
 HREF="node4.html">
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous" SRC="previous_motif.gif"></A> 
<A NAME="tex2html164"
 HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="contents" SRC="contents_motif.gif"></A> 
<A NAME="tex2html165"
 HREF="node10.html">
<IMG WIDTH="43" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="index" SRC="index_motif.gif"></A> 
<BR>
<B> Next:</B> <A NAME="tex2html167"
 HREF="node6.html">5. Visualization with the</A>
<B> Up:</B> <A NAME="tex2html163"
 HREF="usersguide.html">No Title</A>
<B> Previous:</B> <A NAME="tex2html157"
 HREF="node4.html">3. Starting SCIRun</A>
<!--End of Navigation Panel-->
<ADDRESS>
<I>Rob MacLeod</I>
<BR><I>2001-11-03</I>
</ADDRESS>
</BODY>
</HTML>
